---
title             : "Child language experience in a Tseltal Mayan village"
shorttitle        : "Child language experience in a Tseltal Mayan village"

author: 
  - name          : "Marisa Casillas"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "P.O. Box 310, 6500 AH Nijmegen, The Netherlands"
    email         : "Marisa.Casillas@mpi.nl"
  - name          : "Penelope Brown"
    affiliation   : "1"
  - name          : "Stephen C. Levinson"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Max Planck Institute for Psycholinguistics"
#  - id            : "2"
#    institution   : "Cambridge University"

#author_note: |
#  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

abstract: |
  Enter abstract here. Each new line herein must be indented, like this line.
  
keywords          : "Child-directed speech, Linguistic input, Non-WEIRD, Vocal maturity, Turn taking"
wordcount         : "X"

bibliography      : ["r-references.bib"]

figsintext        : yes
figurelist        : no
tablelist         : no
footnotelist      : no
lineno            : yes
mask              : no

class             : "man"
output            : papaja::apa6_pdf
---

```{r load_packages, include=FALSE, echo=FALSE, warning=FALSE}
library(papaja)
library(ggplot2)
library(tidyverse)
library(viridis)
library(grid)
library(gridExtra)
library(ggpirate)
library(lme4)
library(glmmTMB)
library(bbmle)
source("0-Helper.R")
```

```{r analysis_presets, include=FALSE}
data.path <- "transcripts/anon/" # text files exported from ELAN
plot.path <- "plots/" # output plots
seg.index.file <- "Segment-order-inventory.csv"
ptcp.info.file <- "recording-info.csv"
comparison.file <- "comparison_studies.csv"
samplelabels <- c("High activity  ", "Random  ")
col.sample.bu <- list(
  scale_fill_manual(labels=samplelabels, values=viridis(2)),
  scale_color_manual(labels=samplelabels, values=viridis(2)))
col.sample.bu3 <- list(
  scale_fill_manual(labels=samplelabels, values=viridis(3)),
  scale_color_manual(labels=samplelabels, values=viridis(3)))
allowed.overlap <- 1000 #ms
allowed.gap <- 2000 #ms
```

# Introduction {#intro}
A great deal of work in developmental language science revolves around one central question: What linguistic evidence (i.e., what types and how much) is needed to support first language acquisition? In pursuing this topic, many researchers have fixed their sights on child-directed speech (CDS), showing that it is linguistically distinctive (REFS)**[TASK 00: Add missing references]**, interactionally rich (REFS), preferred by infants (REFS), and---perhaps most importantly---facilitates word learning (REFS). By all appearances, CDS is an essential component for acquiring a first language. Yet ethnographic reports from a number of traditional, non-Western communities suggest that children easily acquire their community's language(s) with little or no CDS (REFS). If so, CDS may not be essential for learning language; just useful for facilitating certain aspects of language development. In this paper we investigate the language environment and early development of 10 Tseltal Mayan children growing up in a community where past research has suggested that caregivers use little CDS with infants and young children (REFS Brown).

## Child-directed speech  {#intro-cds}
The amount of CDS children hear influences their language development, particularly their vocabulary (REFS). For example, **[TASK 01: Add examples of input-vocab link]**. CDS has also been linked to young children's speed of lexical retrieval (REFS Weisleder; LuCiD) and syntactic development (REFS Huttenlocher). **[TASK 02: Read Huttenlocher and add details here]**. The conclusion drawn from much of this work is that CDS is an ideal register for learning words---especially concrete nouns and verbs---because it is tailored to maximize a child's moment-to-moment interest and understanding (REFS).  Indeed, even outside of first-person interaction, infants and young children prefer listening to CDS over adult-directed speech (REFS ManyBabies, etc.), suggesting that CDS is useful in catching, maintaining, and focusing children's attention. There are, however, a few significant caveats to the body of work relating CDS quantity to language development.

First, while there is overwhelming evidence linking CDS quantity to vocabulary size, links to grammatical development are more scant (REFS: Huttenlocher; Frank et al.). <!--Children must master the systemic underpinnings of their language(s), e.g., the phonology, morphology, and syntax. -->While the advantage of CDS for referential word learning is clear, it is less obvious how CDS facilitates syntactic learning. **[TASK 03: Add argument from Yurovsky paper + refrences therein]** On the other hand, there is a wealth of evidence that both children and adults' syntactic knowledge is highly lexically specified (REFS), and that, crosslinguistically, children's vocabulary size is one of the most robust predictors of their early syntactic development (REFS). In short, what is good for the lexicon may also be good for syntax. For now, however, the link between CDS and other aspects of grammatical development still needs to be more thoroughly tested.

A second caveat is that most work on CDS quantity uses summary measures that average over the ebb and flow of interaction (e.g., proportion CDS). In both child and adult interactions, verbal behaviors are highly structured: while some occur at fairly regular intervals ('periodic'<!--, e.g., discourse connectives such as 'alright', 'okay', and 'well'-->), others occur in shorter, more intense bouts separated by long periods of inactivity ('bursty'<!--, e.g., content words, descriptions;--> REFS Abney 2018 bursts and lulls, see also fusaroli et al. 2014 synergy). For example, Abney and colleagues (2016 REFS) found that, across multiple time scales of daylong recordings, both infants' and adults' vocal behavior was clustered. Focusing on lexical development, Blasi and colleagues (REFS in prep) also found that nouns and verbs were used burstily in child-proximal speech across all six of the languages in their typologically diverse sample. Infrequent words were somewhat more bursty overall, leading them to propose that burstiness may play a key and universal role in acquiring otherwise-rare linguistic units (see also REFS in prep from ICIS).\footnote{But see Drew and Bergelson (REFS in preparation), who find that the highest-frequency nouns used in CDS and children's own speech were relatively more bursty than other nouns.} Experiment-based work also shows that two-year-olds learn novel words better from a massed presentation of object labels versus a distributed presentation (Schwab and Lew-Williams (2016) REFS; but see REFS Ambridge et al., 2006; Childers and Tomasello, 2002). Structured temporal characteristics in children's language experience imply new roles for attention and memory in language development. By that token, we should begin to investigate the link between CDS and linguistic development with more nuanced measures of how CDS is distributed.

<!--the current link between CDS quantity and linguistic development would be greatly enriched if we accounted for more nuanced distributional properties of CDS (see REFS Mendoza and Fausey (in preparation) for related work on child-proximal music).-->
<!--Using data collected under more controlled conditions, Slone, Abney, and colleagues (REFS in prep) found that infants were more likely to learn new object labels when their caregivers used those labels in a more bursty way during spontaneous interaction.-->

Finally, prior work has typically focused on Western (primarily North American) populations, limiting our ability to generalize these effects to children acquiring language worldwide (REFS: WEIRD; Lieven, 1994). While we do gain valuable insight by looking at _within-population_ variation (e.g., REFS), we can more effectively find places where our assumptions break down by studying _new_ populations. Linguistic anthropologists working in non-Western communities have long reported that caregiver interaction styles vary immensely from place to place, with some caregivers using little or no CDS to young children (REFS Gaskins, 2006). Children in these communities reportedly acquire language with 'typical'-looking benchmarks. For example, they start pointing (REFS Liszkowski et al., 2012; but see Salomo & Liszkowski, 2013) and talking (REFS Rogoff et al., 2003?; Brown??) around the same time we would expect for Western middle-class infants. These findings have had little impact on mainstream theories of word learning and language acquisition, partly due to a lack of directly comparable measures (Brown, 2014). If, however, these children indeed acquire language without delay despite little or no CDS, we must reconsider what kind of linguistic evidence is necessary for children to learn language.

<!--**[TASK 05: Check out previous ethnographic work]** Possibly relevant: Schieffelin, 1990; Ochs, 1988; Demuth, 1992(?); Takada, 2005; Goody, 1982; Schieffelin & Ochs, 1986; Pye, 1986; Gaskins, 2006; Brown & Casillas, under review).--> <!--Pye 1986. QuichÃ© mayan speech to children. Journal of Child Language, 13(1), 85-100-->

## Language development in non-WEIRD communities {#intro-nonweird}
To our knowledge, only a handful of researchers have used methods from developmental psycholinguistics to describe the language environments and linguistic development of children growing up in traditional, non-Western communities. <!--We focus here on _quantitative_ language development measures because the key claims about CDS and linguistic development are themselves quantitative in nature.--> We briefly highlight two recent efforts along these lines, but see Mastin and Vogt (REFS 2016) and Cristia et al. (2017) for more examples.

Scaff, Cristia, and colleagues (REFS 2017; in preparation) have used a number of methods to estimate how much speech children hear in a Tsimane forager-horticulturalist population in the Bolivian lowlands. Their daylong recordings show that Tsimane children between 0;6 and 6;0 hear ~5 minutes of CDS per hour, regardless of their age (but see Cristia et al., 2017). For comparison, children from North American homes between ages 0;3 and 3;0 are estimated to hear ~11 minutes of CDS per hour in daylong recordings (REFS: Bergelson, Casillas, et al., see also REFS the newer Tamis-LeMonda paper; maybe give estimates w/ age ranges for each??). Tsimane children also hear ~10 minutes of other-directed speech per hour (e.g., talk between adults) compared to the ~7 minutes per hour heard by North American children (REFS Bergelson, Casillas, et al.). This difference may be attributable to the fact that the Tsimane live in extended family clusters of 3--4 households, so speakers are typically in close proximity to 5--8 other people (REFS Cristia et al., 2017).

Laura Shneidman and colleagues (REFS; 2010; 2012) analyzed speech from 1-hour at-home video recordings of children between ages 1;0 and 3;0 in two communities: Yucatec Mayan (Southern Mexico) and North American (a major U.S. city). Their analyses yielded four main findings: compared to the American children, (a) the Yucatec children heard many fewer utterances per hour, (b) a much smaller proportion of the utterances they heard were _child-directed_, (c) the proportion of utterances that were child-directed increased dramatically with age, matching U.S. children's by 3;0 months, and (d) most of the added CDS came from other children (e.g., older siblings and cousins). They also demonstrated that the lexical diversity of the CDS they hear at 24 months---particularly from adult speakers---predicted children's vocabulary knowledge at 35 months.

These groundbreaking studies establish a number of important findings: First, children in each of these communities appear able to acquire their languages with relatively little CDS. Second, CDS might become more frequent as children get older, though this could largely be due to speech from other children. Finally, despite these differences, CDS from adults may still be the most robust predictor of vocabulary growth.

## The current study {#intro-currentstudy}
We examine the early language experience of 10 Tseltal Mayan children under age 3;0. Prior ethnographic work suggests that Tseltal caregivers do not frequently speak directly to their children until the children themselves begin speaking (REFS: Brown??). Nonetheless, Tseltal children develop language with no apparent delays. Tseltal Mayan language and culture has much in common with the Yucatec Mayan communities Shneidman reports on (REFS: 2010 + add other stuff that's not nec lg), allowing us to compare differences in child language environments between the two sites more directly than before.\footnote{For a review of comparative work on language socialization in Mayan cultures, see Pye (2017).) We provide more details on this community and dataset in the [Methods section](#methods).

Similar to previous work, we estimated how much speech children overheard, how much was directed to them, and how those quantities changed with age. To this foundation we added new sampling techniques for investigating variability in children's speech environments within daylong recordings. We also analyzed children's early vocal productions, examining both the overall developmental trajectory of their vocal maturity and how their vocalizations are influenced by CDS.

Based on prior work, we predicted that Tseltal Mayan children hear little CDS, that the amount of CDS they hear increases with age, that most CDS comes from other children, and that, despite this, Tseltal Mayan children reach speech production benchmarks on par with Western children. We additionally predicted that children's language environments would be bursty---that brief, high-intensity interactions would be sparsely distributed throughout the day, accounting for the majority of children's daily CDS---and that children's responsiveness and vocal maturity would be maximized during these moments of high-intensity interaction.

# Methods {#methods}
## Community {#methods-community}
The children in our dataset (REFS: Casillas HomeBank) come from a small-scale, subsistence farming community in the highlands of Chiapas in Southern Mexico. The vast majority of children grow up speaking Tseltal monolingually at home. Primary school is conducted in Tseltal, but secondary and further education is primarily conducted in Spanish. Nuclear families are often large (5+ children) and live in patrilineal clusters. Nearly all families grow staple crops such as corn and beans, but also bananas, chilies, squash, coffee, and more. <!--Families also cultivate and collect a range of other local plants, raise poultry for eggs and meat and, very occasionally, raise other animals (e.g., bulls) for slaughter. Additional produce, meat, and processed foods are available for purchase at small local shops and from vendors driving through town.--> Household and farming work is divided among men, women, and older children. Women do much of the daily cleaning and food preparation, but also frequently work in the garden, haul water and firewood, and do other physical labor. A few community members---both men and women---earn incomes as teachers and shopkeepers but are still expected to regularly contribute to their family's household work.

More than forty years of ethnographic work by the second author has reported that Tseltal children's language environments are non-child-centered and non-object-centered (REFS). During their waking hours, Tseltal infants are typically tied to their mother's back while she goes about her work for the day. Infants receive very little direct speech until they themselves begin to initiate interactions, usually as they approach their first birthdays. Even then, interactional exchanges are often brief or non-verbal (e.g., object exchange routines) and take place within a multi-participant context (Brown 2011; 2014). Rarely is attention given to words and their meanings, even when objects are central to the activity. Instead, interactions tend to focus on appropriate actions and responses, and young children are socialized to attend to the interactions taking place around them (REFS see also Rogoff and de Leon).

Young children are often cared for by other family members, especially older siblings. Even when not on their mother's back, infants are rarely put on the ground, so they can't usually pick up the objects around them until they are old enough to walk. Toys are scarce and books are vanishingly rare, so the objects children do get their hands on tend to be natural or household objects (e.g., rocks, sticks, spoons, baskets, etc.). By age five, most children are competent speakers who engage daily in chores and caregiving of their younger siblings. The Tseltal approach to caregiving is similar to that described for other Mayan communities (e.g., REFS Rogoff, Gaskins, de Leon, Shneidman).

## Corpus {#methods-corpus}
The current data come from the Casillas HomeBank Corpus (REFS HomeBank), which includes daylong recordings and other developmental language data from more than 100 children under 4;0 across two indigenous, non-WEIRD communities: the Tseltal Mayan community described here and a Papua New Guinean community described elsewhere (REFS).

*[TASK 06: Check these demographic data again]*
The Tseltal data, primarily collected in 2015, include recordings from 55 children born to 43 mothers. The families in our dataset typically only had 2--3 children (median = 2; range = 1--9), due to the fact that the participating families come from a young subsample of the community (mothers: mean = 26.9 years; median = 25.9; range = 16.6--43.8 and fathers: mean = 30.5; median = 27.6; range = 17.7â-52.9). On average, mothers were 20.1 years old when they had their first child (median = 19; range = 12--27), with a following inter-child interval of 3.04 years (median = 2.8; range = 1--8.5).\footnote{These estimates do not include miscarriages and/or children who passed away.}. As a result, 26% of the participating families had two children under 4;0.

Extended households, defined in our dataset as the group sharing a kitchen or other primary living space, ranged between between 3 and 15 people (mean = NN; median = NN). Although 30.9% of the target children are first-born, they were rarely the only child in their extended household. Caregiver education is one (imperfect) measure of contact with Western culture. Most mothers had finished primary school, with many also having completed secondary school (range = no schooling--university). Most fathers had finished secondary school, with many having also completed preparatory school (range = no schooling--university). Owing in large part to patrilineal (i.e., father to son)  land inheritance, 93% of the fathers grew up in the village where the recordings took place, while only 53% of the mothers did.  

### Recordings {#methods-corpus-recs}
Methods for estimating the quantity of speech that children hear have advanced significantly in the past two decades, with long-format at-home audio recordings quickly becoming the new standard (e.g., with the LENA^Â®^ system; REFS). These recordings capture a wider range of the linguistic patterns children hear as they participate in different activities with different speakers over the course of their day. In longer, more naturalistic recordings, caregivers also tend to use less CDS (REFS Tamis-LeMonda<!--\footnote{That said, Tamis-LeMonda and colleagues found that rank CDS quantity use was highly correlated between short- and long-format recordings.}-->). The result is greater confidence that the estimated CDS characteristics are representative of what the child typically hears at home.

We used a novel combination of a lightweight stereo audio recorder (Olympus^Â®^ WS-832) and wearable photo camera (Narrative Clip 1^Â®^) fitted with a fish-eye lens, to track children's movements and interactions over the course of a 9--11-hour period in which the experimenter was not present.  Each recording was made during a single day at home in which the recorder and/or camera was attached to the child. Ambulatory children wore both devices on an elastic vest. Non-ambulatory children wore the recorder in a onesie while their primary caregiver wore the camera on an elastic vest *Figure 1* *[TASK 07: Make figure]*. The camera was set to take photos at 30-second intervals and was synchronized to the audio in post-processing to create video of the child's daylong recording.\footnote{Documentation for recording set-up and scripts for post-processing are available at *[TASK 08: Link to relevant docs]*}

## Data selection and annotation {#methods-samples}
We annotated video clips from 10 of the 55 children's recordings. We chose these 10 recordings to maximize variance in three demographic variables: child age (0--3;0), child sex, and maternal education. The sample is summarized in *Table 1* *[TASK 09: Make table]*. We then selected one hour's worth of non-overlapping clips from each recording in the following order: nine randomly selected 5-minute clips, five 1-minute clips manually selected as the top 'turn-taking' minutes of the recording, five 1-minute clips manually selected as the top 'vocal activity' minutes of the recording, and one, manually selected 5-minute extension of the best 1-minute sample *FIGURE ??* *[TASK 10: Add figure of recording times with samples highlighted for the 10 recs]*. We created these different subsamples of each day to measure properties of (a) children's _average_ language environments (random samples) and (b) their _most input-dense_ language environments (turn-taking samples). The third sample (high-activity) gave us insight into children's productive speech abilities.

The turn-taking and high-activity clips were chosen by two trained annotators (the first author and a student assistant) who listened to each recording in its entirety at 1--2x speed while actively taking notes about potentially useful clips. Afterwards, the first author reviewed the list of candidate clips, listened again to each one (at 1x speed, multiple repetitions), and chose the best five 1-minute samples for each of the two types of activity. Good turn-taking activity was defined as at closely timed sequences of contingent vocalization between the target child and at least one other person (i.e., frequent vocalization exchanges). The 'best' turn-taking clips were chosen because they had the most and most clear turn-switching activity between the target child and the other speaker(s). Good vocal activity clips were defined as clips in which the target child produced the most and most diverse spontaneous (i.e., not imitative) vocalizations. The 'best' vocal activity clips were chosen for representing the most linguistically mature and/or diverse vocalizations made by the child over the day. All else being equal, candidate clips were prioritized when they contained less background noise or featured speakers and speech that were not otherwise frequently represented (e.g., CDS from older males). The best turn-taking clips and vocal activity clips often overlapped; turn-taking clips were selected from the list of candidates first, and then vocal-activity clips were chosen from the remainder.
<!--*[TASK XX: Add (cleaned up) docs for coding to an OSF and link here]*-->

Each video clip was transcribed and annotated in ELAN (REFS) using the ACLEW Annotation Scheme (REFS) by the first author and a native speaker of Tseltal who lives in the community and knows most of the recorded families personally. At the time of writing, NN% *[TASK XX: Fill in before submitting]* of the clips have been reviewed by a second native Tseltal speaker. The annotations include the transcription of (nearly) all hearable utterances in Tseltal, a loose translation of each utterance into Spanish, vocal maturity measures of each target child utterance (non-linguistic vocalizations/non-canonical babbling/non-word canonical babbling/single words/multiple words), and addressee annotations for all non-target-child utterances (target-child-directed/other-child-directed/adult-directed/adult-and-child-directed/animal-directed/other-speaker-type-directed).\footnote{Full documentation, including training materials, for the ACLEW Annotation Scheme can be found at *[TASK 11: Add OSF link]*.}

### Why vocal maturity?
*[TASK 12: Missing paragraph!!]*

## Data analysis {#methods-analysisinfo}
We exported each ELAN file as tab-separated values and then the annotations into `r R.version$version.string` for analysis (plots: ggplot2; analyses: lme4 and betareg *[TASK 13: Fix references to packages and their citations]*). We then calculated a number of summary variables to characterize children's language environments and linguistic development including: the rate of all overheard speech ('XDS') and all speech directed to the target child ('TCDS') in both minutes per hour and utterances per hour, the proportion of speech in TCDS and coming from adult vs. child speakers, the rate of target-child-to-other and other-to-target-child turn transitions, the rate of vocalization produced by the target child, and the average maturity of children's vocalizations. Using language environment measures from the turn-taking sample, we then also estimated the number of intensive interaction minutes each child experienced over the day.

<!--Block below: R code that reads in and labels the data so we can make the summary measures-->
```{r prepare_data, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# Read in annotation files
files <- list.files(path=data.path,pattern="*.txt")
all.data <- data.frame()
for (i in 1:length(files)) {
#  print(files[i])
  newfile <- read_csv(paste0(data.path, files[i]), col_types = cols(val = col_character()))
  newfile$aclew_child_id <- unlist(strsplit(files[i], '\\.'))[1]
  all.data <- rbind(all.data, newfile)
}
all.data$row <- c(1:nrow(all.data))

# Read in supplementary data
ptcp.info <- read_csv(ptcp.info.file, col_types = cols()) %>%
  dplyr::select(-row)
seg.info <- read_csv(seg.index.file)

# Extract and convert start time of each sample
seg.info$start.hhmmss <- regmatches(seg.info$Media, regexpr("[0-9][0-9][0-9][0-9][0-9][0-9]", seg.info$Media))
seg.info$start.sec <- as.numeric(substr(seg.info$start.hhmmss,1,2))*60000 +
  as.numeric(substr(seg.info$start.hhmmss,3,4))*1000 +
  as.numeric(substr(seg.info$start.hhmmss,5,6))
seg.info$start.hr <- round(seg.info$start.sec/60000, 3)

# Create normalized versions of predictor vars
ptcp.info <- ptcp.info %>%
  mutate(
    tchiyr.m = mean(age_mo_round),
    motyr.m = mean(mother_age),
    nsb.m = mean(number_older_sibs),
    hsz.m = mean(household_size),
    tchiyr.sd = sd(age_mo_round),
    motyr.sd = sd(mother_age),
    nsb.sd = sd(number_older_sibs),
    hsz.sd = sd(household_size)
    )

# Add participant and segment info
codes <- all.data %>% filter(tier == "code")

all.data <- all.data %>%
  filter(speaker != "") %>%
  left_join(ptcp.info, by = "aclew_child_id") %>%
  mutate(segment = "", sample = "",
         sample_type = "", segment_dur = 0)

for (i in 1:nrow(codes)) {
  rec <- codes$aclew_child_id[i]
  seg <- as.character(codes$val[i])
  seg.on <- codes$start[i]
  seg.off <- codes$stop[i]
  seg.idx <- which(all.data$aclew_child_id == rec &
                     all.data$start < seg.off &
                     all.data$stop > seg.on)
  all.data$segment[seg.idx] <- seg
}

# Label samples
all.data$sample[which(
  grepl('^random', all.data$segment))] <- "random"
all.data$sample[which(
  grepl('tt', all.data$segment))] <- "turn-taking"
all.data$sample[which(
  grepl('va', all.data$segment))] <- "high-activity"

# Label sample types and durations
random.samples <- which(grepl('^random', all.data$segment))
all.data$sample_type[random.samples] <- "random"
all.data$segment_dur[random.samples] <- 5

ext.samples <- which(grepl('^extension', all.data$segment))
all.data$sample_type[ext.samples] <- "extension"
all.data$segment_dur[ext.samples] <- 5

tt.samples <- which(grepl('^tt', all.data$segment))
all.data$sample_type[tt.samples] <- "turn-taking"
all.data$segment_dur[tt.samples] <- 1

va.samples <- which(grepl('^va', all.data$segment))
all.data$sample_type[va.samples] <- "turn-taking"
all.data$segment_dur[va.samples] <- 1

# Add in segment start time
all.data <- all.data %>%
  left_join(dplyr::select(seg.info, c("aclew_id", "CodeName", "start.hhmmss",
                                      "start.sec", "start.hr")),
            by = c("aclew_child_id" = "aclew_id", "segment" = "CodeName"))

avg.utt.len.tseltal <- all.data %>%
  filter(speaker != "CHI") %>%
  dplyr::select(dur) %>%
  summarise(mean.utt.len = mean(dur),
            median.utt.len = median(dur))
```

# Results {#results}
## Speech quantity
```{r random_quantity_prep, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# Get min/hr speech measures
n.unique.rand.segs <- length(unique(all.data$segment[grepl("random", all.data$segment)]))
n.unique.recs <- length(unique(all.data$aclew_child_id))
all.rand.segments <- tibble(
  aclew_child_id = rep(unique(all.data$aclew_child_id),
                n.unique.rand.segs),
  segment = rep(unique(all.data$segment[grepl("random", all.data$segment)]),
                n.unique.recs))
# XDS
xds.per.seg.rand <- all.data %>%
  filter(sample == "random" & speaker != "CHI" &
           grepl("xds@", tier)) %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(xds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 5, xds_min = 0)) %>%
  mutate(xds_mph = (xds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# ODS
ods.per.seg.rand <- all.data %>%
  filter(sample == "random" & speaker != "CHI" &
           grepl("xds@", tier) & val != "T") %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(ods_min = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 5, ods_min = 0)) %>%
  mutate(ods_mph = (ods_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# TDS
tds.per.seg.rand <- all.data %>%
  filter(sample == "random" & speaker != "CHI" &
           grepl("xds@", tier) & val == "T") %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(tds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 5, tds_min = 0)) %>%
  mutate(tds_mph = (tds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# All CDS
cds.per.seg.rand <- all.data %>%
  filter(sample == "random" & speaker != "CHI" &
           grepl("xds@", tier) & (val == "T" | val == "C")) %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(cds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 5, cds_min = 0)) %>%
  mutate(cds_mph = (cds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# Number of speakers per clip
spkrs.per.seg.rand <- all.data %>%
  filter(sample == "random" & speaker != "CHI" &
           !(grepl("@", tier))) %>%
  group_by(aclew_child_id, segment) %>%
  summarise(n_spkrs_clip = length(unique(speaker)))
# All together
quantity.rand <- xds.per.seg.rand %>%
  full_join(ods.per.seg.rand, by = c("aclew_child_id", "segment", "segment_dur")) %>%
  full_join(tds.per.seg.rand, by = c("aclew_child_id", "segment", "segment_dur")) %>%
  full_join(cds.per.seg.rand, by = c("aclew_child_id", "segment", "segment_dur")) %>%
  full_join(spkrs.per.seg.rand, by = c("aclew_child_id", "segment")) %>%
  left_join(dplyr::select(seg.info, c("aclew_id", "CodeName", "start.hr")),
            by = c("aclew_child_id" = "aclew_id", "segment" = "CodeName")) %>%
  full_join(ptcp.info, by = "aclew_child_id") %>%
  replace_na(list(xds_min = 0, xds_mph = 0,
                  tds_min = 0, tds_mph = 0,
                  cds_min = 0, cds_mph = 0,
                  n_spkrs_clip = 0)) %>%
  mutate(prop_tds = tds_min/xds_min)
  # Don't replace NAs with 0s in this case; proportion is not meaningful w/o any speech
quantity.rand.bychild <- quantity.rand %>%
  group_by(aclew_child_id) %>%
  summarise(
    xds_min = mean(xds_min),
    xds_mph = mean(xds_mph),
    ods_min = mean(ods_min),
    ods_mph = mean(ods_mph),
    tds_min = mean(tds_min),
    tds_mph = mean(tds_mph),
    cds_min = mean(cds_min),
    cds_mph = mean(cds_mph),
    prop_tds = mean(prop_tds, na.rm = TRUE),
    m_n_spkrs = mean(n_spkrs_clip)) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# Get xds and tds min/hr by speaker type
all.data$SpkrAge <- "Not known"
all.data$SpkrAge[grepl("FA|MA|UA", all.data$speaker)] <- "Adult"
all.data$SpkrAge[grepl("FC|MC|UC", all.data$speaker)] <- "Child"
all.rand.segments.sa <- tibble(
  aclew_child_id = rep(unique(all.data$aclew_child_id),
                2*n.unique.rand.segs),
  segment = rep(unique(all.data$segment[grepl("random", all.data$segment)]),
                2*n.unique.recs),
  SpkrAge = c(rep("Adult", (n.unique.rand.segs * n.unique.recs)),
              rep("Child", (n.unique.rand.segs * n.unique.recs))))
# XDS
xds.per.seg.rand.sa <- all.data %>%
  filter(sample == "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier)) %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(xds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 5, xds_min.sa = 0)) %>%
  mutate(xds_mph.sa = (xds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# ODS
ods.per.seg.rand.sa <- all.data %>%
  filter(sample == "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & val != "T") %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(ods_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 5, ods_min.sa = 0)) %>%
  mutate(ods_mph.sa = (ods_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# TDS
tds.per.seg.rand.sa <- all.data %>%
  filter(sample == "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & val == "T") %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(tds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 5, tds_min.sa = 0)) %>%
  mutate(tds_mph.sa = (tds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# All CDS
cds.per.seg.rand.sa <- all.data %>%
  filter(sample == "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & (val == "T" | val == "C")) %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(cds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.rand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 5, cds_min.sa = 0)) %>%
  mutate(cds_mph.sa = (cds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# Number of speakers per clip
spkrs.per.seg.rand.sa <- all.data %>%
  filter(sample == "random" & speaker != "CHI" & SpkrAge != "Not known" &
           !(grepl("@", tier))) %>%
  group_by(aclew_child_id, SpkrAge, segment) %>%
  summarise(n_spkrs_clip = length(unique(speaker)))
# All together
quantity.rand.sa <- xds.per.seg.rand.sa %>%
  full_join(ods.per.seg.rand.sa, by = c("aclew_child_id", "SpkrAge",
                                        "segment", "segment_dur")) %>%
  full_join(tds.per.seg.rand.sa, by = c("aclew_child_id", "SpkrAge",
                                        "segment", "segment_dur")) %>%
  full_join(cds.per.seg.rand.sa, by = c("aclew_child_id", "SpkrAge",
                                        "segment", "segment_dur")) %>%
  full_join(dplyr::select(quantity.rand, c("aclew_child_id", "segment", "tds_min")),
            by = c("aclew_child_id", "segment")) %>%
  full_join(spkrs.per.seg.rand.sa, by = c("aclew_child_id", "SpkrAge", "segment")) %>%
  left_join(dplyr::select(seg.info, c("aclew_id", "CodeName", "start.hr")),
            by = c("aclew_child_id" = "aclew_id", "segment" = "CodeName")) %>%
  full_join(ptcp.info, by = "aclew_child_id") %>%
  replace_na(list(xds_min.sa = 0, xds_mph.sa = 0,
                  ods_min.sa = 0, ods_mph.sa = 0,
                  tds_min.sa = 0, tds_mph.sa = 0,
                  cds_min.sa = 0, cds_mph.sa = 0,
                  n_spkrs_clip = 0)) %>%
  mutate(prop_tds.sa = tds_min.sa/xds_min.sa,
         prop_sa.tds = tds_min.sa/tds_min)
  # Don't replace NAs with 0s in this case; proportion is not meaningful w/o any speech
```

```{r make_random_quantity_plots, message=FALSE, warning=FALSE, paged.print=FALSE}
# Prep comparison data for matching figures
comparison.data <- read_csv(comparison.file)
tds.mph.tofill <- which(is.na(comparison.data$tds_mph) & !(is.na(comparison.data$tds_uph)))
comparison.data$tds_mph[tds.mph.tofill] <- ((comparison.data$tds_uph[tds.mph.tofill] *
                                               avg.utt.len.tseltal$median.utt.len)/60000)
ods.mph.tofill <- which(is.na(comparison.data$ods_mph) & !(is.na(comparison.data$ods_uph)))
comparison.data$ods_mph[ods.mph.tofill] <- ((comparison.data$ods_uph[ods.mph.tofill] *
                                               avg.utt.len.tseltal$median.utt.len)/60000)
xds.mph.tofill <- which(is.na(comparison.data$xds_mph) &
                          !(is.na(comparison.data$ods_mph)) & !(is.na(comparison.data$tds_mph)))
comparison.data$xds_mph[xds.mph.tofill] <- comparison.data$ods_mph[xds.mph.tofill] +
  comparison.data$tds_mph[xds.mph.tofill]

comparison.data.sa <- bind_rows(comparison.data, comparison.data)
comparison.data.sa$SpkrAge <- c(rep("Child", nrow(comparison.data)),
                                rep("Adult", nrow(comparison.data)))
comparison.data.sa$prp_spkr <- NA
for (i in 1:nrow(comparison.data.sa)) {
  if (!(is.na(comparison.data.sa$prp_tds_adu[i]))) {
      comparison.data.sa$prp_spkr[i] <- ifelse(comparison.data.sa$SpkrAge[i] == "Child",
                                               comparison.data.sa$prp_tds_chi[i]/100,
                                               comparison.data.sa$prp_tds_adu[i]/100)

  }
}
comparison.data$Site <- factor(comparison.data$Site, levels = unique(comparison.data$Site))
comparison.data.sa$Site <- factor(comparison.data.sa$Site, levels = unique(comparison.data$Site))
comparison.data.shapes <- unique(comparison.data$shape)

# Graph the basic speech quantity info
# XDS min/hr
xdsmph.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = xds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("XDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,85),
                     breaks=seq(0,85,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,85),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = xds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# ODS min/hr
odsmph.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = ods_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("ODS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = ods_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS min/hr
tdsmph.segments.rand <- ggplot(quantity.rand,
      aes(x = age_mo_round, y = tds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = tds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

tdsmph.segments.rand.zoomedin <- ggplot(quantity.rand,
                                   aes(x = age_mo_round, y = tds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,20),
                     breaks=seq(0,20,5)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,20),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = tds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS prop
tdsprp.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = prop_tds)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS/All spch") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = prp_tds, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# prop TDS from adults vs. children
tdsprp.segments.sa.rand <- ggplot(quantity.rand.sa,
                             aes(x = age_mo_round, y = prop_sa.tds,
                                 group = SpkrAge, fill = SpkrAge, color = SpkrAge)) +
  geom_boxplot(aes(group = interaction(age_mo_round, SpkrAge),
                   fill = SpkrAge, color = SpkrAge),
               position = position_dodge(1), outlier.shape = NA, alpha = 0.3) +
  geom_smooth(method = "lm") +
  ylab("Prop of TCDS") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1), xlim=c(0,38)) +
  geom_point(data = comparison.data.sa,
             aes(x = AgeMonths, y = prp_spkr, group = SpkrAge,
                 fill = SpkrAge, shape = Site), alpha = 0.5) +
  scale_shape_manual(values=comparison.data.shapes) +
  col.sample.bu3 +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# number of speakers per clip
nspkrs.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = n_spkrs_clip)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("# Speakers") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,10),
                     breaks=seq(0,10,2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,10),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))
```

How much speech do Tseltal children hear overall and what proportion of that speech is directed to them? For maximum comparability with prior work we first limit direct comparisons to the randomly sampled Tseltal clips. During randomly sampled clips, Tseltal children heard an average of `r round(mean(quantity.rand.bychild$xds_mph),2)` minutes of speech per hour (median = `r round(median(quantity.rand.bychild$xds_mph),2)`; range = `r round(min(quantity.rand.bychild$xds_mph),2)`--`r round(max(quantity.rand.bychild$xds_mph),2)`), of which an average of `r round(mean(quantity.rand.bychild$tds_mph),2)` minutes were directed toward the target child (median = `r round(median(quantity.rand.bychild$tds_mph),2)`; range = `r round(min(quantity.rand.bychild$tds_mph),2)`--`r round(max(quantity.rand.bychild$tds_mph),2)`). Consequently, the mean proportion of speech directed to children was `r round(mean(quantity.rand.bychild$prop_tds),2)` (median = `r round(median(quantity.rand.bychild$prop_tds),2)`; range = `r round(min(quantity.rand.bychild$prop_tds),2)`--`r round(max(quantity.rand.bychild$prop_tds),2)`). By-child estimates of the overheard speech (other-directed speech; 'ODS') rate, target-child-directed speech ('TCDS') rate, proportion TCDS (TCDS/(TCDS+ODS)), and TCDS rate from adult vs. child caregivers are shown in [figure 1](#fig1). To these figures we have added estimates from prior work with other communities.\footnote{The Yucatec Mayan data from Shneidman and colleagues was originally reported in utterances per hour. We convert their estimates to minutes per hour using the median utterance duration in our dataset for all non-target child speakers (`r avg.utt.len.tseltal$median.utt.len`ms)}.


```{r fig1, echo=FALSE, fig.cap="By-child estimates for minutes per hour of all overheard speech (upper left), target-child-directed speech (upper right), proportion target-child-directed speech (lower left), and proportion of TCDS coming from adults vs. children (lower right; adults = purple). Black dots and boxplots indicate variance in each measure across the nine 5-minute random Tseltal clips. Bands on the linear trends show 95% CIs.", message=FALSE, warning=FALSE, fig.height=4}
grid.arrange(odsmph.segments.rand, tdsmph.segments.rand.zoomedin,
             tdsprp.segments.rand, tdsprp.segments.sa.rand, nrow=2, ncol=2)
```

```{r prepare_random_for_models, message=FALSE, warning=FALSE, paged.print=FALSE}
# prepare predictors for modeling
quantity.rand$child_sex <- as.factor(quantity.rand$child_sex)
quantity.rand$mat_ed <- as.factor(quantity.rand$mat_ed)
nspkrs.m <- mean(quantity.rand$n_spkrs_clip)
nspkrs.sd <- sd(quantity.rand$n_spkrs_clip)
quantity.rand <- quantity.rand %>%
  mutate(
    xds_mph.nz = ifelse(xds_mph > 0, 1, 0),
    ods_mph.nz = ifelse(ods_mph > 0, 1, 0),
    tds_mph.nz = ifelse(tds_mph > 0, 1, 0),
    cds_mph.nz = ifelse(cds_mph > 0, 1, 0),
    tchiyr.std = ((age_mo_round - tchiyr.m)/tchiyr.sd),
    chisx.std = recode_factor(child_sex,
                              "M" = "M", "F" = "F"),
    mated.std = recode_factor(mat_ed,
                              "none" = "none", "primary" = "primary",
                              "secondary" = "secondary", "preparatory" = "preparatory"),
    mated.bin = recode_factor(mat_ed,
                              "none" = "0-5", "primary" = "0-5",
                              "secondary" = "6+", "preparatory" = "6+"),
    motyr.std = ((mother_age - motyr.m)/motyr.sd),
    nsb.std = ((number_older_sibs - nsb.m)/nsb.sd),
    hsz.std = ((household_size - hsz.m)/hsz.sd),
    nsk.std = ((n_spkrs_clip - nspkrs.m)/nspkrs.sd),
    stthr.std = (start.hr - 12)/12)

quantity.rand.sa$child_sex <- as.factor(quantity.rand.sa$child_sex)
quantity.rand.sa$mat_ed <- as.factor(quantity.rand.sa$mat_ed)
nspkrs.sa.m <- mean(quantity.rand.sa$n_spkrs_clip)
nspkrs.sa.sd <- sd(quantity.rand.sa$n_spkrs_clip)
quantity.rand.sa <- quantity.rand.sa %>%
  mutate(
    xds_mph.sa.nz = ifelse(xds_mph.sa > 0, 1, 0),
    ods_mph.sa.nz = ifelse(ods_mph.sa > 0, 1, 0),
    tds_mph.sa.nz = ifelse(tds_mph.sa > 0, 1, 0),
    cds_mph.sa.nz = ifelse(cds_mph.sa > 0, 1, 0),
    tchiyr.std = ((age_mo_round - tchiyr.m)/tchiyr.sd),
    chisx.std = recode_factor(child_sex,
                              "M" = "M", "F" = "F"),
    mated.std = recode_factor(mat_ed,
                              "none" = "none", "primary" = "primary",
                              "secondary" = "secondary", "preparatory" = "preparatory"),
    mated.bin = recode_factor(mat_ed,
                              "none" = "0-5", "primary" = "0-5",
                              "secondary" = "6+", "preparatory" = "6+"),
    motyr.std = ((mother_age - motyr.m)/motyr.sd),
    nsb.std = ((number_older_sibs - nsb.m)/nsb.sd),
    hsz.std = ((household_size - hsz.m)/hsz.sd),
    nsk.std = ((n_spkrs_clip - nspkrs.sa.m)/nspkrs.sa.sd),
    stthr.std = (start.hr - 12)/12)

# Predictors
#tchiyr.std, chisx.std, mated.std, nsb.std, hsz.std, nsk.std, & SpkrAge (for quantity.rand.sa)
```

We modeled these measures for the nine clips from each child using mixed-effects regression using the glmmTMB package in R (REF). Notably, gaussian linear regression is not appropriate for any of our measures<!--ADD TO THE PRECEDING SENTENCE--> . The rate-based dependent variables (ODS min/hr and TCDS min/hr) are continuous with a zero-inflated positive distribution, the proportion TCDS variable (TCDS/(TCDS+ODS)) is doubly-bounded, and the number of speakers is count data (i.e., non-continuous).

To address this issue for the rate variables (ODS and TDS min/hr), we rounded each rate estimate down to nearest minute per hour to treat it as count data and then employed zero-inflated negative binomial regression (ZINB). ZINB regressions model the dependent variable in two ways: (1) a binomial ('zero-inflation') model that evaluates the likelihood that a datapoint is zero or non-zero and (2) a negative binomial ('conditional') model of all the non-zero datapoints (REF). <!--IMPROVE THE PRECEDING DESCRIPTION--> For proportion TCDS we used beta regression, which is suited to making predictions on doubly-bounded data (for more details see Smithson REFS).

Our primary predictors were as follows: child age, household size, and number of non-target-child speakers present in that clip (all centered and standardized), plus maternal education (pre-secondary vs. secondary-plus)\footnote{Spanish-only education begins in secondary school.}, and squared time of day at the start of the clip (in decimal hours; centered on noon and standardized). We used squared time of day to model the cycle of activity at home: mealtimes in the mornings and evenings should be more similar to each other than the afternoon because of dispersal for chores. To this we also added two-way interactions between child age and maternal education, number of speakers, household size, and time of day. Finally, we included a random effect of child, with random slopes of time of day, unless doing so resulted in model non-convergence. Finally, for the zero-inflation models of zero-vs-nonzero ODS and TDS rate, we included household size, number of speakers present, and time of day, with interactions between time of day and household size and time of day and number of speakers present. The zero-inflation models used the same random effects structure as their complementary conditional models. We often had to reduce the fixed effects structure in the zero-inflation model to achieve convergence, as detailed below.

```{r baseline_random_models, message=FALSE, warning=FALSE, paged.print=FALSE}
## ODS random sample ####
# zero-inflated negative binomial #----
ods.rand.zinb <- glmmTMB(round(ods_mph,0) ~
                           tchiyr.std + mated.bin +
                           hsz.std + nsk.std +
                           I(stthr.std^2) +
                           tchiyr.std:mated.bin +
                           tchiyr.std:nsk.std +
                           tchiyr.std:hsz.std +
                           tchiyr.std:I(stthr.std^2) +
                           (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                         data=quantity.rand,
                         ziformula=~hsz.std*I(stthr.std^2), # max: no cvgnce w/ nsk.std added
                         family="nbinom1")
#summary(ods.rand.zinb)
#nsk.std                    1.055521   0.101104  10.440   <2e-16 ***
#I(stthr.std^2)             2.181219   1.061030   2.056   0.0398 *  
#tchiyr.std:hsz.std         0.340160   0.159935   2.127   0.0334 *  
#tchiyr.std:I(stthr.std^2)  2.057602   1.121681   1.834   0.0666 . 
# No significant ZI effects


## TDS random sample ####
# zero-inflated negative binomial #----
tds.rand.zinb <- glmmTMB(round(tds_mph,0) ~
                           tchiyr.std + mated.bin +
                           hsz.std + nsk.std +
                           I(stthr.std^2) +
                           tchiyr.std:mated.bin +
                           tchiyr.std:nsk.std +
                           tchiyr.std:hsz.std +
                           tchiyr.std:I(stthr.std^2) +
                           (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                         data=quantity.rand,
                         ziformula=~I(stthr.std^2)*hsz.std + I(stthr.std^2)*nsk.std,
                         family="nbinom1")
#summary(tds.rand.zinb)
#tchiyr.std                 0.60658    0.25042   2.422  0.01542 *  
#tchiyr.std:mated.bin6+    -0.48337    0.28692  -1.685  0.09205 .  
#tchiyr.std:nsk.std         0.53447    0.20010   2.671  0.00756 ** 
#tchiyr.std:I(stthr.std^2) -3.49942    1.56044  -2.243  0.02492 *  
# ZI:
#I(stthr.std^2)         -203.7060    84.2445  -2.418   0.0156 *
#hsz.std                   1.8436     0.9068   2.033   0.0420 *
#I(stthr.std^2):nsk.std -151.6625    67.4473  -2.249   0.0245 *


## TDS by speaker age random sample ####
# zero-inflated negative binomial #----
tds.rand.sa.zinb <- glmmTMB(round(tds_mph.sa,0) ~
                              tchiyr.std + mated.bin + SpkrAge + 
                              hsz.std + nsk.std +
                              I(stthr.std^2) +
                              tchiyr.std:mated.bin +
                              tchiyr.std:nsk.std +
#                              tchiyr.std:hsz.std + # no convgnce w/ this extra term
                              tchiyr.std:I(stthr.std^2) +
                              SpkrAge:tchiyr.std +
                              SpkrAge:nsk.std +
                              (1+I(stthr.std^2)|aclew_child_id),
                            data=quantity.rand.sa,
                            ziformula=~I(stthr.std^2)*hsz.std, # no cvgnce w/ nsk.std
                            family="nbinom1")
#summary(tds.rand.sa.zinb)
#tchiyr.std                 0.41564    0.23913   1.738   0.0822 .  
#mated.bin6+            -0.50436    0.29467  -1.712   0.0870 .  
#SpkrAgeChild              -1.96474    0.38865  -5.055 4.30e-07 ***
#tchiyr.std:I(stthr.std^2) -3.65566    1.78746  -2.045   0.0408 *  
#SpkrAgeChild:nsk.std       1.19675    0.37203   3.217   0.0013 **
# ZI
#I(stthr.std^2)         -79.8951    43.4582  -1.838    0.066 .


## propTDS random sample ####
# beta regression #----
quantity.rand.prpdata <- subset(quantity.rand, !(is.na(prop_tds)))
# requires that 0 < y < 1: so we transform (y * (nâ1) + 0.5) / n where n = sample size
quantity.rand.prpdata$prp_tds_sqz <- (quantity.rand.prpdata$prop_tds * (nrow(quantity.rand.prpdata)-1) + 0.5)/nrow(quantity.rand.prpdata)

prptds.rand.beta <- glmmTMB(prp_tds_sqz ~
                              tchiyr.std + mated.bin +
                              hsz.std + nsk.std +
                              I(stthr.std^2) +
                              tchiyr.std:mated.bin +
                              tchiyr.std:nsk.std +
                              tchiyr.std:hsz.std +
                              tchiyr.std:I(stthr.std^2) +
                              (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                            data=quantity.rand.prpdata,
                            family=list(family="beta",link="logit"))
#summary(prptds.rand.beta)
#nsk.std                   -0.97009    0.22427  -4.326 1.52e-05 ***
#tchiyr.std:I(stthr.std^2) -4.23693    1.94410  -2.179   0.0293 *  
```

The quantity of other-directed speech (ODS) was primarily affected by the number of speakers present (MODEL-REF): more speakers was associated with more overheard speech. ODS was also significantly affected by time of day, being more frequent in the mornings and evenings than around midday (MODEL-REF). ODS was also more frequent in large households for older children compared to younger children (MODEL-REF). There was no significant effect of child age overall, and no effect involving maternal education. The zero-inflation model of ODS included fixed effects of household size, time of day, and their interaction, but none of these predictors were significant.

``` {r visualize_rand_ods_effects}
# Nspeakers:
#nsk.std                    1.055521   0.101104  10.440   <2e-16 ***
#ggplot() + geom_point(data = quantity.rand, aes(x = nsk.std, y = round(ods_mph,0))) + geom_smooth(data = quantity.rand, aes(x = nsk.std, y = round(ods_mph,0)), method = "lm")

# Time of day:
#I(stthr.std^2)             2.181219   1.061030   2.056   0.0398 *  
#ggplot() + geom_smooth(data = quantity.rand, aes(x = start.hr, y = round(ods_mph,0)), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = quantity.rand, aes(x = start.hr, y = round(ods_mph,0)))
#ggplot() + geom_smooth(data = quantity.rand, aes(x = start.hr, y = round(ods_mph,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = quantity.rand, aes(x = start.hr, y = round(ods_mph,0), group = age_mo_round)) + facet_grid(~ age_mo_round)

# House size * chi age:
#tchiyr.std:hsz.std         0.340160   0.159935   2.127   0.0334 *
#ggplot() + geom_raster(data = quantity.rand, aes(y = tchiyr.std, x = hsz.std, fill = round(ods_mph,0)))
```

The quantity of target-directed speech (TCDS) was primarily affected by factors relating to the child's age. Older children heard more TCDS (MODEL-REF) than younger children in general, particularly when many other speakers were present (MODEL-REF). This also meant that, compared to younger children, older children showed a much stronger effect of time of day: younger children tended to hear a stable quantity of TCDS throughout the day while older children heard much more TCDS in the mornings and evenings compared to midday (MODEL-REF). The zero-inflation model of TCDS also showed significant effects of house size, time of day, and the interaction of time of day and number of speakers; TCDS is more likely to be present in smaller households (MODEL-REF) and in the mornings and evenings (MODEL-REF), particularly when there are more speakers present (MODEL-REF).

``` {r visualize_rand_tds_effects}
# Chi age:
#tchiyr.std                 0.60658    0.25042   2.422  0.01542 *  
#ggplot() + geom_point(data = quantity.rand, aes(x = age_mo_round, y = round(tds_mph,0))) + geom_smooth(data = quantity.rand, aes(x = age_mo_round, y = round(tds_mph,0)), method = "lm")

# Nspeaker * chi age:
#tchiyr.std:nsk.std         0.53447    0.20010   2.671  0.00756 ** 
#ggplot() + geom_point(data = quantity.rand, aes(y = round(tds_mph,0), x = nsk.std, color = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.rand, aes(y = round(tds_mph,0), x = nsk.std, color = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm")

# Time of day * chi age:
#tchiyr.std:I(stthr.std^2) -3.49942    1.56044  -2.243  0.02492 *  
#ggplot() + geom_smooth(data = quantity.rand, aes(x = start.hr, y = round(tds_mph,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = quantity.rand, aes(x = start.hr, y = round(tds_mph,0), group = age_mo_round)) + facet_grid(~ age_mo_round)
#ggplot(data = quantity.rand) + geom_point(data = quantity.rand, aes(y = round(tds_mph,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.rand, aes(y = round(tds_mph,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm", formula = y ~ poly(x, 2)) + facet_grid(~ as.factor(ifelse(age_mo_round < 13, -1, 1)))

# ZI - household size (note ZI estimates are prob of DV being 0 ~ flip for interpretation):
#hsz.std                   1.8436     0.9068   2.033   0.0420 *
#ggplot() + geom_violin(data = quantity.rand, aes(x = as.factor(tds_mph.nz), y = household_size)) + geom_jitter(data = quantity.rand, aes(x = as.factor(tds_mph.nz), y = household_size))

# ZI - time of day (note ZI estimates are prob of DV being 0 ~ flip for interpretation):
#I(stthr.std^2)         -203.7060    84.2445  -2.418   0.0156 *
#ggplot() + geom_smooth(data = quantity.rand, aes(x = start.hr, y = tds_mph.nz), method = "lm", formula = y ~ poly(x, 2))

# ZI - time of day * Nspeakers (note ZI estimates are prob of DV being 0 ~ flip for interpretation):
#I(stthr.std^2):nsk.std -151.6625    67.4473  -2.249   0.0245 *
#ggplot() + geom_violin(data = quantity.rand, aes(x = as.factor(tds_mph.nz), y = n_spkrs_clip)) + geom_jitter(data = quantity.rand, aes(x = as.factor(tds_mph.nz), y = n_spkrs_clip, color = stthr.std^2, size = stthr.std^2))

```

As reviewed above, previous work on Mayan communities, including the Tseltal community suggests that Mayan children hear much TCDS from other children, and that the proportion of TCDS from other children increases with age (REFS). In order to analyze the effect speaker age (child or adult TCDS) together with the other predictors modeled above, we split the data into TCDS from adults and children. All other predictors remained the same, only the number of speakers present represented the number of speakers of the relevant type for that datapoint (i.e.,, TCDS rate from adults in clip 1 given the number of adult speakers present in clip 1).

The quantity of TCDS was strongly affected by speaker age: in contrast to prior work, these data show that most TCDS comes from adults (MODEL-REF). In addition, this model replicates the interaction between child age and time of day: older children hear most of their TCDS in the mornings and evenings while younger children hear stable TCDS over the day (MODEL-REF). We also find that speaker age effects depend on how many speakers there are of each type: while TCDS form children is more likely when more children are present, adults do not show a similar effect (MODEL-REF). The zero-inflation model of TCDS from adults and children included fixed effects of household size, time of day, and their interaction, but none of these predictors were significant.

``` {r visualize_rand_tds.sa_effects}
# Speaker age:
#SpkrAgeChild              -1.96474    0.38865  -5.055 4.30e-07 ***
#ggplot() + geom_violin(data = quantity.rand.sa, aes(x = SpkrAge, y = round(tds_mph.sa,0))) + geom_jitter(data = quantity.rand.sa, aes(x = SpkrAge, y = round(tds_mph.sa,0)))

# Time of day * chi age:
#tchiyr.std:I(stthr.std^2) -3.65566    1.78746  -2.045   0.0408 *  
#ggplot(data = quantity.rand.sa) + geom_point(data = quantity.rand.sa, aes(y = round(tds_mph.sa,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.rand.sa, aes(y = round(tds_mph.sa,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm", formula = y ~ poly(x, 2)) + facet_grid(~ as.factor(ifelse(age_mo_round < 13, -1, 1)))

# Speaker age * Nspeakers:
#SpkrAgeChild:nsk.std       1.19675    0.37203   3.217   0.0013 **
#ggplot() + geom_point(data = quantity.rand.sa, aes(y = round(tds_mph.sa,0), x = nsk.std, color = SpkrAge)) + geom_smooth(data = quantity.rand.sa, aes(y = round(tds_mph.sa,0), x = nsk.std, color = SpkrAge), method = "lm")
```

The overall proportion of speech directed to the child (proportion TCDS) decreased when more speakers were present (MODEL-REF). Despite this, older children still showed a stronger time of day effect than younger children, with proportionally more TCDS in the mornings and evenings (MODEL-REF). There were no significant overall effects of age, nor were there any effects of maternal education or household size on the proportion of TCDS used.

``` {r visualize_rand_prptds_effects}
# Nspeakers:
#nsk.std                   -0.97009    0.22427  -4.326 1.52e-05 ***
#ggplot() + geom_point(data = quantity.rand.prpdata, aes(x = nsk.std, y = prp_tds_sqz)) + geom_smooth(data = quantity.rand.prpdata, aes(x = nsk.std, y = prp_tds_sqz), method = "lm")

# Time of day * chi age:
#tchiyr.std:I(stthr.std^2) -4.23693    1.94410  -2.179   0.0293 * 
#ggplot(data = quantity.rand.prpdata) + geom_point(data = quantity.rand.prpdata, aes(y = prp_tds_sqz, x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.rand.prpdata, aes(y = prp_tds_sqz, x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm", formula = y ~ poly(x, 2)) + facet_grid(~ as.factor(ifelse(age_mo_round < 13, -1, 1)))
```

### Speech quantity during peak moments
```{r nonrandom_quantity_prep, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# Get min/hr speech measures
all.nonrand.segments <- seg.info %>%
  filter(!(grepl("random", CodeName))) %>%
  select(aclew_id, CodeName) %>%
  rename(aclew_child_id = aclew_id, segment = CodeName)
all.nonrand.segments$sample <- ifelse(grepl("va", all.nonrand.segments$segment),
                                      "high-activity","turn-taking")
all.nonrand.segments$sample_type <- ifelse(grepl("^va", all.nonrand.segments$segment),
                                      "high-activity", ifelse(
                                        grepl("^tt", all.nonrand.segments$segment),"turn-taking",
                                        "extension"))
# XDS
xds.per.seg.nonrand <- all.data %>%
  filter(sample != "random" & speaker != "CHI" &
           grepl("xds@", tier)) %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(xds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 1, xds_min = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         xds_mph = (xds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# ODS
ods.per.seg.nonrand <- all.data %>%
  filter(sample != "random" & speaker != "CHI" &
           grepl("xds@", tier) & val != "T") %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(ods_min = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 1, ods_min = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         ods_mph = (ods_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# TDS
tds.per.seg.nonrand <- all.data %>%
  filter(sample != "random" & speaker != "CHI" &
           grepl("xds@", tier) & val == "T") %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(tds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 1, tds_min = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         tds_mph = (tds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# All CDS
cds.per.seg.nonrand <- all.data %>%
  filter(sample != "random" & speaker != "CHI" &
           grepl("xds@", tier) & (val == "T" | val == "C")) %>%
  group_by(aclew_child_id, segment, segment_dur) %>%
  summarise(cds_min = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(segment_dur = 1, cds_min = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         cds_mph = (cds_min/segment_dur)*60) %>%
  arrange(aclew_child_id, segment)
# Number of speakers per clip
spkrs.per.seg.nonrand <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           !(grepl("@", tier))) %>%
  group_by(aclew_child_id, segment) %>%
  summarise(n_spkrs_clip = length(unique(speaker)))
# All together
quantity.nonrand <- xds.per.seg.nonrand %>%
  full_join(ods.per.seg.nonrand, by = c("aclew_child_id", "segment",
                                        "segment_dur", "sample", "sample_type")) %>%
  full_join(tds.per.seg.nonrand, by = c("aclew_child_id", "segment",
                                        "segment_dur", "sample", "sample_type")) %>%
  full_join(cds.per.seg.nonrand, by = c("aclew_child_id", "segment",
                                        "segment_dur", "sample", "sample_type")) %>%
  full_join(ptcp.info, by = "aclew_child_id") %>%
  full_join(spkrs.per.seg.nonrand, by = c("aclew_child_id", "segment")) %>%
  left_join(dplyr::select(seg.info, c("aclew_id", "CodeName", "start.hr")),
            by = c("aclew_child_id" = "aclew_id", "segment" = "CodeName")) %>%
  replace_na(list(xds_min = 0, xds_mph = 0,
                  ods_min = 0, ods_mph = 0,
                  tds_min = 0, tds_mph = 0,
                  cds_min = 0, cds_mph = 0,
                  n_spkrs_clip = 0)) %>%
  mutate(prop_tds = tds_min/xds_min)
  # Don't replace NAs with 0s in this case; proportion is not meaningful w/o any speech
quantity.nonrand.bychild <- quantity.nonrand %>%
  group_by(aclew_child_id, sample) %>%
  summarise(
    xds_min = mean(xds_min),
    xds_mph = mean(xds_mph),
    ods_min = mean(ods_min),
    ods_mph = mean(ods_mph),
    tds_min = mean(tds_min),
    tds_mph = mean(tds_mph),
    cds_min = mean(cds_min),
    cds_mph = mean(cds_mph),
    prop_tds = mean(prop_tds, na.rm = TRUE),
    m_n_spkrs = mean(n_spkrs_clip)) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# Get xds and tds min/hr by speaker type
all.nonrand.segments.sa <- tibble(
  aclew_child_id = rep(all.nonrand.segments$aclew_child_id, 2),
  segment = rep(all.nonrand.segments$segment, 2),
  sample = rep(all.nonrand.segments$sample, 2),
  sample_type = rep(all.nonrand.segments$sample_type, 2),
  SpkrAge = c(rep("Adult", nrow(all.nonrand.segments)),
              rep("Child", nrow(all.nonrand.segments))))
# XDS
xds.per.seg.nonrand.sa <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier)) %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(xds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 1, xds_min.sa = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         xds_mph.sa = (xds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# ODS
ods.per.seg.nonrand.sa <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & val != "T") %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(ods_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 1, ods_min.sa = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         ods_mph.sa = (ods_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# TDS
tds.per.seg.nonrand.sa <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & val == "T") %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(tds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 1, tds_min.sa = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         tds_mph.sa = (tds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# All CDS
cds.per.seg.nonrand.sa <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           grepl("xds@", tier) & (val == "T" | val == "C")) %>%
  group_by(aclew_child_id, SpkrAge, segment, segment_dur) %>%
  summarise(cds_min.sa = round(sum(dur)/60000,3)) %>%
  full_join(all.nonrand.segments.sa, by = c("aclew_child_id", "segment", "SpkrAge")) %>%
  replace_na(list(segment_dur = 1, cds_min.sa = 0)) %>%
  mutate(segment_dur = ifelse(grepl("ext", segment), 5, 1),
         cds_mph.sa = (cds_min.sa/segment_dur)*60) %>%
  arrange(aclew_child_id, segment, SpkrAge)
# Number of speakers per clip
spkrs.per.seg.nonrand.sa <- all.data %>%
  filter(sample != "random" & speaker != "CHI" & SpkrAge != "Not known" &
           !(grepl("@", tier))) %>%
  group_by(aclew_child_id, SpkrAge, segment) %>%
  summarise(n_spkrs_clip = length(unique(speaker)))
# All together
quantity.nonrand.sa <- xds.per.seg.nonrand.sa %>%
  full_join(ods.per.seg.nonrand.sa, by = c("aclew_child_id", "SpkrAge",
                                           "segment", "segment_dur",
                                           "sample", "sample_type")) %>%
  full_join(tds.per.seg.nonrand.sa, by = c("aclew_child_id", "SpkrAge",
                                           "segment", "segment_dur",
                                           "sample", "sample_type")) %>%
  full_join(cds.per.seg.nonrand.sa, by = c("aclew_child_id", "SpkrAge",
                                           "segment", "segment_dur",
                                           "sample", "sample_type")) %>%
  full_join(select(quantity.nonrand, c("aclew_child_id", "segment", "tds_min")),
            by = c("aclew_child_id", "segment")) %>%
  full_join(ptcp.info, by = "aclew_child_id") %>%
  full_join(spkrs.per.seg.nonrand.sa, by = c("aclew_child_id", "SpkrAge", "segment")) %>%
  left_join(dplyr::select(seg.info, c("aclew_id", "CodeName", "start.hr")),
            by = c("aclew_child_id" = "aclew_id", "segment" = "CodeName")) %>%
  replace_na(list(xds_min.sa = 0, xds_mph.sa = 0,
                  ods_min.sa = 0, ods_mph.sa = 0,
                  tds_min.sa = 0, tds_mph.sa = 0,
                  cds_min.sa = 0, cds_mph.sa = 0,
                  n_spkrs_clip = 0)) %>%
  mutate(prop_tds.sa = tds_min.sa/xds_min.sa,
         prop_sa.tds = tds_min.sa/tds_min)
  # Don't replace NAs with 0s in this case; proportion is not meaningful w/o any speech

# Subset the non-random samples (used for differnt purposes)
quantity.nonrand.tt <- filter(quantity.nonrand, sample == "turn-taking")
quantity.nonrand.tt.sa <- filter(quantity.nonrand.sa, sample == "turn-taking")
quantity.nonrand.va <- filter(quantity.nonrand, sample != "turn-taking")
quantity.nonrand.va.sa <- filter(quantity.nonrand.sa, sample != "turn-taking")
```

```{r make_tt_quantity_plots, message=FALSE, warning=FALSE, paged.print=FALSE}
# Graph the basic speech quantity info
# XDS min/hr
xdsmph.segments.tt <- ggplot(quantity.nonrand.tt,
                          aes(x = age_mo_round, y = xds_mph)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = xds_mph),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("XDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,85),
                     breaks=seq(0,85,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,85),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# ODS min/hr
odsmph.segments.tt <- ggplot(quantity.nonrand.tt,
                          aes(x = age_mo_round, y = ods_mph)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = ods_mph),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("ODS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS min/hr
tdsmph.segments.tt <- ggplot(quantity.nonrand.tt,
      aes(x = age_mo_round, y = tds_mph)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = tds_mph),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

tdsmph.segments.tt.zoomedin <- ggplot(quantity.nonrand.tt,
                                   aes(x = age_mo_round, y = tds_mph)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = tds_mph),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,40),
                     breaks=seq(0,40,10)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,40),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS prop
tdsprp.segments.tt <- ggplot(quantity.nonrand.tt,
                          aes(x = age_mo_round, y = prop_tds)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = prop_tds),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS/All spch") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# prop TDS from adults vs. children
tdsprp.segments.tt.sa <- ggplot(quantity.nonrand.tt.sa,
                             aes(x = age_mo_round, y = prop_sa.tds,
                                 group = SpkrAge, fill = SpkrAge, color = SpkrAge)) +
  geom_smooth(data=quantity.rand.sa,
              aes(x = age_mo_round, y = prop_sa.tds,
                  group = SpkrAge, fill = SpkrAge, color = SpkrAge),
              method = "lm",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = interaction(age_mo_round, SpkrAge),
                   fill = SpkrAge, color = SpkrAge),
               position = position_dodge(1), outlier.shape = NA, alpha = 0.3) +
  geom_smooth(method = "lm") +
  ylab("Prop of TCDS") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1), xlim=c(0,38)) +
  col.sample.bu3 +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# number of speakers per clip
nspkrs.segments.tt <- ggplot(quantity.nonrand.tt,
                          aes(x = age_mo_round, y = n_spkrs_clip)) +
  geom_smooth(data=quantity.rand, aes(x = age_mo_round, y = n_spkrs_clip),
              method = "lm", color = "black",
              lty = "dashed", se = FALSE) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("# Speakers") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,10),
                     breaks=seq(0,10,2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,10),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))
```

Children's linguistic experiences are bursty (REFS) and, as we have seen, speech is distributed asymetrically throughout the day in Tseltal children's environments. If, for example, children do most of their language learning for the day during these short bouts of interaction, it may be more useful to characterize their learning environment with respect to the interactional periods---what kinds of speech do they hear during interaction?---rather than averaging over the entire day. We therefore repeat the same set of analyses with the turn-taking subset of the child's data: ODS rate, TCDS rate, TCDS rate by speaker age, and proportion TCDS.

During high turn-taking clips, Tseltal children heard an average of `r round(mean(subset(quantity.nonrand.bychild, sample == "turn-taking")$xds_mph),2)` minutes of speech per hour (median = `r round(median(subset(quantity.nonrand.bychild, sample == "turn-taking")$xds_mph),2)`; range = `r round(min(subset(quantity.nonrand.bychild, sample == "turn-taking")$xds_mph),2)`--`r round(max(subset(quantity.nonrand.bychild, sample == "turn-taking")$xds_mph),2)`), of which an average of `r round(mean(subset(quantity.nonrand.bychild, sample == "turn-taking")$tds_mph),2)` minutes were directed toward the target child (median = `r round(median(subset(quantity.nonrand.bychild, sample == "turn-taking")$tds_mph),2)`; range = `r round(min(subset(quantity.nonrand.bychild, sample == "turn-taking")$tds_mph),2)`--`r round(max(subset(quantity.nonrand.bychild, sample == "turn-taking")$tds_mph),2)`). Consequently, the mean proportion of speech directed to children was `r round(mean(subset(quantity.nonrand.bychild, sample == "turn-taking")$prop_tds),2)` (median = `r round(median(subset(quantity.nonrand.bychild, sample == "turn-taking")$prop_tds),2)`; range = `r round(min(subset(quantity.nonrand.bychild, sample == "turn-taking")$prop_tds),2)`--`r round(max(subset(quantity.nonrand.bychild, sample == "turn-taking")$prop_tds),2)`). <!--By-child estimates of ODS rate, TCDS rate, TCDS rate from adult vs. child speakers, and proportion TCDS are shown in [figure 2](#fig2).-->

```{r fig2, echo=FALSE, fig.cap="By-child estimates for minutes per hour of all overheard speech (upper left), target-child-directed speech (upper right), proportion target-child-directed speech (lower left), and proportion of TCDS coming from adults vs. children (lower right; adults = purple). Black dots and boxplots indicate variance in each measure across the high turn-taking Tseltal clips. Bands on the solid linear trends show 95% CIs. Dashed linear trends indicate averages from the randomly sampled clips for comparison. ", message=FALSE, warning=FALSE, fig.height=4}
grid.arrange(odsmph.segments.tt, tdsmph.segments.tt.zoomedin,
             tdsprp.segments.tt, tdsprp.segments.tt.sa, nrow=2, ncol=2)
```

```{r prepare_tt_for_models, message=FALSE, warning=FALSE, paged.print=FALSE}
# prepare predictors for modeling
quantity.nonrand.tt$child_sex <- as.factor(quantity.nonrand.tt$child_sex)
quantity.nonrand.tt$mat_ed <- as.factor(quantity.nonrand.tt$mat_ed)
nspkrs.m <- mean(quantity.nonrand.tt$n_spkrs_clip)
nspkrs.sd <- sd(quantity.nonrand.tt$n_spkrs_clip)
quantity.nonrand.tt <- quantity.nonrand.tt %>%
  mutate(
    xds_mph.nz = ifelse(xds_mph > 0, 1, 0),
    ods_mph.nz = ifelse(ods_mph > 0, 1, 0),
    tds_mph.nz = ifelse(tds_mph > 0, 1, 0),
    cds_mph.nz = ifelse(cds_mph > 0, 1, 0),
    tchiyr.std = ((age_mo_round - tchiyr.m)/tchiyr.sd),
    chisx.std = recode_factor(child_sex,
                              "M" = "M", "F" = "F"),
    mated.std = recode_factor(mat_ed,
                              "none" = "none", "primary" = "primary",
                              "secondary" = "secondary", "preparatory" = "preparatory"),
    mated.bin = recode_factor(mat_ed,
                              "none" = "0-5", "primary" = "0-5",
                              "secondary" = "6+", "preparatory" = "6+"),
    motyr.std = ((mother_age - motyr.m)/motyr.sd),
    nsb.std = ((number_older_sibs - nsb.m)/nsb.sd),
    hsz.std = ((household_size - hsz.m)/hsz.sd),
    nsk.std = ((n_spkrs_clip - nspkrs.m)/nspkrs.sd),
    stthr.std = (start.hr - 12)/12)

quantity.nonrand.tt.sa$child_sex <- as.factor(quantity.nonrand.tt.sa$child_sex)
quantity.nonrand.tt.sa$mat_ed <- as.factor(quantity.nonrand.tt.sa$mat_ed)
nspkrs.sa.m <- mean(quantity.nonrand.tt.sa$n_spkrs_clip)
nspkrs.sa.sd <- sd(quantity.nonrand.tt.sa$n_spkrs_clip)
quantity.nonrand.tt.sa <- quantity.nonrand.tt.sa %>%
  mutate(
    xds_mph.sa.nz = ifelse(xds_mph.sa > 0, 1, 0),
    ods_mph.sa.nz = ifelse(ods_mph.sa > 0, 1, 0),
    tds_mph.sa.nz = ifelse(tds_mph.sa > 0, 1, 0),
    cds_mph.sa.nz = ifelse(cds_mph.sa > 0, 1, 0),
    tchiyr.std = ((age_mo_round - tchiyr.m)/tchiyr.sd),
    chisx.std = recode_factor(child_sex,
                              "M" = "M", "F" = "F"),
    mated.std = recode_factor(mat_ed,
                              "none" = "none", "primary" = "primary",
                              "secondary" = "secondary", "preparatory" = "preparatory"),
    mated.bin = recode_factor(mat_ed,
                              "none" = "0-5", "primary" = "0-5",
                              "secondary" = "6+", "preparatory" = "6+"),
    motyr.std = ((mother_age - motyr.m)/motyr.sd),
    nsb.std = ((number_older_sibs - nsb.m)/nsb.sd),
    hsz.std = ((household_size - hsz.m)/hsz.sd),
    nsk.std = ((n_spkrs_clip - nspkrs.sa.m)/nspkrs.sa.sd),
    stthr.std = (start.hr - 12)/12)

# Predictors
#tchiyr.std, chisx.std, mated.std, nsb.std, hsz.std, nsk.std, & SpkrAge (for quantity.rand.sa)
```

Using the same approach as before, we modeled the four speech quantity measures for the 5--6 turn-taking clips\footnote{The turn-taking clips included in this analysis are: the five 1-minute turn-taking clips and also the 5-minute 'extension' clip for that recording if it was an extension of a turn-taking clip} from each recording.

```{r baseline_tt_models, message=FALSE, warning=FALSE, paged.print=FALSE}
# Note: I'm not going to use an offset of segment_dur because:
# (1) it behaves a little weirdly (and non-conservatively!) and sometimes causes non-cvgnce
# (2) the DVs are relative (i.e., minutes per hour) so some sample diff is already mitigated

## ODS random sample ####
# zero-inflated negative binomial #----
ods.tt.zinb <- glmmTMB(round(ods_mph,0) ~
                           tchiyr.std + mated.bin +
                           hsz.std + nsk.std +
                           I(stthr.std^2) +
                           tchiyr.std:mated.bin +
                           tchiyr.std:nsk.std +
                           tchiyr.std:hsz.std +
                           tchiyr.std:I(stthr.std^2) +
                           (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                         data=quantity.nonrand.tt,
                         ziformula=~hsz.std*I(stthr.std^2), # max: no cvgnce w/ nsk.std added
                         family="nbinom1")
#summary(ods.tt.zinb)
#nsk.std                    0.75978    0.12625   6.018 1.77e-09 ***
#I(stthr.std^2)            -4.51876    2.32867  -1.940   0.0523 .  
# No significant ZI effects


## TDS random sample ####
# zero-inflated negative binomial #----
tds.tt.zinb <- glmmTMB(round(tds_mph,0) ~
                           tchiyr.std + mated.bin +
                           hsz.std + nsk.std +
                           I(stthr.std^2) +
                           tchiyr.std:mated.bin +
                           tchiyr.std:nsk.std +
                           tchiyr.std:hsz.std +
                           tchiyr.std:I(stthr.std^2) +
                           (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                         data=quantity.nonrand.tt,
                         ziformula=~I(stthr.std^2)*hsz.std + I(stthr.std^2)*nsk.std,
                         family="nbinom1")
#summary(tds.tt.zinb)
#nsk.std                   -0.173899   0.097452  -1.784  0.07435 .  
#tchiyr.std:hsz.std        -0.312828   0.171197  -1.827  0.06765 .  
#tchiyr.std:I(stthr.std^2) -3.767934   1.252014  -3.009  0.00262 ** 
# No significant ZI effects


## TDS by speaker age random sample ####
# zero-inflated negative binomial #----
tds.tt.sa.zinb <- glmmTMB(round(tds_mph.sa,0) ~
                              tchiyr.std + mated.bin + SpkrAge + 
                              hsz.std + nsk.std +
                              I(stthr.std^2) +
                              tchiyr.std:mated.bin +
                              tchiyr.std:nsk.std +
#                              tchiyr.std:hsz.std + # no convgnce w/ this extra term
                              tchiyr.std:I(stthr.std^2) +
                              SpkrAge:tchiyr.std +
                              SpkrAge:nsk.std +
                              (1+I(stthr.std^2)|aclew_child_id),
                            data=quantity.nonrand.tt.sa,
                            ziformula=~I(stthr.std^2)*hsz.std, # no cvgnce w/ nsk.std
                            family="nbinom1")
#summary(tds.tt.sa.zinb)
#SpkrAgeChild              -2.251455   0.312293  -7.209 5.62e-13 ***
#nsk.std                   -0.296705   0.134996  -2.198  0.02796 *  
#tchiyr.std:I(stthr.std^2) -4.197429   1.967005  -2.134  0.03285 *  
#tchiyr.std:SpkrAgeChild    0.895499   0.273544   3.274  0.00106 ** 
#SpkrAgeChild:nsk.std       1.508982   0.267585   5.639 1.71e-08 ***
# No significant ZI effects


## propTDS random sample ####
# beta regression #----
quantity.nonrand.tt.prpdata <- subset(quantity.nonrand.tt, !(is.na(prop_tds)))
# requires that 0 < y < 1: so we transform (y * (nâ1) + 0.5) / n where n = sample size
quantity.nonrand.tt.prpdata$prp_tds_sqz <- (quantity.nonrand.tt.prpdata$prop_tds *
                                        (nrow(quantity.nonrand.tt.prpdata)-1) +
                                        0.5)/nrow(quantity.nonrand.tt.prpdata)

prptds.tt.beta <- glmmTMB(prp_tds_sqz ~
                              tchiyr.std + mated.bin +
                              hsz.std + nsk.std +
                              I(stthr.std^2) +
                              tchiyr.std:mated.bin +
                              tchiyr.std:nsk.std +
                              tchiyr.std:hsz.std +
                              tchiyr.std:I(stthr.std^2) +
                              (1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
                            data=quantity.nonrand.tt.prpdata,
                            family=list(family="beta",link="logit"))
#summary(prptds.tt.beta)
#nsk.std                   -1.41053    0.19543  -7.218 5.29e-13 ***
#tchiyr.std:nsk.std         0.33378    0.18997   1.757   0.0789 .  
```

As in the random sample, when more speakers were present, ODS was significantly more frequent (MODEL-REF). While time of day significantly affected ODS rate in the random sample, its effect on the turn-taking bouts was only marginal, and trended in the opposite direction, i.e., more overheard speech during afternoon turn-taking bouts (MODEL-REF). Furthermore, there was no evidence of interactions between time of day and household size, as there was in the random sample. The zero-inflation model included fixed effects of household size, time of day, and their interaction, but none of these predictors were significant.

``` {r visualize_tt_ods_effects}
# Nspeakers:
#nsk.std                    0.75978    0.12625   6.018 1.77e-09 ***
#ggplot() + geom_point(data = quantity.nonrand.tt, aes(x = nsk.std, y = round(ods_mph,0))) + geom_smooth(data = quantity.nonrand.tt, aes(x = nsk.std, y = round(ods_mph,0)), method = "lm")

# Time of day:
#I(stthr.std^2)            -4.51876    2.32867  -1.940   0.0523 .  
#ggplot() + geom_smooth(data = quantity.nonrand.tt, aes(x = start.hr, y = round(ods_mph,0)), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = quantity.nonrand.tt, aes(x = start.hr, y = round(ods_mph,0)))
```

The only significant factor affecting TCDS quantity in the turn-taking sample was a two-way interaction between child age and time of day (MODEL-REF). In contrast to the random sample this interaction showed that younger children hear more TCDS during morning and evening turn-taking bouts, but TCDS is more uniform across the day in older children's turn-taking bouts. Unlike the random sample, this turn-taking sample showed no main effect of child age: older and younger children heard comparable amounts of TCDS overall. There was also no significant interaction between age and number of speakers present, like there was in the random sample. The zero-inflation model included fixed effects of household size, time of day, and number of speakers, plus two-way interactions of time of day and household size, and time of day and number of speakers present. While, in the random sample, clips with no-vs-some TCDS were significantly predicted by house size, time of day, and the interaction of time of day and number of speakers, none of these factors significantly predicted the presence of TCDS in the turn-taking clips.

``` {r visualize_tt_tds_effects}
# Time of day * chi age:
#tchiyr.std:I(stthr.std^2) -3.767934   1.252014  -3.009  0.00262 ** 
#ggplot() + geom_smooth(data = quantity.nonrand.tt, aes(x = start.hr, y = round(tds_mph,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = quantity.nonrand.tt, aes(x = start.hr, y = round(tds_mph,0), group = age_mo_round)) + facet_grid(~ age_mo_round)
#ggplot(data = quantity.nonrand.tt) + geom_point(data = quantity.nonrand.tt, aes(y = round(tds_mph,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.nonrand.tt, aes(y = round(tds_mph,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm", formula = y ~ poly(x, 2)) + facet_grid(~ as.factor(ifelse(age_mo_round < 13, -1, 1)))
```

The model of TCDS quantity by speaker age for the turn-taking sample showed some similar results to the random sample. First, the quantity of TCDS in the turn-taking sample was strongly affected by speaker age (MODEL-REF) due to the fact that most TCDS still came from adults. Second, the presence of more children increased the quantity of TCDS from children more than the presence of more adults increased the quantity of TCDS from adults (MODEL-REF). However, TCDS quantity by speaker in the turn taking data also showed an inverse effect of time of day and child age, compared to that found in the randomly sampled data: TCDS was maximized during turn-taking bouts that took place in the mornings and evenings for younger children, but more uniform throughout the day for older children (MODEL-REF).

In addition, the turn-taking bouts also showed a significant effect of number of speakers: more speakers was associated with less TCDS (MODEL-REF). There was also an interaction between child age and speaker age: older children heard an increasing amount of TCDS from other children during turn-taking bouts (MODEL-REF). The zero-inflation model of TCDS from adults and children included fixed effects of household size, time of day, and their interaction, but none of these predictors were significant.

``` {r visualize_tt_tds.sa_effects}
# Speaker age:
#SpkrAgeChild              -2.251455   0.312293  -7.209 5.62e-13 ***
#ggplot() + geom_violin(data = quantity.nonrand.tt.sa, aes(x = SpkrAge, y = round(tds_mph.sa,0))) + geom_jitter(data = quantity.nonrand.tt.sa, aes(x = SpkrAge, y = round(tds_mph.sa,0)))

# Time of day * chi age:
#tchiyr.std:I(stthr.std^2) -4.197429   1.967005  -2.134  0.03285 *  
#ggplot(data = quantity.nonrand.tt.sa) + geom_point(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1)))) + geom_smooth(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = start.hr, group = as.factor(ifelse(age_mo_round < 13, -1, 1))), method = "lm", formula = y ~ poly(x, 2)) + facet_grid(~ as.factor(ifelse(age_mo_round < 13, -1, 1)))

# Speaker age * Nspeakers:
#SpkrAgeChild:nsk.std       1.508982   0.267585   5.639 1.71e-08 ***
#ggplot() + geom_point(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = nsk.std, color = SpkrAge)) + geom_smooth(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = nsk.std, color = SpkrAge), method = "lm")

# Nspeakers (graphed trend here goes opposite to model):
#nsk.std                   -0.296705   0.134996  -2.198  0.02796 *  
#ggplot() + geom_smooth(data = quantity.nonrand.tt.sa, aes(x = nsk.std, y = round(tds_mph.sa,0)), method = "lm") + geom_point(data = quantity.nonrand.tt.sa, aes(x = nsk.std, y = round(tds_mph.sa,0)))

# Speaker age * chi age:
#tchiyr.std:SpkrAgeChild    0.895499   0.273544   3.274  0.00106 ** 
#ggplot() + geom_point(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = tchiyr.std, color = SpkrAge)) + geom_smooth(data = quantity.nonrand.tt.sa, aes(y = round(tds_mph.sa,0), x = tchiyr.std, color = SpkrAge), method = "lm")
```

As in the random sample, the overall proportion of speech directed to the child (proportion TCDS) decreased when more speakers were present (MODEL-REF). Unlike the random sample, however, there was no interaction between child age and time of day. There were no other significant predictors of proportion of speech in TCDS.

``` {r visualize_tt_prptds_effects}
# Nspeakers:
#nsk.std                   -1.41053    0.19543  -7.218 5.29e-13 ***
#ggplot() + geom_point(data = quantity.nonrand.tt.prpdata, aes(x = nsk.std, y = prp_tds_sqz)) + geom_smooth(data = quantity.nonrand.tt.prpdata, aes(x = nsk.std, y = prp_tds_sqz), method = "lm")
```


## Interaction measures
### Interaction measures during peak moments

## Frequency of high turn-taking activity












<!--## How to define temporal contingency for turn taking
Many other studies of child-caregiver turn taking use an arbitrary cut-off for detecting contingency (5 seconds?? Look up references). We base ours on measures of turn taking in interactions with infants and young children. Hilbrink et al. (2015) looked at interaction in a longitudinal corpus from 3 to 18 months and found that infants' responses to mothers began between -700ms and 1200ms relative to the end of the mothers' turns. Complementarily, mothers' responses to infant vocalizations began between -350ms and 650ms relative to the end of the infants' turns. Casillas et al. (2016) investigated the timing of question-answer responses from caregiver to child and from child to caregiver with children between 20 and 35 months. In their study, children's responses typically started between -500ms and 650ms relative to the end of their caregivers' turns. Caregivers' responses typically started between -1000ms and 400ms relative to the end of their children's turns. Because both studies focused on fairly intensive bouts of interaction, and both within WEIRD parental contexts, we defined contingent responses in the current data with slightly generous allowances for overlap and gap: contingent responses must begin with no more than `r allowed.overlap`ms of overlap and `r allowed.gap`ms of gap relative to the offset of the first speaker's turn. We used this same criteria for finding child-to-other turn transitions and other-to-child turn transitions. Transitions were only counted if the other speaker's turn was coded as addressed to 'T' (the target child).-->

<!--Potentially redefine allowed.overlap and allowed.gap based on Â±2.5SD of timing distributions for Hilbrink and Casillas data-->



<!--
  - How much speech do children hear during bouts/bursts of interaction? How often do these bursts occur?
    - *measures*: deltas for m/h TDS, #utts TDS, # TT transitions between random, tt, and va: are they actually different?
    - *measures*: XDS and TDS minutes per hour and proportion (from tt and va selections: do they show similar age effects?)
    - *measures*: sliding window in random to match mean TDS rate/TT transition rates
  - Does interaction influence linguistic practice?
    - *measures*: m/h CHI vocs, # CHI vocs, & voc mat between random, tt, and va
- Discussion
  - Summary of findings
  - When thinking about quantity: Do we care about the avg over the day or do bursts matter more?
    - Benefits of naps between bursts? Natural input cycle? How many 'good' minutes are enough to spur learning on?
  - How should we think about CDS? What is universal about its format?
  - So what is the impact of input in this community? What do we predict?
    - One point often raised: do these kids show a delay? Problematize this.
    - More interesting: language experience itself shapes use of mechanisms for learning, e.g., learning fro overhearing (Shneidman)
  - Big issue we have to face as work continues in this vein: what are these kids learning? We can't continue to pretend that we are capable of defining and encapsulating a phenomenon as emergent as language.
  - Limitations
    - no video data
    - only 10 kids-->
    
<!--## Still to graph
3: sliding window in random to match mean TDS rate/TT transition rates
4: utt length, repetitiveness, F0 peaks and ranges


###Observation only data
13 months Directed speech 140 (55); Overheard speech 377 (176)
18 months Directed speech 211 (70); Overheard speech 240 (96)
24 months Directed speech 315 (69); Overheard speech 360 (73)
(I think these data weren't coded for adult vs. child speaker)
-->



``` {r chi_voctypes_overall}
chi.vm.lx.utts <- all.data %>%
  filter((tier == "vcm@CHI" | tier == "lex@CHI" | tier == "mwu@CHI")) %>%
  mutate(voc.rating = ifelse(val == "M", 4,
                             ifelse((val == "1" | val == "W"), 3,
                                    ifelse((val == "0" | val == "C"), 2,
                                           ifelse(val == "N", 1, 0))))) %>%
  filter(voc.rating > 0) %>%
  group_by(aclew_child_id, segment, sample, start) %>%
  summarise(max_voc.rtg = max(voc.rating))

all.voc.types.per.child <- tibble(
  aclew_child_id = rep(ptcp.info$aclew_child_id, 4),
  max_voc.rtg = c(rep(1, length(ptcp.info$aclew_child_id)), rep(2, length(ptcp.info$aclew_child_id)),
                  rep(3, length(ptcp.info$aclew_child_id)), rep(4, length(ptcp.info$aclew_child_id)))
)

chi.nvocs <- chi.vm.lx.utts %>%
  group_by(aclew_child_id) %>%
  summarise(n_vocs = n())

chi.vm.lx.voc.type.props <- chi.vm.lx.utts %>%
  group_by(aclew_child_id, max_voc.rtg) %>%
  summarise(n_voc.type = n()) %>%
  full_join(all.voc.types.per.child, by = c("aclew_child_id", "max_voc.rtg")) %>%
  replace_na(list(n_voc.type = 0)) %>%
  full_join(chi.nvocs, by = "aclew_child_id") %>%
  mutate(prop_voc.type = round(n_voc.type/n_vocs, 3)) %>%
  arrange(aclew_child_id, max_voc.rtg) %>%
  full_join(ptcp.info, by = "aclew_child_id")
```

``` {r plot_chi_voctypes_overall}
chi.vm.lx.voc.type.props <- chi.vm.lx.voc.type.props %>%
  mutate(voc.type = factor(as.factor(max_voc.rtg), labels = c("NCB", "CB", "SW", "MW")))
voc.mat.by.age <- ggplot(
  data = chi.vm.lx.voc.type.props,
  aes(x = age_mo_round, y = prop_voc.type, group = as.factor(voc.type))) +
  geom_point(aes(color = as.factor(voc.type))) +
  geom_smooth(aes(color = as.factor(voc.type), fill = as.factor(voc.type)), method = "loess") +
  ylab("Prop of linguistic vocs") + xlab("Child age (mo)") +
  labs(fill='Voc type') +
  labs(color='Voc type') +
  scale_y_continuous(limits=c(-0.5,1.5),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1), xlim=c(0,38)) +
  theme_apa() + theme(
    legend.position = c(0.9, 0.85),
    legend.background = element_rect(fill="transparent"),
    axis.line = element_line(color="black", size = 0.4))
voc.mat.by.age
```

``` {r sample_differences}
# deltas m/h XDS, TDS, and CDS mph
quantity.mph.per.sample <- quantity.rand %>%
  mutate(sample = "random",
         sample_type = "random") %>%
  bind_rows(quantity.nonrand) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_xds_mph = mean(xds_mph),
         m_tds_mph = mean(tds_mph),
         m_cds_mph = mean(cds_mph))
deltas.random.v.tt <- quantity.mph.per.sample %>%
  filter(sample != "high-activity") %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_xds_mph = 0,
         d_tds_mph = 0,
         d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.tt)) {
  deltas.random.v.tt$d_xds_mph[i] <-
    deltas.random.v.tt$m_xds_mph[i] -
    deltas.random.v.tt$m_xds_mph[i-1] # set up for tt - random
  deltas.random.v.tt$d_tds_mph[i] <-
    deltas.random.v.tt$m_tds_mph[i] - deltas.random.v.tt$m_tds_mph[i-1]
  deltas.random.v.tt$d_cds_mph[i] <-
    deltas.random.v.tt$m_cds_mph[i] - deltas.random.v.tt$m_cds_mph[i-1]
}
deltas.random.v.tt <- deltas.random.v.tt %>%
  filter(sample != "random") %>% # only keep meaningful vals
  select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
  mutate(delta = "tt-random")
deltas.random.v.va <- quantity.mph.per.sample %>%
  filter(sample != "turn-taking") %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_xds_mph = 0,
         d_tds_mph = 0,
         d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.va)) {
  deltas.random.v.va$d_xds_mph[i] <-
    deltas.random.v.va$m_xds_mph[i-1] -
    deltas.random.v.va$m_xds_mph[i] # set up for va - random
  deltas.random.v.va$d_tds_mph[i] <-
    deltas.random.v.va$m_tds_mph[i-1] - deltas.random.v.va$m_tds_mph[i]
  deltas.random.v.va$d_cds_mph[i] <-
    deltas.random.v.va$m_cds_mph[i-1] - deltas.random.v.va$m_cds_mph[i]
}
deltas.random.v.va <- deltas.random.v.va %>%
  filter(sample == "random") %>% # only keep meaningful vals
  select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth <- bind_rows(deltas.random.v.tt, deltas.random.v.va) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# deltas utt/h XDS, TDS, and CDS
tot.dur.samples.per.rec <- seg.info %>%
  mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
         sample = ifelse(grepl('random', CodeName), "random",
                         ifelse(grepl('va', CodeName), "high-activity",
                                "turn-taking"))) %>%
  select(aclew_id, CodeName, duration, sample) %>%
  rename(aclew_child_id = aclew_id, segment = CodeName)
n.utts.per.sample.all <- all.data %>%
  filter(speaker != "CHI" & grepl("xds@", tier)) %>%
  group_by(aclew_child_id, segment, val) %>%
  summarise(n_utts = n()) %>%
  full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(val = "T", n_utts = 0))
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(xds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_xds_uph = mean(xds_uph))
n.utts.per.sample.tds <- n.utts.per.sample.all %>%
  filter(val == "T") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(tds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_tds_uph = mean(tds_uph))
n.utts.per.sample.cds <- n.utts.per.sample.all %>%
  filter(val == "T" | val == "C") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(cds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_cds_uph = mean(cds_uph))
uph.per.sample <- n.utts.per.sample.xds %>%
  full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample")) %>%
  full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample"))
deltas.random.v.tt.uph <- uph.per.sample %>%
  filter(sample != "high-activity") %>%
  mutate(d_xds_uph = 0,
         d_tds_uph = 0,
         d_cds_uph = 0) %>%
  arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.tt.uph)) {
  deltas.random.v.tt.uph$d_xds_uph[i] <-
    deltas.random.v.tt.uph$m_xds_uph[i] - deltas.random.v.tt.uph$m_xds_uph[i-1]
  deltas.random.v.tt.uph$d_tds_uph[i] <-
    deltas.random.v.tt.uph$m_tds_uph[i] - deltas.random.v.tt.uph$m_tds_uph[i-1]
  deltas.random.v.tt.uph$d_cds_uph[i] <-
    deltas.random.v.tt.uph$m_cds_uph[i] - deltas.random.v.tt.uph$m_cds_uph[i-1]
}
deltas.random.v.tt.uph <- deltas.random.v.tt.uph %>%
  filter(sample != "random") %>%
  select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
  mutate(delta = "tt-random")
deltas.random.v.va.uph <- uph.per.sample %>%
  filter(sample != "turn-taking") %>%
  mutate(d_xds_uph = 0,
         d_tds_uph = 0,
         d_cds_uph = 0) %>%
  arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.va.uph)) {
  deltas.random.v.va.uph$d_xds_uph[i] <-
    deltas.random.v.va.uph$m_xds_uph[i-1] - deltas.random.v.va.uph$m_xds_uph[i]
  deltas.random.v.va.uph$d_tds_uph[i] <-
    deltas.random.v.va.uph$m_tds_uph[i-1] - deltas.random.v.va.uph$m_tds_uph[i]
  deltas.random.v.va.uph$d_cds_uph[i] <-
    deltas.random.v.va.uph$m_cds_uph[i-1] - deltas.random.v.va.uph$m_cds_uph[i]
}
deltas.random.v.va.uph <- deltas.random.v.va.uph %>%
  filter(sample == "random") %>%
  select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.utts <- bind_rows(deltas.random.v.tt.uph, deltas.random.v.va.uph) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# TT transitions
all.segments <- all.rand.segments %>%
  mutate(sample = "random", sample_type = "random") %>%
  bind_rows(all.nonrand.segments) %>%
  arrange(aclew_child_id, segment)
turn.transitions <- tibble(
  aclew_child_id = NA,
  segment = NA,
  tier = NA,
  speaker = NA,
  start = NA,
  stop = NA,
  tm1.tier = NA,
  tm1.speaker = NA,
  tm1.start = NA,
  tm1.stop = NA,
  tm1.val = NA,
  tp1.tier = NA,
  tp1.speaker = NA,
  tp1.start = NA,
  tp1.stop = NA,
  tp1.val = NA
)
for (i in 1:nrow(all.segments)) {
  subdata <- all.data %>%
    filter(aclew_child_id == all.segments$aclew_child_id[i] &
             segment == all.segments$segment[i])
  c_utt <- subdata %>%
    filter(tier == "CHI")
  used.tm1s <- c()
  used.tp1s <- c()
  child <- all.segments$aclew_child_id[i]
  # Save turn-by-turn info
  chi.turn.info <- c_utt %>%
    select(aclew_child_id, segment, tier, speaker, start, stop) %>%
    mutate(tm1.tier = NA, tm1.speaker = NA, tm1.start = NA, tm1.stop = NA, tm1.val = NA,
           tp1.tier = NA, tp1.speaker = NA, tp1.start = NA, tp1.stop = NA, tp1.val = NA)
  for (j in 1:nrow(c_utt)) {
    # Find CHI-OTH transitions
    tp1.start <- c_utt$stop[j] - allowed.overlap
    tp1.stop <- tp1.start + allowed.overlap + allowed.gap
    t.plus1 <- which(subdata$speaker != "CHI" &
                    (subdata$val == "T"|subdata$val == "C") &
                    subdata$start >= tp1.start &
                    subdata$start <= tp1.stop)
   # Find OTH-CHI transitions
    tm1.start <- c_utt$start[j] - allowed.gap
    tm1.stop <- tm1.start + allowed.gap + allowed.overlap
    t.minus1 <- which(subdata$speaker != "CHI" &
                    (subdata$val == "T"|subdata$val == "C") &
                    subdata$stop <= tm1.stop &
                    subdata$stop >= tm1.start)
    if(length(t.plus1) > 0) {
      tp1.match <- 0
      for (turn in t.plus1) {
        if (!(turn %in% used.tp1s) & tp1.match == 0) {
          used.tp1s <- c(used.tp1s, turn)
          chi.turn.info$tp1.tier[j] <- subdata$tier[turn]
          chi.turn.info$tp1.speaker[j] <- subdata$speaker[turn]
          chi.turn.info$tp1.start[j] <- subdata$start[turn]
          chi.turn.info$tp1.stop[j] <- subdata$stop[turn]
          chi.turn.info$tp1.val[j] <- subdata$val[turn]
          tp1.match <- 1
        }
      }
    }
    if(length(t.minus1) > 0) {
      tm1.match <- 0
      for (turn in t.minus1) {
        if (!(turn %in% used.tm1s) & tm1.match == 0) {
          used.tm1s <- c(used.tm1s, turn)
          chi.turn.info$tm1.tier[j] <- subdata$tier[turn]
          chi.turn.info$tm1.speaker[j] <- subdata$speaker[turn]
          chi.turn.info$tm1.start[j] <- subdata$start[turn]
          chi.turn.info$tm1.stop[j] <- subdata$stop[turn]
          chi.turn.info$tm1.val[j] <- subdata$val[turn]
          tm1.match <- 1
        }
      }
    }
  }
  turn.transitions <- bind_rows(turn.transitions, chi.turn.info)
}
turn.transitions <- turn.transitions %>%
  filter(!(is.na(tier)))
turn.transitions.overview.o_c <- turn.transitions %>%
  group_by(aclew_child_id, segment, tm1.val) %>%
  summarise(n.o_c.tts = n()) %>%
  rename(oth.spkr = tm1.val) %>%
  replace_na(list(oth.spkr = "O"))
turn.transitions.overview.c_o <- turn.transitions %>%
  group_by(aclew_child_id, segment, tp1.val) %>%
  summarise(n.c_o.tts = n()) %>%
  rename(oth.spkr = tp1.val) %>%
  replace_na(list(oth.spkr = "O"))
all.tt.combos <-  all.segments %>%
  rbind(all.segments) %>%
  rbind(all.segments) %>%
  mutate(oth.spkr = c(rep("T", nrow(all.segments)),
                      rep("C", nrow(all.segments)),
                      rep("O", nrow(all.segments))),
         duration = ifelse(grepl('extension', sample_type), 5,
                           ifelse(grepl('random', sample_type), 5, 1))) %>%
  arrange(aclew_child_id, segment, oth.spkr) %>%
  full_join(turn.transitions.overview.o_c,
            by = c("aclew_child_id", "segment", "oth.spkr")) %>%
  full_join(turn.transitions.overview.c_o,
            by = c("aclew_child_id", "segment", "oth.spkr")) %>%
  replace_na(list(n.o_c.tts = 0, n.c_o.tts = 0)) %>%
  arrange(aclew_child_id, segment, oth.spkr)
tth.per.sample.tds <- all.tt.combos %>%
  filter(oth.spkr == "T") %>%
  group_by(aclew_child_id, sample) %>%
  summarise(dur.sample = sum(duration),
            S.o_c.tth.tds = sum(n.o_c.tts),
            S.c_o.tth.tds = sum(n.c_o.tts)) %>%
  mutate(o_c.tth.tds = (S.o_c.tth.tds/dur.sample)*60,
         c_o.tth.tds = (S.c_o.tth.tds/dur.sample)*60)
tth.per.sample.cds <- all.tt.combos %>%
  filter(oth.spkr == "T" | oth.spkr == "C") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_o_c.tts.TC = sum(n.o_c.tts),
            n_c_o.tts.TC = sum(n.c_o.tts)) %>%
  ungroup() %>%
  group_by(aclew_child_id, sample) %>%
  summarise(dur.sample = sum(duration),
            S.o_c.tth.cds = sum(n_o_c.tts.TC),
            S.c_o.tth.cds = sum(n_c_o.tts.TC)) %>%
  mutate(o_c.tth.cds = (S.o_c.tth.cds/dur.sample)*60,
         c_o.tth.cds = (S.c_o.tth.cds/dur.sample)*60)
tth.per.sample <- tth.per.sample.tds %>%
  select(-dur.sample) %>%
  full_join(tth.per.sample.cds, by = c("aclew_child_id", "sample")) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_o_c.tth.tds = 0,
         d_c_o.tth.tds = 0,
         d_o_c.tth.cds = 0,
         d_c_o.tth.cds = 0)
deltas.random.v.tt.tth <- tth.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.tth)) {
  deltas.random.v.tt.tth$d_o_c.tth.tds[i] <-
    deltas.random.v.tt.tth$o_c.tth.tds[i] -
    deltas.random.v.tt.tth$o_c.tth.tds[i-1] # set up for tt - random
  deltas.random.v.tt.tth$d_c_o.tth.tds[i] <-
    deltas.random.v.tt.tth$c_o.tth.tds[i] - deltas.random.v.tt.tth$c_o.tth.tds[i-1]
  deltas.random.v.tt.tth$d_o_c.tth.cds[i] <-
    deltas.random.v.tt.tth$o_c.tth.cds[i] -
    deltas.random.v.tt.tth$o_c.tth.cds[i-1]
  deltas.random.v.tt.tth$d_c_o.tth.cds[i] <-
    deltas.random.v.tt.tth$c_o.tth.cds[i] - deltas.random.v.tt.tth$c_o.tth.cds[i-1]
}
deltas.random.v.tt.tth <- deltas.random.v.tt.tth %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_o_c.tth.tds, d_c_o.tth.tds, d_o_c.tth.cds, d_c_o.tth.cds) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.tth <- tth.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.tth)) {
  deltas.random.v.ha.tth$d_o_c.tth.tds[i] <-
    deltas.random.v.ha.tth$o_c.tth.tds[i-1] -
    deltas.random.v.ha.tth$o_c.tth.tds[i] # set up for ha - random
  deltas.random.v.ha.tth$d_c_o.tth.tds[i] <-
    deltas.random.v.ha.tth$c_o.tth.tds[i-1] - deltas.random.v.ha.tth$c_o.tth.tds[i]
  deltas.random.v.ha.tth$d_o_c.tth.cds[i] <-
    deltas.random.v.ha.tth$o_c.tth.cds[i-1] -
    deltas.random.v.ha.tth$o_c.tth.cds[i]
  deltas.random.v.ha.tth$d_c_o.tth.cds[i] <-
    deltas.random.v.ha.tth$c_o.tth.cds[i-1] - deltas.random.v.ha.tth$c_o.tth.cds[i]
}
deltas.random.v.ha.tth <- deltas.random.v.ha.tth %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_o_c.tth.tds, d_c_o.tth.tds, d_o_c.tth.cds, d_c_o.tth.cds) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.tth <- deltas.random.v.tt.tth %>%
  bind_rows(deltas.random.v.ha.tth) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# CHIVOC mph and uph
chi.voc <- all.data %>%
  filter(tier == "CHI") %>%
  group_by(aclew_child_id, segment) %>%
  summarise(n_utts = n(),
            dur.utts = round(sum(dur)/60000,3)) %>%
  full_join(all.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(n_utts = 0, dur.utts = 0)) %>%
  mutate(duration = ifelse(grepl('extension', segment), 5,
                                 ifelse(grepl('random', segment), 5, 1)))
chi.voc.per.sample <- chi.voc %>%
  group_by(aclew_child_id, sample) %>%
  summarise(S_n_utts = sum(n_utts),
            S_dur.utts = sum(dur.utts),
            S_duration = sum(duration)) %>%
  mutate(cvc_uph = (S_n_utts/S_duration)*60,
         cvc_mph = (S_dur.utts/S_duration)*60) %>%
  select(-S_n_utts, -S_dur.utts, -S_duration) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_cvc_uph = 0,
         d_cvc_mph = 0)
deltas.random.v.tt.cvc <- chi.voc.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.cvc)) {
  deltas.random.v.tt.cvc$d_cvc_uph[i] <-
    deltas.random.v.tt.cvc$cvc_uph[i] -
    deltas.random.v.tt.cvc$cvc_uph[i-1] # set up for tt - random
  deltas.random.v.tt.cvc$d_cvc_mph[i] <-
    deltas.random.v.tt.cvc$cvc_mph[i] - deltas.random.v.tt.cvc$cvc_mph[i-1]
}
deltas.random.v.tt.cvc <- deltas.random.v.tt.cvc %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_cvc_uph, d_cvc_mph) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.cvc <- chi.voc.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.cvc)) {
  deltas.random.v.ha.cvc$d_cvc_uph[i] <-
    deltas.random.v.ha.cvc$cvc_uph[i-1] -
    deltas.random.v.ha.cvc$cvc_uph[i] # set up for ha - random
  deltas.random.v.ha.cvc$d_cvc_mph[i] <-
    deltas.random.v.ha.cvc$cvc_mph[i-1] - deltas.random.v.ha.cvc$cvc_mph[i]
}
deltas.random.v.ha.cvc <- deltas.random.v.ha.cvc %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_cvc_uph, d_cvc_mph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.cvc <- deltas.random.v.tt.cvc %>%
  bind_rows(deltas.random.v.ha.cvc) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# CHIVM
chi.vm.lx.per.segment <- chi.vm.lx.utts %>%
  group_by(aclew_child_id, sample, segment) %>%
  summarise(n_vocs = n(),
            m_voc.rtg = mean(max_voc.rtg),
            md_voc.rtg = median(max_voc.rtg),
            sd_voc.rtg = sd(max_voc.rtg)) %>%
  full_join(ptcp.info, by = c("aclew_child_id"))
chi.vm.lx.per.sample <- chi.vm.lx.per.segment %>%
  group_by(aclew_child_id, sample) %>%
  summarise(voc_rtg = mean(m_voc.rtg)) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_voc_rtg = 0)
deltas.random.v.tt.vrt <- chi.vm.lx.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.vrt)) {
  deltas.random.v.tt.vrt$d_voc_rtg[i] <-
    deltas.random.v.tt.vrt$voc_rtg[i] -
    deltas.random.v.tt.vrt$voc_rtg[i-1] # set up for tt - random
}
deltas.random.v.tt.vrt <- deltas.random.v.tt.vrt %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_voc_rtg) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.vrt <- chi.vm.lx.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.vrt)) {
  deltas.random.v.ha.vrt$d_voc_rtg[i] <-
    deltas.random.v.ha.vrt$voc_rtg[i-1] -
    deltas.random.v.ha.vrt$voc_rtg[i] # set up for ha - random
}
deltas.random.v.ha.vrt <- deltas.random.v.ha.vrt %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_voc_rtg) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.vrt <- deltas.random.v.tt.vrt %>%
  bind_rows(deltas.random.v.ha.vrt) %>%
  full_join(ptcp.info, by = "aclew_child_id")
```

``` {r plot_sample_differences, message=FALSE, warning=FALSE, paged.print=FALSE}
# XDS/TDS/CDS mph and uph
# mph: deltas.random.v.oth
# uph: deltas.random.v.oth.utts
deltas.random.v.oth.input <- deltas.random.v.oth %>%
  full_join(select(deltas.random.v.oth.utts, aclew_child_id,
                   delta, d_xds_uph, d_tds_uph, d_cds_uph),
            by = c("aclew_child_id", "delta"))

# TDS MPH: Delta TDS mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_tds_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_tds_mph)) %>%
           select(se))[[1]]
)
delta.tds.mph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCDS (min/hr)"))) +
  ylim(c(-30,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# XDS MPH: Delta XDS mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_xds_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_xds_mph)) %>%
           select(se))[[1]]
)
delta.xds.mph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"XDS (min/hr)"))) +
  ylim(c(-30,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS UPH: Delta TDS uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_tds_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_tds_uph)) %>%
           select(se))[[1]]
)
delta.tds.uph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCDS (utt/hr)"))) +
  ylim(c(-700,1000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# XDS UPH: Delta XDS uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_xds_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_xds_uph)) %>%
           select(se))[[1]]
)
delta.xds.uph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"XDS (utt/hr)"))) +
  ylim(c(-700,1000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

#grid.arrange(delta.tds.mph.plot,delta.xds.mph.plot,
#             delta.tds.uph.plot,delta.xds.uph.plot, nrow=2, ncol=2)


# CHI VOC: Delta voc mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.cvc %>%
              group_by(delta) %>%
              summarise(m = mean(d_cvc_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.cvc %>%
           group_by(delta) %>%
           summarise(se = sem(d_cvc_mph)) %>%
           select(se))[[1]]
)
delta.cvc.mph.plot <- ggplot(
  data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph)) +
  geom_violin(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph)) +
  geom_jitter(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc (min/hr)"))) +
  ylim(c(-10,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# CHI VOC: Delta voc uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.cvc %>%
              group_by(delta) %>%
              summarise(m = mean(d_cvc_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.cvc %>%
           group_by(delta) %>%
           summarise(se = sem(d_cvc_uph)) %>%
           select(se))[[1]]
)
delta.cvc.uph.plot <- ggplot(
  data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph)) +
  geom_violin(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph)) +
  geom_jitter(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc (utt/hr)"))) +
  ylim(c(-100,2000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# CHI VOCMAT: Delta voc mat rating between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.vrt %>%
              group_by(delta) %>%
              summarise(m = mean(d_voc_rtg)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.vrt %>%
           group_by(delta) %>%
           summarise(se = sem(d_voc_rtg)) %>%
           select(se))[[1]]
)
delta.voc.rtg.plot <- ggplot(
  data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg)) +
  geom_violin(data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg)) +
  geom_jitter(data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc mat (1-4)"))) +
  ylim(c(-.2,0.6)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS/CDS ttph: Delta O->C transitions between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.tth %>%
              group_by(delta) %>%
              summarise(m = mean(d_o_c.tth.tds)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.tth %>%
           group_by(delta) %>%
           summarise(se = sem(d_o_c.tth.tds)) %>%
           select(se))[[1]]
)
delta.tds.tth.o_c.plot <- ggplot(
  data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds)) +
  geom_violin(data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds)) +
  geom_jitter(data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"OTH-TCHI (tt/hr)"))) +
  ylim(c(-100,600)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS/CDS ttph: Delta C->O transitions between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.tth %>%
              group_by(delta) %>%
              summarise(m = mean(d_c_o.tth.tds)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.tth %>%
           group_by(delta) %>%
           summarise(se = sem(d_c_o.tth.tds)) %>%
           select(se))[[1]]
)
delta.tds.tth.c_o.plot <- ggplot(
  data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds)) +
  geom_violin(data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds)) +
  geom_jitter(data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCHI-OTH (tt/hr)"))) +
  ylim(c(-100,600)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

#grid.arrange(delta.cvc.mph.plot,delta.voc.rtg.plot,
#             delta.tds.tth.o_c.plot, delta.tds.tth.c_o.plot, nrow=2, ncol=2)

```

``` {r prevalence_tt_estimate}
best.min.avgs <- tth.per.sample %>%
  filter(sample != "random") %>%
  select(-d_c_o.tth.cds, -d_c_o.tth.tds, -d_o_c.tth.cds, -d_o_c.tth.tds)

```

# Discussion {#disc}
## Future directions {#disc-future}
## Conclusion {#disc-conclusion}

<!--ADS vs. CDS might not be right for kids who can learn from overhearing; Penny: ``clearly the relevant comparison is with speech not addressed to the child but to which the child is at least potentially attending. Speech around a non-attending child (e.g., speech on the telephone, or radio) is not likely to have any effects. Even if overheard speech is less effective in predicting later vocabulary size than speech addressed directly to the child, its role in Mayan lexical acquisition seems worth pursuing further'' (pp. 77; Brown 2014)-->

<!--Estimates of child-directed speech quantity may functionally predict children's word learning because they index the frequency with which children engage in rich, multimodal interactions with their caregivers; interactions in which children can actively and contingently elicit just the right linguistic information at just the right time to be optimally interesting and useful for learning (REFS; Eve's paper on homophonic Vs in French).-->

<!--One serious issue is how we define adult-like linguistic competence, especially within models in which we consider that adults still continue learning and that individual differences are rampant between adults in both linguistic knowledge and skill at every level, from phonetics to syntax to pragmatics, and of course vocabulary too. When we talk about language acquisition, especially cross-culturally, we have to be careful about what we think the ``target'' is and what are considered to be the developmental benchmarks children achieve. The focus recently has been on vocabulary acquisition, for some of the reasons outline above. However, vocabulary is a particularly literacy-centric view of language development. If we were to go back in time and set the seed of developmental language science in another culture, we might be much more concerned about the acquisition of kinship systems and other complex relational language, or in the ability to design elaborately indirect speech acts. Acquiring a language involves the mastery of a shockingly diverse array of skills and knowledge: not just linguistic symbols and systems, but also the infrastructure underlying their use (e.g., interactional skills), the cognitive-general skills supporting those systems. There's no reason _a priori_ to believe that every aspect of language acquisition is equally influenced by environmental features. For example, children's pointing frequency is influenced by the amount of pointing in their environment, but the age of pointing onset---the age which they first begin to point---appears unaffected by the frequency of pointing in their environment (REFS: Matthews, Liszkowski).-->

<!--means are meaningless if the thing that matters is some threshhold of interaction. well, not fully if we take evidence from cross-situational learning in wihch # of exposures matters, but even then we might expect bursty exposures to be more effective than non-bursty ones if memory is an issue... isn't there a Lew-Williams paper along these lines?-->

<!--Brown (2014) points out that other language- and culture-specific properties may facilitate word and language learning, including conversational repetition, specific verbs, and the centrality of gesture and gaze in learning the spatial system (pp. 77)-->

<!--Footnote: A lack of evidence linking lg experiences to grammatical outcomes may partly be due to practical limitations, e.g., there is no similarly convenient metric for syntactic development like the CDI (REFS??).-->

<!--Mayan work not yet mentioned:
de Leon, 1998??
Gaskins, 1990??
Gaskins, 1999??
Redfield & Villa Rojas, 1934??
Rogoff et al., 1993??
Lordes de Leon (2000): overhearing isn't just eavesdropping for Tsotsil kids because they're still socialized as participants-->

# Acknowledgements {#acknowledgements}
<!--This work would not be possible without the efforts of Rebeca, Beti, Xun, their cousin, and Antun. We are enormously grateful to the participating families for sharing their lives with us. We also thank the community and community leaders in Tenejapa for supporting our work. Thanks too, to Maartje Weenink and Daphne Jansen, who have spent many hours identifying usable clips and annotation errors. This work was supported by a NWO Veni Innovational Scheme grant (#) to MC and by an ERC Advanced Grant (INTERACT#) project to SCL. This manuscript was written using the papaja library in RStudio version *[TASK XX: Cite correctly!!]*.--> 

\newpage

# References {#refs}
<!--Brown, P. (2011). The cultural organization of attention. In Handbook of Language Socialization, A. Duranti, E. Ochs, and B.B. Schieffelin (eds.), 29-55. Blackwells.  
Brown, P. (2014). The interactional context of language learning in Tzeltal. In  I. Arnon, M. Casillas, C. Kurumada & B. Estigarribia (eds.) Language in Interaction: Studies in Honor of Eve V. Clark, 51â82. Amsterdam: John Benjamins.
Brown, P., and Gaskins, S. (2014). Language acquisition and language socialization. Handbook of Linguistic Anthropology, N. Enfield et al. (eds.),183-222. Cambridge: Cambridge University Press.-->

```{r create_r-references}
#r_refs(file = "r-references.bib")

```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
