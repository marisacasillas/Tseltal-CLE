mutate(
tchiyr.std = ((age_mo_round - tchiyr.m)/tchiyr.sd),
chisx.std = recode_factor(child_sex,
"M" = "M", "F" = "F"),
mated.std = recode_factor(mat_ed,
"none" = "none", "primary" = "primary",
"secondary" = "secondary", "preparatory" = "preparatory"),
mated.bin = recode_factor(mat_ed,
"none" = "0-5", "primary" = "0-5",
"secondary" = "6+", "preparatory" = "6+"),
motyr.std = ((mother_age - motyr.m)/motyr.sd),
nsb.std = ((number_older_sibs - nsb.m)/nsb.sd),
hsz.std = ((household_size - hsz.m)/hsz.sd),
nsk.std = ((n_spkrs_clip - nspkrs.m)/nspkrs.sd),
stthr.std = (start.hr - 12)/12)
c_o.tpm.tt.zinb <- glmmTMB(round(n.c_o.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std*I(stthr.std^2),
family="nbinom1")
summary(c_o.tpm.tt.zinb)
c_o.tpm.tt.zinb <- glmmTMB(round(n.c_o.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std,
family="nbinom1")
summary(c_o.tpm.tt.zinb)
c_o.tpm.tt.zinb <- glmmTMB(round(n.c_o.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2),
family="nbinom1")
summary(c_o.tpm.tt.zinb)
seqdur.sec.rand.zinb <- glmmTMB(round((seq.dur*60),0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|uniq.segment) +
(1+I(stthr.std^2)|aclew_child_id),
data=turn.sequences.rand,
family="poisson")
summary(seqdur.sec.rand.zinb)
cvc.ovc.per.seg.rand.beta <- glmmTMB(vc.dlta.norm_sqz ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1+I(stthr.std^2)|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=cvc.ovc.per.seg.randnonas,
family=list(family="beta",link="logit"))
summary(cvc.ovc.per.seg.rand.beta)
c_o.tpm.rand.zinb <- glmmTMB(round(n.c_o.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.rand,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std*I(stthr.std^2),
family="nbinom1")
summary(c_o.tpm.rand.zinb)
o_c.tpm.rand.zinb <- glmmTMB(round(n.o_c.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.rand,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std*I(stthr.std^2),
family="nbinom1")
summary(o_c.tpm.rand.zinb)
seqdur.sec.rand.zinb <- glmmTMB(round((seq.dur*60),0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|uniq.segment) +
(1+I(stthr.std^2)|aclew_child_id),
data=turn.sequences.rand,
family="poisson")
summary(seqdur.sec.rand.zinb)
cvc.ovc.per.seg.rand.beta <- glmmTMB(vc.dlta.norm_sqz ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1+I(stthr.std^2)|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=cvc.ovc.per.seg.randnonas,
family=list(family="beta",link="logit"))
summary(cvc.ovc.per.seg.rand.beta)
c_o.tpm.tt.zinb <- glmmTMB(round(n.c_o.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2), # no cnvgnce w/ nsk.std
family="nbinom1")
summary(c_o.tpm.tt.zinb)
o_c.tpm.tt.zinb <- glmmTMB(round(n.o_c.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std*I(stthr.std^2),
family="nbinom1")
summary(o_c.tpm.tt.zinb)
o_c.tpm.tt.zinb <- glmmTMB(round(n.o_c.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2) + nsk.std,
family="nbinom1")
summary(o_c.tpm.tt.zinb)
o_c.tpm.tt.zinb <- glmmTMB(round(n.o_c.tpm,0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=turn.transitions.tt,
ziformula=~hsz.std*I(stthr.std^2),
family="nbinom1")
summary(o_c.tpm.tt.zinb)
(cvc.ovc.per.seg.ttnonas$cvc.ovc.delta.norm *
0.49) + 0.5
range((cvc.ovc.per.seg.ttnonas$cvc.ovc.delta.norm *
0.49) + 0.5)
cvc.ovc.per.seg.ttnonas$vc.dlta.norm_sqz <- (cvc.ovc.per.seg.ttnonas$cvc.ovc.delta.norm *
0.49) + 0.5
turn.sequences.tt$uniq.segment <- paste0(turn.sequences.tt$aclew_child_id, "-",
turn.sequences.tt$segment)
seqdur.sec.tt.zinb <- glmmTMB(round((seq.dur*60),0) ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|uniq.segment) +
(1+I(stthr.std^2)|aclew_child_id),
data=turn.sequences.tt,
family="poisson")
summary(seqdur.sec.tt.zinb)
cvc.ovc.per.seg.ttnonas$vc.dlta.norm_sqz <- (cvc.ovc.per.seg.ttnonas$cvc.ovc.delta.norm *
0.49) + 0.5
cvc.ovc.per.seg.tt.beta <- glmmTMB(vc.dlta.norm_sqz ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1+I(stthr.std^2)|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=cvc.ovc.per.seg.ttnonas,
family=list(family="beta",link="logit"))
summary(cvc.ovc.per.seg.tt.beta)
range(cvc.ovc.per.seg.ttnonas$vc.dlta.norm_sqz)
ggplot() + geom_histogram(data = cvc.ovc.per.seg.ttnonas, aes(x = vc.dlta.norm_sqz))
cvc.ovc.per.seg.tt.beta <- glmmTMB(vc.dlta.norm_sqz ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1+I(stthr.std^2)|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=cvc.ovc.per.seg.ttnonas,
family=list(family="beta",link="logit"))
summary(cvc.ovc.per.seg.tt.beta)
cvc.ovc.per.seg.tt.beta <- glmmTMB(vc.dlta.norm_sqz ~
tchiyr.std + mated.bin +
hsz.std + nsk.std +
I(stthr.std^2) +
tchiyr.std:mated.bin +
tchiyr.std:nsk.std +
tchiyr.std:hsz.std +
tchiyr.std:I(stthr.std^2) +
(1|aclew_child_id), # max: no cnvgnce w/ stthr slopes
data=cvc.ovc.per.seg.ttnonas,
family=list(family="beta",link="logit"))
summary(cvc.ovc.per.seg.tt.beta)
nrow(cvc.ovc.per.seg.ttnonas)
nrow(turn.sequences.tt)
ggplot() + geom_point(data = c_o.tpm.rand.zinb, aes(x = tchiyr.std, y = round(n.c_o.tpm,0))) + geom_smooth(data = c_o.tpm.rand.zinb, aes(x = tchiyr.std, y = round(n.c_o.tpm,0)), method = "lm")
ggplot() + geom_point(data = turn.transitions.rand, aes(x = tchiyr.std, y = round(n.c_o.tpm,0))) + geom_smooth(data = turn.transitions.rand, aes(x = tchiyr.std, y = round(n.c_o.tpm,0)), method = "lm")
ggplot() + geom_raster(data = turn.transitions.rand, aes(y = tchiyr.std, x = nsk.std, fill = round(n.c_o.tpm,0)))
ggplot() + geom_smooth(data = turn.transitions.rand, aes(x = start.hr, y = round(n.c_o.tpm,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = turn.transitions.rand, aes(x = start.hr, y = round(n.c_o.tpm,0), group = age_mo_round)) + facet_grid(~ age_mo_round)
ggplot() + geom_smooth(data = turn.transitions.rand, aes(x = start.hr, y = n.c_o.tpm), method = "lm", formula = y ~ poly(x, 2))
ggplot() + geom_point(data = turn.transitions.rand, aes(x = tchiyr.std, y = round(n.o_c.tpm,0))) + geom_smooth(data = turn.transitions.rand, aes(x = tchiyr.std, y = round(n.o_c.tpm,0)), method = "lm")
ggplot() + geom_smooth(data = turn.transitions.rand, aes(x = start.hr, y = round(n.o_c.tpm,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = turn.transitions.rand, aes(x = start.hr, y = round(n.o_c.tpm,0), group = age_mo_round)) + facet_grid(~ age_mo_round)
ggplot() + geom_violin(data = turn.sequences.rand, aes(x = mated.bin, y = round((seq.dur*60),0)) + geom_jitter(data = turn.sequences.rand, aes(x = mated.bin, y = round((seq.dur*60),0))
)
)
ggplot() + geom_violin(data = turn.sequences.rand, aes(x = mated.bin, y = round((seq.dur*60),0))) + geom_jitter(data = turn.sequences.rand, aes(x = mated.bin, y = round((seq.dur*60),0)))
ggplot() + geom_violin(data = cvc.ovc.per.seg.randnonas, aes(x = mated.bin, y = vc.dlta.norm_sqz)) + geom_jitter(data = cvc.ovc.per.seg.randnonas, aes(x = mated.bin, y = vc.dlta.norm_sqz))
ggplot() + geom_point(data = turn.transitions.rand, aes(x = nsk.std, y = vc.dlta.norm_sqz))) + geom_smooth(data = turn.transitions.rand, aes(x = nsk.std, y = vc.dlta.norm_sqz)), method = "lm")
ggplot() + geom_point(data = turn.transitions.rand, aes(x = nsk.std, y = vc.dlta.norm_sqz)) + geom_smooth(data = turn.transitions.rand, aes(x = nsk.std, y = vc.dlta.norm_sqz)), method = "lm")
ggplot() + geom_point(data = cvc.ovc.per.seg.randnonas, aes(x = nsk.std, y = vc.dlta.norm_sqz)) + geom_smooth(data = cvc.ovc.per.seg.randnonas, aes(x = nsk.std, y = vc.dlta.norm_sqz)), method = "lm")
ggplot() + geom_point(data = cvc.ovc.per.seg.randnonas, aes(x = nsk.std, y = vc.dlta.norm_sqz)) + geom_smooth(data = cvc.ovc.per.seg.randnonas, aes(x = nsk.std, y = vc.dlta.norm_sqz), method = "lm")
ggplot() + geom_violin(data = turn.transitions.tt, aes(x = mated.bin, y = round(n.c_o.tpm,0))) + geom_jitter(data = turn.transitions.tt, aes(x = mated.bin, y = round(n.c_o.tpm,0)))
ggplot() + geom_point(data = turn.transitions.tt, aes(x = nsk.std, y = round(n.c_o.tpm,0))) + geom_smooth(data = turn.transitions.tt, aes(x = nsk.std, y = round(n.c_o.tpm,0)), method = "lm")
ggplot() + geom_smooth(data = turn.transitions.tt, aes(x = start.hr, y = round(n.c_o.tpm,0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = turn.transitions.tt, aes(x = start.hr, y = round(n.c_o.tpm,0), group = age_mo_round)) + facet_grid(~ age_mo_round)
ggplot() + geom_violin(data = turn.transitions.tt, aes(x = mated.bin, y = round(n.o_c.tpm,0))) + geom_jitter(data = turn.transitions.tt, aes(x = mated.bin, y = round(n.o_c.tpm,0)))
ggplot() + geom_point(data = turn.transitions.tt, aes(x = nsk.std, y = round(n.o_c.tpm,0))) + geom_smooth(data = turn.transitions.tt, aes(x = nsk.std, y = round(n.o_c.tpm,0)), method = "lm")
ggplot() + geom_point(data = turn.sequences.tt, aes(x = tchiyr.std, y = round((seq.dur*60),0))) + geom_smooth(data = turn.sequences.tt, aes(x = tchiyr.std, y = round((seq.dur*60),0)), method = "lm")
ggplot() + geom_point(data = turn.sequences.tt, aes(x = hsz.std, y = round((seq.dur*60),0))) + geom_smooth(data = turn.sequences.tt, aes(x = hsz.std, y = round((seq.dur*60),0)), method = "lm")
ggplot() + geom_raster(data = turn.sequences.tt, aes(y = tchiyr.std, x = hsz.std, fill = round((seq.dur*60),0)))
turn.sequences.tt %>% group_by(hsz.std, tchiyr.std) %>% summarise(dur = mean(seq.dur*60))
test <- turn.sequences.tt %>% group_by(hsz.std, tchiyr.std) %>% summarise(dur = mean(seq.dur*60))
cor.test(test$hsz.std, test$dur)
cor.test(test$tchiyr.std, test$dur)
ggplot() + geom_point(data = turn.sequences.tt, aes(x = tchiyr.std, y = round((seq.dur*60),0), color = mated.bin)) + geom_smooth(data = turn.sequences.tt, aes(x = tchiyr.std, y = round((seq.dur*60),0), color = mated.bin), method = "lm")
ggplot() + geom_smooth(data = turn.sequences.tt, aes(x = start.hr, y = round((seq.dur*60),0), group = age_mo_round), method = "lm", formula = y ~ poly(x, 2)) + geom_point(data = turn.sequences.tt, aes(x = start.hr, y = round((seq.dur*60),0), group = age_mo_round)) + facet_grid(~ age_mo_round)
View(turn.sequences.overview)
round(mean(turn.transitions.rand$n.c_o.tpm)*60,2)
round(mean(turn.transitions.rand$n.c_o.tpm),2)
nrow(turn.sequences.rand)
mean(turn.sequences.rand$seq.dur)
round(mean(turn.sequences.rand$seq.dur)*60,2)
cvc.ovc.per.seg.randnonas.bychild <- cvc.ovc.per.seg.randnonas %>%
group_by(aclew_child_id) %>%
summarise(mean.ratio = mean(cvc.ovc.delta.norm))
cvc.ovc.per.seg.randnonas.bychild
range(turn.sequences.rand_and_tt$seq.dur)
range(turn.sequences.rand_and_tt$seq.dur)*60
seq.dur.rand_and_tt <- ggplot(turn.sequences.rand_and_tt,
aes(x = age_mo_round, y = seq.dur*60, lty = sample)) +
geom_boxplot(aes(group = interaction(age_mo_round, sample),
color = sample), fill = "white", outlier.shape = NA,
lty = "solid", alpha = 0.4) +
geom_smooth(aes(fill = sample, color = sample), method = "lm") +
ylab("Sequence duration (min)") + xlab("")	+
scale_y_continuous(limits=c(0,60),
breaks=seq(0,60,10)) +
scale_x_continuous(limits=c(0,38),
breaks=seq(0,38,6)) +
coord_cartesian(ylim=c(0,60),xlim=c(0,38)) +
scale_color_manual(values = viridis(3)) +
scale_fill_manual(values = viridis(3)) +
theme_apa() +
theme(legend.position="none",
axis.line = element_line(color="black", size = 0.4))
seq.dur.rand_and_tt
seq.dur.rand_and_tt <- ggplot(turn.sequences.rand_and_tt,
aes(x = age_mo_round, y = seq.dur*60, lty = sample)) +
geom_boxplot(aes(group = interaction(age_mo_round, sample),
color = sample), fill = "white", outlier.shape = NA,
lty = "solid", alpha = 0.4) +
geom_smooth(aes(fill = sample, color = sample), method = "lm") +
ylab("Sequence duration (sec)") + xlab("")	+
scale_y_continuous(limits=c(0,30),
breaks=seq(0,30,5)) +
scale_x_continuous(limits=c(0,38),
breaks=seq(0,38,6)) +
coord_cartesian(ylim=c(0,60),xlim=c(0,38)) +
scale_color_manual(values = viridis(3)) +
scale_fill_manual(values = viridis(3)) +
theme_apa() +
theme(legend.position="none",
axis.line = element_line(color="black", size = 0.4))
seq.dur.rand_and_tt
seq.dur.rand_and_tt <- ggplot(turn.sequences.rand_and_tt,
aes(x = age_mo_round, y = seq.dur*60, lty = sample)) +
geom_boxplot(aes(group = interaction(age_mo_round, sample),
color = sample), fill = "white", outlier.shape = NA,
lty = "solid", alpha = 0.4) +
geom_smooth(aes(fill = sample, color = sample), method = "lm") +
ylab("Sequence duration (sec)") + xlab("")	+
scale_y_continuous(limits=c(0,60),
breaks=seq(0,60,5)) +
scale_x_continuous(limits=c(0,38),
breaks=seq(0,38,6)) +
coord_cartesian(ylim=c(0,30),xlim=c(0,38)) +
scale_color_manual(values = viridis(3)) +
scale_fill_manual(values = viridis(3)) +
theme_apa() +
theme(legend.position="none",
axis.line = element_line(color="black", size = 0.4))
seq.dur.rand_and_tt
View(turn.transitions)
unique(turn.transitions$tm1.val)
unique(turn.transitions$tp1.val)
tt.threshold <- turn.transitions %>%
filter(sample == "turn-taking")
tt.threshold <- turn.transitions %>%
filter(sample = "turn-taking")
tt.threshold <- turn.transitions %>%
filter(grepl("tt", segment))
nrow(tt.threshold)
tt.threshold <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0),
tot.tts = tm1.bin + tp1.bin)
View(tt.threshold)
ifelse(turn.transitions$tm1.val == "T", 1, 0)
tt.threshold <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0)) %>%
replace_na(list(tm1.bin = 0, tp1.bin = 0)) %>%
mutate(tot.tts = tm1.bin + tp1.bin)
View(seg.info)
tt.threshold.bychild <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0)) %>%
replace_na(list(tm1.bin = 0, tp1.bin = 0)) %>%
mutate(tot.tts = tm1.bin + tp1.bin) %>%
group_by(aclew_child_id, segment) %>%
summarise(n_all.tpm = sum(tot.tts)) %>%
mutate(seg.dur = ifelse(grepl("ext", segment), 5, 1))
View(tt.threshold.bychild)
tt.threshold.bychild <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0)) %>%
replace_na(list(tm1.bin = 0, tp1.bin = 0)) %>%
mutate(tot.tts = tm1.bin + tp1.bin) %>%
group_by(aclew_child_id, segment) %>%
summarise(n_all.tts = sum(tot.tts)) %>%
mutate(seg.dur = ifelse(grepl("ext", segment), 5, 1),
n_all.tpm = n_all.tts/seg.dur)
tt.threshold.bychild <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0)) %>%
replace_na(list(tm1.bin = 0, tp1.bin = 0)) %>%
mutate(tot.tts = tm1.bin + tp1.bin) %>%
group_by(aclew_child_id, segment) %>%
summarise(n_all.tts = sum(tot.tts)) %>%
mutate(seg.dur = ifelse(grepl("ext", segment), 5, 1),
n_all.tpm = n_all.tts/seg.dur) %>%
group_by(aclew_child_id) %>%
summarise(
min.all.tpm = min(n_all.tpm),
max.all.tpm = max(n_all.tpm),
mean.all.tpm = mean(n_all.tpm))
tt.threshold.bychild <- turn.transitions %>%
filter(grepl("tt", segment)) %>%
mutate(tm1.bin = ifelse(tm1.val == "T", 1, 0),
tp1.bin = ifelse(tp1.val == "T", 1, 0)) %>%
replace_na(list(tm1.bin = 0, tp1.bin = 0)) %>%
mutate(tot.tts = tm1.bin + tp1.bin) %>%
group_by(aclew_child_id, segment) %>%
summarise(n_all.tts = sum(tot.tts)) %>%
mutate(seg.dur = ifelse(grepl("ext", segment), 5, 1),
n_all.tpm = n_all.tts/seg.dur) %>%
group_by(aclew_child_id) %>%
summarise(
min.all.tpm = min(n_all.tpm),
max.all.tpm = max(n_all.tpm),
mean.all.tpm = mean(n_all.tpm),
median.all.tpm = median(n_all.tpm))
lowest.bychild.tt.tpm <- min(tt.threshold.bychild$min.all.tpm)
lowest.bychild.tt.tpm
lowest.bychild.tt.tpm <- min(tt.threshold.bychild$mean.all.tpm)
lowest.bychild.tt.tpm
tm1s <- dplyr::select(turn.transitions, c("aclew_child_id", "segment", "tm1.stop")) %>%
rename(transition.start = tm1.stop)
View(tm1s)
tm1s <- turn.transitions %>%
filter(!is.na(tm1.val)) %>%
dplyr::select(c("aclew_child_id", "segment", "tm1.stop")) %>%
rename(transition.start = tm1.stop)
tm1s.rand <- turn.transitions %>%
filter(!is.na(tm1.val) & grepl("random", segment)) %>%
dplyr::select(c("aclew_child_id", "segment", "tm1.stop")) %>%
rename(transition.start = tm1.stop)
tp1s.rand <- turn.transitions %>%
filter(!is.na(tp1.val) & grepl("random", segment)) %>%
dplyr::select(c("aclew_child_id", "segment", "tp1.start")) %>%
rename(transition.start = tp1.start)
View(tm1s.rand)
tm1s.rand <- turn.transitions %>%
filter(!is.na(tm1.val) & grepl("random", segment)) %>%
dplyr::select(c("aclew_child_id", "segment", "tm1.stop")) %>%
rename(transition.start = tm1.stop) %>%
mutate(transition.type = "tm1")
tp1s.rand <- turn.transitions %>%
filter(!is.na(tp1.val) & grepl("random", segment)) %>%
dplyr::select(c("aclew_child_id", "segment", "tp1.start")) %>%
rename(transition.start = tp1.start) %>%
mutate(transition.type = "tp1")
tts.rand <- bind_rows(tm1s.rand, tp1s.rand)
View(seg.info)
View(v)
View(tts.rand)
tts.rand <- bind_rows(tm1s.rand, tp1s.rand) %>%
arrange(aclew_child_id, segment, transition.start)
seg.info$start.ms <- seg.info$start.sec*1000
seg.info.start.stop <- seg.info %>%
filter(Include == 1) %>%
mutate(start.ms = start.sec*1000,
seg.dur = ifelse(grepl("random", CodeName), 5, ifelse(grepl("ext", CodeName), 6, 1)),
stop.ms = start.ms + (seg.dur*1000)) %>%
dplyr::select(aclew_child_id, segment, start.ms, stop.ms)
seg.info.start.stop <- seg.info %>%
filter(Include == 1) %>%
mutate(start.ms = start.sec*1000,
seg.dur = ifelse(grepl("random", CodeName), 5, ifelse(grepl("ext", CodeName), 6, 1)),
stop.ms = start.ms + (seg.dur*1000)) %>%
dplyr::select(aclew_id, segment, start.ms, stop.ms)
seg.info.start.stop <- seg.info %>%
filter(Include == 1) %>%
mutate(start.ms = start.sec*1000,
seg.dur = ifelse(grepl("random", CodeName), 5, ifelse(grepl("ext", CodeName), 6, 1)),
stop.ms = start.ms + (seg.dur*1000)) %>%
dplyr::select(aclew_id, CodeName, start.ms, stop.ms)
View(seg.info.start.stop)
row <- 1
child <- seg.info.start.stop$aclew_id[row]
segment <- seg.info.start.stop$CodeName[row]
child
segment
tt.subsample <- filter(tts.rand, aclew_child_id == child &
transition.start >= seg.info.start.stop$start.ms[row] &
transition.start >= seg.info.start.stop$stop.ms[row])
View(tt.subsample)
seg.info.start.stop$start.ms[row]
seg.info.start.stop$stop.ms[row]
seg.info.start.stop$start.ms[row]/1000
3963252/60000
624055000/60000
seg.info.start.stop <- seg.info %>%
filter(Include == 1) %>%
mutate(start.ms = clipoffset.sec*1000,
seg.dur = ifelse(grepl("random", CodeName), 5, ifelse(grepl("ext", CodeName), 6, 1)),
stop.ms = start.ms + (seg.dur*1000)) %>%
dplyr::select(aclew_id, CodeName, start.ms, stop.ms)
child <- seg.info.start.stop$aclew_id[row]
segment <- seg.info.start.stop$CodeName[row]
tt.subsample <- filter(tts.rand, aclew_child_id == child &
transition.start >= seg.info.start.stop$start.ms[row] &
transition.start >= seg.info.start.stop$stop.ms[row])
child
segment
seg.info.start.stop$start.ms[row]
seg.info.start.stop$start.ms[row]/1000
3963252
3963252/60000
3963252/1000
3963252/600
3963252/60
63002*1000
63002/60
1.050*60*1000
3963252/1000
3963252/6000
3963252/60
