summarise(n_tds_utts = sum(n_utts)) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(tds_uph = (n_tds_utts/tot_dur)*60)
n.utts.per.sample.tds
n.utts.per.sample.cds <- n.utts.per.sample.all %>%
filter(val == "T" | val == "C") %>%
group_by(aclew_child_id, sample) %>%
summarise(n_cds_utts = sum(n_utts)) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(cds_uph = (n_cds_utts/tot_dur)*60)
nrow(n.utts.per.sample.xds)
nrow(n.utts.per.sample.tds)
nrow(n.utts.per.sample.cds)
n.utts.per.sample.all <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample", "tot_dur")) %>%
full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample", "tot_dur"))
deltas.random.v.va.utts <- n.utts.per.sample.all %>%
filter(sample != "turn-taking") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
deltas.random.v.va.utts
View(deltas.random.v.va.utts)
i <- 2
deltas.random.v.va.utts$xds_uph[i-1] - deltas.random.v.va.utts$xds_uph[i]
for (i in 2:nrow(deltas.random.v.va.utts)) {
deltas.random.v.va.utts$d_xds_uph[i] <-
deltas.random.v.va.utts$xds_uph[i-1] - deltas.random.v.va.utts$xds_uph[i]
deltas.random.v.va.utts$d_tds_uph[i] <-
deltas.random.v.va.utts$tds_uph[i-1] - deltas.random.v.va.utts$tds_uph[i]
deltas.random.v.va.utts$d_cds_uph[i] <-
deltas.random.v.va.utts$cds_uph[i-1] - deltas.random.v.va.utts$cds_uph[i]
}
deltas.random.v.va.utts <- deltas.random.v.va.utts %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph)
deltas.random.v.tt.utts <- n.utts.per.sample.all %>%
filter(sample != "high-activity") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
View(deltas.random.v.tt.utts)
for (i in 2:nrow(deltas.random.v.tt.utts)) {
deltas.random.v.tt.utts$d_xds_uph[i] <-
deltas.random.v.tt.utts$xds_uph[i] - deltas.random.v.tt.utts$xds_uph[i-1]
deltas.random.v.tt.utts$d_tds_uph[i] <-
deltas.random.v.tt.utts$tds_uph[i] - deltas.random.v.tt.utts$tds_uph[i-1]
deltas.random.v.tt.utts$d_cds_uph[i] <-
deltas.random.v.tt.utts$cds_uph[i] - deltas.random.v.tt.utts$cds_uph[i-1]
}
deltas.random.v.tt.utts <- deltas.random.v.tt.utts %>%
filter(sample != "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
group_by(aclew_id, sample) %>%
summarise(tot_dur = sum(duration)) %>%
rename(aclew_child_id = aclew_id)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, val) %>%
summarise(n_utts = n())
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, sample) %>%
summarise(n_xds_utts = sum(n_utts)) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(xds_uph = (n_xds_utts/tot_dur)*60)
n.utts.per.sample.tds <- n.utts.per.sample.all %>%
filter(val == "T") %>%
group_by(aclew_child_id, sample) %>%
summarise(n_tds_utts = sum(n_utts)) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(tds_uph = (n_tds_utts/tot_dur)*60)
n.utts.per.sample.cds <- n.utts.per.sample.all %>%
filter(val == "T" | val == "C") %>%
group_by(aclew_child_id, sample) %>%
summarise(n_cds_utts = sum(n_utts)) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(cds_uph = (n_cds_utts/tot_dur)*60)
n.utts.per.sample.all <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample", "tot_dur")) %>%
full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample", "tot_dur"))
deltas.random.v.va.utts <- n.utts.per.sample.all %>%
filter(sample != "turn-taking") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.va.utts)) {
deltas.random.v.va.utts$d_xds_uph[i] <-
deltas.random.v.va.utts$xds_uph[i-1] - deltas.random.v.va.utts$xds_uph[i]
deltas.random.v.va.utts$d_tds_uph[i] <-
deltas.random.v.va.utts$tds_uph[i-1] - deltas.random.v.va.utts$tds_uph[i]
deltas.random.v.va.utts$d_cds_uph[i] <-
deltas.random.v.va.utts$cds_uph[i-1] - deltas.random.v.va.utts$cds_uph[i]
}
deltas.random.v.va.utts <- deltas.random.v.va.utts %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
mutate(delta = "va-random")
deltas.random.v.tt.utts <- n.utts.per.sample.all %>%
filter(sample != "high-activity") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.tt.utts)) {
deltas.random.v.tt.utts$d_xds_uph[i] <-
deltas.random.v.tt.utts$xds_uph[i] - deltas.random.v.tt.utts$xds_uph[i-1]
deltas.random.v.tt.utts$d_tds_uph[i] <-
deltas.random.v.tt.utts$tds_uph[i] - deltas.random.v.tt.utts$tds_uph[i-1]
deltas.random.v.tt.utts$d_cds_uph[i] <-
deltas.random.v.tt.utts$cds_uph[i] - deltas.random.v.tt.utts$cds_uph[i-1]
}
deltas.random.v.tt.utts <- deltas.random.v.tt.utts %>%
filter(sample != "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
mutate(delta = "tt-random")
deltas.random.v.oth.utts <- bind_rows(deltas.random.v.tt.utts, deltas.random.v.va.utts) %>%
full_join(ptcp.info, by = "aclew_child_id")
View(deltas.random.v.oth.utts)
quantity.mph.per.sample <- quantity.rand %>%
mutate(sample = "random",
sample_type = "random") %>%
bind_rows(quantity.nonrand) %>%
group_by(aclew_child_id, sample) %>%
summarise(m_xds_mph = mean(xds_mph),
m_tds_mph = mean(tds_mph),
m_cds_mph = mean(cds_mph))
deltas.random.v.tt <- quantity.mph.per.sample %>%
filter(sample != "high-activity") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
View(deltas.random.v.tt)
deltas.random.v.tt <- quantity.mph.per.sample %>%
filter(sample != "high-activity") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.tt)) {
deltas.random.v.tt$d_xds_mph[i] <-
deltas.random.v.tt$m_xds_mph[i] - deltas.random.v.tt$m_xds_mph[i-1]
deltas.random.v.tt$d_tds_mph[i] <-
deltas.random.v.tt$m_tds_mph[i] - deltas.random.v.tt$m_tds_mph[i-1]
deltas.random.v.tt$d_cds_mph[i] <-
deltas.random.v.tt$m_cds_mph[i] - deltas.random.v.tt$m_cds_mph[i-1]
}
deltas.random.v.tt <- deltas.random.v.tt %>%
filter(sample != "random") %>%
select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
mutate(delta = "tt-random")
deltas.random.v.va <- quantity.mph.per.sample %>%
filter(sample != "turn-taking") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
View(deltas.random.v.va)
for (i in 2:nrow(deltas.random.v.va)) {
deltas.random.v.va$d_xds_mph[i] <-
deltas.random.v.va$m_xds_mph[i] - deltas.random.v.va$m_xds_mph[i-1]
deltas.random.v.va$d_tds_mph[i] <-
deltas.random.v.va$m_tds_mph[i] - deltas.random.v.va$m_tds_mph[i-1]
deltas.random.v.va$d_cds_mph[i] <-
deltas.random.v.va$m_cds_mph[i] - deltas.random.v.va$m_cds_mph[i-1]
}
for (i in 2:nrow(deltas.random.v.va)) {
deltas.random.v.va$d_xds_mph[i] <-
deltas.random.v.va$m_xds_mph[i-1] - deltas.random.v.va$m_xds_mph[i]
deltas.random.v.va$d_tds_mph[i] <-
deltas.random.v.va$m_tds_mph[i-1] - deltas.random.v.va$m_tds_mph[i]
deltas.random.v.va$d_cds_mph[i] <-
deltas.random.v.va$m_cds_mph[i-1] - deltas.random.v.va$m_cds_mph[i]
}
deltas.random.v.va <- deltas.random.v.va %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
mutate(delta = "ha-random")
deltas.random.v.oth <- bind_rows(deltas.random.v.tt, deltas.random.v.va) %>%
full_join(ptcp.info, by = "aclew_child_id")
deltas.random.v.va <- quantity.mph.per.sample %>%
filter(sample != "turn-taking") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.va)) {
deltas.random.v.va$d_xds_mph[i] <-
deltas.random.v.va$m_xds_mph[i-1] - deltas.random.v.va$m_xds_mph[i]
deltas.random.v.va$d_tds_mph[i] <-
deltas.random.v.va$m_tds_mph[i-1] - deltas.random.v.va$m_tds_mph[i]
deltas.random.v.va$d_cds_mph[i] <-
deltas.random.v.va$m_cds_mph[i-1] - deltas.random.v.va$m_cds_mph[i]
}
deltas.random.v.va <- deltas.random.v.va %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
mutate(delta = "ha-random")
deltas.random.v.oth <- bind_rows(deltas.random.v.tt, deltas.random.v.va) %>%
full_join(ptcp.info, by = "aclew_child_id")
View(deltas.random.v.oth)
quantity.mph.per.sample <- quantity.rand %>%
mutate(sample = "random",
sample_type = "random") %>%
bind_rows(quantity.nonrand) %>%
group_by(aclew_child_id, sample) %>%
summarise(m_xds_mph = mean(xds_mph),
m_tds_mph = mean(tds_mph),
m_cds_mph = mean(cds_mph))
deltas.random.v.tt <- quantity.mph.per.sample %>%
filter(sample != "high-activity") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.tt)) {
deltas.random.v.tt$d_xds_mph[i] <-
deltas.random.v.tt$m_xds_mph[i] - deltas.random.v.tt$m_xds_mph[i-1] # set up for tt - random
deltas.random.v.tt$d_tds_mph[i] <-
deltas.random.v.tt$m_tds_mph[i] - deltas.random.v.tt$m_tds_mph[i-1]
deltas.random.v.tt$d_cds_mph[i] <-
deltas.random.v.tt$m_cds_mph[i] - deltas.random.v.tt$m_cds_mph[i-1]
}
deltas.random.v.tt <- deltas.random.v.tt %>%
filter(sample != "random") %>% # only keep meaningful vals
select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
mutate(delta = "tt-random")
deltas.random.v.va <- quantity.mph.per.sample %>%
filter(sample != "turn-taking") %>%
arrange(aclew_child_id, sample) %>%
mutate(d_xds_mph = 0,
d_tds_mph = 0,
d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.va)) {
deltas.random.v.va$d_xds_mph[i] <-
deltas.random.v.va$m_xds_mph[i-1] - deltas.random.v.va$m_xds_mph[i]
deltas.random.v.va$d_tds_mph[i] <-
deltas.random.v.va$m_tds_mph[i-1] - deltas.random.v.va$m_tds_mph[i]
deltas.random.v.va$d_cds_mph[i] <-
deltas.random.v.va$m_cds_mph[i-1] - deltas.random.v.va$m_cds_mph[i]
}
deltas.random.v.va <- deltas.random.v.va %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
mutate(delta = "ha-random")
deltas.random.v.oth <- bind_rows(deltas.random.v.tt, deltas.random.v.va) %>%
full_join(ptcp.info, by = "aclew_child_id")
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
group_by(aclew_id, sample) %>%
summarise(tot_dur = sum(duration)) %>%
rename(aclew_child_id = aclew_id)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, val) %>%
summarise(n_utts = n())
View(n.utts.per.sample.all)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier))
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, segment, val) %>%
summarise(n_utts = n())
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample"))
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "sample")) %>%
mutate(uph = (n_utts/tot_dur)*60)
tot.dur.samples.per.rec
View(tot.dur.samples.per.rec)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking")))
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
filter(Include == 1)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
filter(Include == 1) %>%
select(aclew_id, CodeName, duration)
# deltas utt/h XDS, TDS, and CDS
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
filter(Include == 1)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
select(aclew_id, CodeName, duration)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
select(aclew_id, CodeName, duration) %>%
rename(aclew_child_id = aclew_id, segment = CodeName)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, segment, val) %>%
summarise(n_utts = n())
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, sample, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment"))
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking")))
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
select(aclew_id, CodeName, duration, sample) %>%
rename(aclew_child_id = aclew_id, segment = CodeName)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment"))
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
replace_na(list(val = "T", n_utts = 0))
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
replace_na(list(val = "T", n_utts = 0)) %>%
mutate(uph = (n_utts/tot_dur)*60)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
replace_na(list(val = "T", n_utts = 0)) %>%
mutate(uph = (n_utts/duration)*60)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample)
mutate(uph = (n_utts/duration)*60)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
replace_na(list(val = "T", n_utts = 0))
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample) %>%
mutate(uph = (n_utts/duration)*60)
View(n.utts.per.sample.xds)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample) %>%
summarise(uph = (n_utts/duration)*60)
n.utts.per.sample.xds <- n.utts.per.sample.all
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment) %>%
summarise(uph = (n_utts/duration)*60)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample) %>%
summarise(uph = n_utts)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts))
n.utts.per.sample.xds <- n.utts.per.sample.all
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts))
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(xds_uph = (n_xds_utts/tot_dur)*60)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(xds_uph = (n_utts_seg/duration)*60)
View(quantity.rand)
tot.dur.samples.per.rec <- seg.info %>%
mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
sample = ifelse(grepl('random', CodeName), "random",
ifelse(grepl('va', CodeName), "high-activity",
"turn-taking"))) %>%
select(aclew_id, CodeName, duration, sample) %>%
rename(aclew_child_id = aclew_id, segment = CodeName)
View(tot.dur.samples.per.rec)
n.utts.per.sample.all <- all.data %>%
filter(speaker != "CHI" & grepl("xds@", tier)) %>%
group_by(aclew_child_id, segment, val) %>%
summarise(n_utts = n()) %>%
full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
replace_na(list(val = "T", n_utts = 0))
View(n.utts.per.sample.all)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(xds_uph = (n_utts_seg/duration)*60)
View(n.utts.per.sample.xds)
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(xds_uph = (n_utts_seg/duration)*60) %>%
group_by(aclew_child_id, sample) %>%
summarise(m_xds_uph = mean(xds_uph))
n.utts.per.sample.tds <- n.utts.per.sample.all %>%
filter(val == "T") %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(tds_uph = (n_utts_seg/duration)*60) %>%
group_by(aclew_child_id, sample) %>%
summarise(m_tds_uph = mean(tds_uph))
View(n.utts.per.sample.tds)
View(n.utts.per.sample.xds)
n.utts.per.sample.cds <- n.utts.per.sample.all %>%
filter(val == "T" | val == "C") %>%
group_by(aclew_child_id, segment, sample, duration) %>%
summarise(n_utts_seg = sum(n_utts)) %>%
mutate(cds_uph = (n_utts_seg/duration)*60) %>%
group_by(aclew_child_id, sample) %>%
summarise(m_cds_uph = mean(cds_uph))
View(n.utts.per.sample.cds)
n.utts.per.sample <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds) %>%
full_join(n.utts.per.sample.cds)
n.utts.per.sample <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample")) %>%
full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample"))
uph.per.sample <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample")) %>%
full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample"))
View(uph.per.sample)
uph.per.sample <- n.utts.per.sample.xds %>%
full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample")) %>%
full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample"))
deltas.random.v.va.uph <- uph.per.sample %>%
filter(sample != "turn-taking") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
deltas.random.v.va.uph
View(deltas.random.v.va.uph)
for (i in 2:nrow(deltas.random.v.va.uph)) {
deltas.random.v.va.uph$d_xds_uph[i] <-
deltas.random.v.va.uph$m_xds_uph[i-1] - deltas.random.v.va.uph$m_xds_uph[i]
deltas.random.v.va.uph$d_tds_uph[i] <-
deltas.random.v.va.uph$m_tds_uph[i-1] - deltas.random.v.va.uph$m_tds_uph[i]
deltas.random.v.va.uph$d_cds_uph[i] <-
deltas.random.v.va.uph$m_cds_uph[i-1] - deltas.random.v.va.uph$m_cds_uph[i]
}
deltas.random.v.va.uph <- deltas.random.v.va.uph %>%
filter(sample == "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
mutate(delta = "va-random")
deltas.random.v.tt.uph <- uph.per.sample %>%
filter(sample != "high-activity") %>%
mutate(d_xds_uph = 0,
d_tds_uph = 0,
d_cds_uph = 0) %>%
arrange(aclew_child_id, sample)
View(deltas.random.v.tt.uph)
for (i in 2:nrow(deltas.random.v.tt.uph)) {
deltas.random.v.tt.uph$d_xds_uph[i] <-
deltas.random.v.tt.uph$m_xds_uph[i] - deltas.random.v.tt.uph$m_xds_uph[i-1]
deltas.random.v.tt.uph$d_tds_uph[i] <-
deltas.random.v.tt.uph$m_tds_uph[i] - deltas.random.v.tt.uph$m_tds_uph[i-1]
deltas.random.v.tt.uph$d_cds_uph[i] <-
deltas.random.v.tt.uph$m_cds_uph[i] - deltas.random.v.tt.uph$m_cds_uph[i-1]
}
deltas.random.v.tt.uph <- deltas.random.v.tt.uph %>%
filter(sample != "random") %>%
select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
mutate(delta = "tt-random")
deltas.random.v.oth.utts <- bind_rows(deltas.random.v.tt.uph, deltas.random.v.va.uph) %>%
full_join(ptcp.info, by = "aclew_child_id")
View(deltas.random.v.oth.utts)
packageVersion("ggplot2")
View(all.data)
