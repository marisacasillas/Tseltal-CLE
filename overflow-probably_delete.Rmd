<!--For example, the LENA^Â®^ system gives its users up to 16 hours of continuous audio recording at a time, along with software to help determine where in the recording researchers will find speech. By annotating sub-samples of these recordings (REFS: Weisleder) or by looking at other cues to interactional behavior (REFS: Romeo), researchers can then get insight into how often children are engaged in child-directed interactions at home. These estimates can then be compared with their language outcomes to check for correlations between what children hear and how they develop linguistically.-->

<!--In daily life, children often hear CDS during joint activities; events in which caregivers' and children's behavior is coordinated to accomplish some interactional goal (e.g., during mealtimes, grooming, and play).-->



# Graph the basic speech quantity info
# XDS min/hr
xdsmph.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = xds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("XDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,85),
                     breaks=seq(0,85,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,85),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = xds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# ODS min/hr
odsmph.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = ods_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("ODS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = ods_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS min/hr
tdsmph.segments.rand <- ggplot(quantity.rand,
      aes(x = age_mo_round, y = tds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("")	+
  scale_y_continuous(limits=c(0,80),
                     breaks=seq(0,80,20)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,80),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = tds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

tdsmph.segments.rand.zoomedin <- ggplot(quantity.rand,
                                   aes(x = age_mo_round, y = tds_mph)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS (min/hr)") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,20),
                     breaks=seq(0,20,5)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,20),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = tds_mph, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# TDS prop
tdsprp.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = prop_tds)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("TCDS/All spch") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1),xlim=c(0,38)) +
  geom_point(data = comparison.data,
             aes(x = AgeMonths, y = prp_tds, group = Site, shape = Site), alpha = 0.4) +
  scale_shape_manual(values=comparison.data.shapes) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# prop TDS from adults vs. children
tdsprp.segments.sa.rand <- ggplot(quantity.rand.sa,
                             aes(x = age_mo_round, y = prop_sa.tds,
                                 group = SpkrAge, fill = SpkrAge, color = SpkrAge)) +
  geom_boxplot(aes(group = interaction(age_mo_round, SpkrAge),
                   fill = SpkrAge, color = SpkrAge),
               position = position_dodge(1), outlier.shape = NA, alpha = 0.3) +
  geom_smooth(method = "lm") +
  ylab("Prop of TCDS") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(-.2,1.2),
                     breaks=seq(0,1,0.2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,1), xlim=c(0,38)) +
  geom_point(data = comparison.data.sa,
             aes(x = AgeMonths, y = prp_spkr, group = SpkrAge,
                 fill = SpkrAge, shape = Site), alpha = 0.5) +
  scale_shape_manual(values=comparison.data.shapes) +
  col.sample.bu3 +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# number of speakers per clip
nspkrs.segments.rand <- ggplot(quantity.rand,
                          aes(x = age_mo_round, y = n_spkrs_clip)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("# Speakers") + xlab("Child age (mo)")	+
  scale_y_continuous(limits=c(0,10),
                     breaks=seq(0,10,2)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,10),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))
        
```{r fig1, echo=FALSE, fig.cap="By-child estimates for minutes per hour of all overheard speech (upper left), target-child-directed speech (upper right), proportion target-child-directed speech (lower left), and proportion of TCDS coming from adults vs. children (lower right; adults = purple). Black dots and boxplots indicate variance in each measure across the nine 5-minute random Tseltal clips. Bands on the linear trends show 95% CIs.", message=FALSE, warning=FALSE, fig.height=4}
grid.arrange(odsmph.segments.rand, tdsmph.segments.rand.zoomedin,
             tdsprp.segments.rand, tdsprp.segments.sa.rand, nrow=2, ncol=2)
```


```{r make_tt_interaction_plots, message=FALSE, warning=FALSE, paged.print=FALSE}
# Graph the basic turn taking rate info
# CHI-OTH transitions per minute
chi.oth.tts.tt <- ggplot(turn.transitions.tt,
                          aes(x = age_mo_round, y = n.c_o.tpm)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("CHI-OTH tts/min") + xlab("")	+
  scale_y_continuous(limits=c(0,30),
                     breaks=seq(0,30,10)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,30),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# OTH-CHI transitions per minute
oth.chi.tts.tt <- ggplot(turn.transitions.tt,
                          aes(x = age_mo_round, y = n.o_c.tpm)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("OTH-CHI tts/min") + xlab("")	+
  scale_y_continuous(limits=c(0,30),
                     breaks=seq(0,30,10)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,30),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# Graph the basic sequence duration info
seq.dur.tt <- ggplot(turn.sequences.tt,
                          aes(x = age_mo_round, y = seq.dur)) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("Sequence duration (min)") + xlab("")	+
  scale_y_continuous(limits=c(0,1),
                     breaks=seq(0,1,0.1)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(0,0.5),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))

# Graph the basic CHI-OTH voc time delta info
cvc.ovc.delta.tt <- ggplot(cvc.ovc.per.seg.tt,
                          aes(x = age_mo_round, y = cvc.ovc.delta.norm)) +
  geom_hline(yintercept = 0, lwd = 0.5) +
  geom_boxplot(aes(group = age_mo_round), outlier.shape = NA) +
  geom_smooth(method = "lm", color = "black") +
  ylab("Normalized voc. diff.") + xlab("")	+
  scale_y_continuous(limits=c(-1,1),
                     breaks=seq(-1,1,0.5)) +
  scale_x_continuous(limits=c(0,38),
                     breaks=seq(0,38,6)) +
  coord_cartesian(ylim=c(-1,1),xlim=c(0,38)) +
  theme_apa() +
  theme(legend.position="none",
        axis.line = element_line(color="black", size = 0.4))
```

```{r fig4, echo=FALSE, fig.cap="By-child estimates for child-to-other (upper left) and other-to-child (upper right) turn transitions per minute, turn-taking sequenec duration (lower left), and normalized difference in vocalization time (1 = child vocalizes more than their interlocutor; 0 = vice versa). Boxplots indicate variance in each measure across the 5--6 high turn-taking Tseltal clips. Bands on the solid linear trends show 95% CIs", message=FALSE, warning=FALSE, fig.height=4}
grid.arrange(chi.oth.tts.tt, oth.chi.tts.tt,
             seq.dur.tt, cvc.ovc.delta.tt, nrow=2, ncol=2)
```



# seg.info$start.hhmmss <- paste0(substr(seg.info$start.hhmmss,1,2), ":",
#                                 substr(seg.info$start.hhmmss,3,4), ":",
#                                 substr(seg.info$start.hhmmss,5,6))
# Adjust naming errors in segment clips (clip name TODs are too late!):
# 0643 by 21m37s
# 2109 by 10m11s
# 2625 by 30m28s
# 3026 by 26m54s
# 6216 by 20m30s
# 7176 by 10m55s
# 7220 by 13m02s
# 7326 by 55m25s
# 8179 by 18m12s
# 8787 by 22m28s

newoffsets <- tibble(
  aclew_id = c("0643", "2109", "2625", "3026", "6216",
               "7176", "7220", "7326", "8179", "8787"),
  newoffset = c("1H 21M 37S", "10M 11S", "30M 28S", "26M 54S", "20M 30S",
                "10M 55S", "13M 2S", "55M 25S", "18M 12S", "22M 28S")
  ) %>%
  left_join(seg.info, by = "aclew_id") %>% 
  mutate(
    offset_d = lubridate::duration(newoffset),
    start = as.character(strptime(start.hhmmss, format = "%H%M%S", tz = "UTC") - offset_d),
    newoffset = sprintf("%02d%02d%02d",
               lubridate::hour(start), lubridate::minute(start), lubridate::second(start))
  ) %>% 
  dplyr::select(c("aclew_id", "Media", newoffset))

new.seg.info <- left_join(seg.info, newoffsets, by = c("aclew_id", "Media")) %>% 
  mutate(Media.new = str_replace(Media, "[[:digit:]]{6}", newoffset))

write_csv(new.seg.info, "seginfo.csv")

seg.info <- left_join(seg.info, tod.adjustment, by = "aclew_id")




``` {r sample_differences}
# deltas m/h XDS, TDS, and CDS mph
quantity.mph.per.sample <- quantity.rand %>%
  mutate(sample = "random",
         sample_type = "random") %>%
  bind_rows(quantity.nonrand) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_xds_mph = mean(xds_mph),
         m_tds_mph = mean(tds_mph),
         m_cds_mph = mean(cds_mph))
deltas.random.v.tt <- quantity.mph.per.sample %>%
  filter(sample != "high-activity") %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_xds_mph = 0,
         d_tds_mph = 0,
         d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.tt)) {
  deltas.random.v.tt$d_xds_mph[i] <-
    deltas.random.v.tt$m_xds_mph[i] -
    deltas.random.v.tt$m_xds_mph[i-1] # set up for tt - random
  deltas.random.v.tt$d_tds_mph[i] <-
    deltas.random.v.tt$m_tds_mph[i] - deltas.random.v.tt$m_tds_mph[i-1]
  deltas.random.v.tt$d_cds_mph[i] <-
    deltas.random.v.tt$m_cds_mph[i] - deltas.random.v.tt$m_cds_mph[i-1]
}
deltas.random.v.tt <- deltas.random.v.tt %>%
  filter(sample != "random") %>% # only keep meaningful vals
  select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
  mutate(delta = "tt-random")
deltas.random.v.va <- quantity.mph.per.sample %>%
  filter(sample != "turn-taking") %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_xds_mph = 0,
         d_tds_mph = 0,
         d_cds_mph = 0)
for (i in 2:nrow(deltas.random.v.va)) {
  deltas.random.v.va$d_xds_mph[i] <-
    deltas.random.v.va$m_xds_mph[i-1] -
    deltas.random.v.va$m_xds_mph[i] # set up for va - random
  deltas.random.v.va$d_tds_mph[i] <-
    deltas.random.v.va$m_tds_mph[i-1] - deltas.random.v.va$m_tds_mph[i]
  deltas.random.v.va$d_cds_mph[i] <-
    deltas.random.v.va$m_cds_mph[i-1] - deltas.random.v.va$m_cds_mph[i]
}
deltas.random.v.va <- deltas.random.v.va %>%
  filter(sample == "random") %>% # only keep meaningful vals
  select(aclew_child_id, d_xds_mph, d_tds_mph, d_cds_mph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth <- bind_rows(deltas.random.v.tt, deltas.random.v.va) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# deltas utt/h XDS, TDS, and CDS
tot.dur.samples.per.rec <- seg.info %>%
  mutate(duration = ifelse(grepl('1min', Sample), 1, 5),
         sample = ifelse(grepl('random', CodeName), "random",
                         ifelse(grepl('va', CodeName), "high-activity",
                                "turn-taking"))) %>%
  select(aclew_id, CodeName, duration, sample) %>%
  rename(aclew_child_id = aclew_id, segment = CodeName)
n.utts.per.sample.all <- all.data %>%
  filter(speaker != "CHI" & grepl("xds@", tier)) %>%
  group_by(aclew_child_id, segment, val) %>%
  summarise(n_utts = n()) %>%
  full_join(tot.dur.samples.per.rec, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(val = "T", n_utts = 0))
n.utts.per.sample.xds <- n.utts.per.sample.all %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(xds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_xds_uph = mean(xds_uph))
n.utts.per.sample.tds <- n.utts.per.sample.all %>%
  filter(val == "T") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(tds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_tds_uph = mean(tds_uph))
n.utts.per.sample.cds <- n.utts.per.sample.all %>%
  filter(val == "T" | val == "C") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_utts_seg = sum(n_utts)) %>%
  mutate(cds_uph = (n_utts_seg/duration)*60) %>%
  group_by(aclew_child_id, sample) %>%
  summarise(m_cds_uph = mean(cds_uph))
uph.per.sample <- n.utts.per.sample.xds %>%
  full_join(n.utts.per.sample.tds, by = c("aclew_child_id", "sample")) %>%
  full_join(n.utts.per.sample.cds, by = c("aclew_child_id", "sample"))
deltas.random.v.tt.uph <- uph.per.sample %>%
  filter(sample != "high-activity") %>%
  mutate(d_xds_uph = 0,
         d_tds_uph = 0,
         d_cds_uph = 0) %>%
  arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.tt.uph)) {
  deltas.random.v.tt.uph$d_xds_uph[i] <-
    deltas.random.v.tt.uph$m_xds_uph[i] - deltas.random.v.tt.uph$m_xds_uph[i-1]
  deltas.random.v.tt.uph$d_tds_uph[i] <-
    deltas.random.v.tt.uph$m_tds_uph[i] - deltas.random.v.tt.uph$m_tds_uph[i-1]
  deltas.random.v.tt.uph$d_cds_uph[i] <-
    deltas.random.v.tt.uph$m_cds_uph[i] - deltas.random.v.tt.uph$m_cds_uph[i-1]
}
deltas.random.v.tt.uph <- deltas.random.v.tt.uph %>%
  filter(sample != "random") %>%
  select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
  mutate(delta = "tt-random")
deltas.random.v.va.uph <- uph.per.sample %>%
  filter(sample != "turn-taking") %>%
  mutate(d_xds_uph = 0,
         d_tds_uph = 0,
         d_cds_uph = 0) %>%
  arrange(aclew_child_id, sample)
for (i in 2:nrow(deltas.random.v.va.uph)) {
  deltas.random.v.va.uph$d_xds_uph[i] <-
    deltas.random.v.va.uph$m_xds_uph[i-1] - deltas.random.v.va.uph$m_xds_uph[i]
  deltas.random.v.va.uph$d_tds_uph[i] <-
    deltas.random.v.va.uph$m_tds_uph[i-1] - deltas.random.v.va.uph$m_tds_uph[i]
  deltas.random.v.va.uph$d_cds_uph[i] <-
    deltas.random.v.va.uph$m_cds_uph[i-1] - deltas.random.v.va.uph$m_cds_uph[i]
}
deltas.random.v.va.uph <- deltas.random.v.va.uph %>%
  filter(sample == "random") %>%
  select(aclew_child_id, d_xds_uph, d_tds_uph, d_cds_uph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.utts <- bind_rows(deltas.random.v.tt.uph, deltas.random.v.va.uph) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# TT transitions
all.segments <- all.rand.segments %>%
  mutate(sample = "random", sample_type = "random") %>%
  bind_rows(all.nonrand.segments) %>%
  arrange(aclew_child_id, segment)
turn.transitions <- tibble(
  aclew_child_id = NA,
  segment = NA,
  tier = NA,
  speaker = NA,
  start = NA,
  stop = NA,
  tm1.tier = NA,
  tm1.speaker = NA,
  tm1.start = NA,
  tm1.stop = NA,
  tm1.val = NA,
  tp1.tier = NA,
  tp1.speaker = NA,
  tp1.start = NA,
  tp1.stop = NA,
  tp1.val = NA
)
for (i in 1:nrow(all.segments)) {
  subdata <- all.data %>%
    filter(aclew_child_id == all.segments$aclew_child_id[i] &
             segment == all.segments$segment[i])
  c_utt <- subdata %>%
    filter(tier == "CHI")
  used.tm1s <- c()
  used.tp1s <- c()
  child <- all.segments$aclew_child_id[i]
  # Save turn-by-turn info
  chi.turn.info <- c_utt %>%
    select(aclew_child_id, segment, tier, speaker, start, stop) %>%
    mutate(tm1.tier = NA, tm1.speaker = NA, tm1.start = NA, tm1.stop = NA, tm1.val = NA,
           tp1.tier = NA, tp1.speaker = NA, tp1.start = NA, tp1.stop = NA, tp1.val = NA)
  for (j in 1:nrow(c_utt)) {
    # Find CHI-OTH transitions
    tp1.start <- c_utt$stop[j] - allowed.overlap
    tp1.stop <- tp1.start + allowed.overlap + allowed.gap
    t.plus1 <- which(subdata$speaker != "CHI" &
                    (subdata$val == "T"|subdata$val == "C") &
                    subdata$start >= tp1.start &
                    subdata$start <= tp1.stop)
   # Find OTH-CHI transitions
    tm1.start <- c_utt$start[j] - allowed.gap
    tm1.stop <- tm1.start + allowed.gap + allowed.overlap
    t.minus1 <- which(subdata$speaker != "CHI" &
                    (subdata$val == "T"|subdata$val == "C") &
                    subdata$stop <= tm1.stop &
                    subdata$stop >= tm1.start)
    if(length(t.plus1) > 0) {
      tp1.match <- 0
      for (turn in t.plus1) {
        if (!(turn %in% used.tp1s) & tp1.match == 0) {
          used.tp1s <- c(used.tp1s, turn)
          chi.turn.info$tp1.tier[j] <- subdata$tier[turn]
          chi.turn.info$tp1.speaker[j] <- subdata$speaker[turn]
          chi.turn.info$tp1.start[j] <- subdata$start[turn]
          chi.turn.info$tp1.stop[j] <- subdata$stop[turn]
          chi.turn.info$tp1.val[j] <- subdata$val[turn]
          tp1.match <- 1
        }
      }
    }
    if(length(t.minus1) > 0) {
      tm1.match <- 0
      for (turn in t.minus1) {
        if (!(turn %in% used.tm1s) & tm1.match == 0) {
          used.tm1s <- c(used.tm1s, turn)
          chi.turn.info$tm1.tier[j] <- subdata$tier[turn]
          chi.turn.info$tm1.speaker[j] <- subdata$speaker[turn]
          chi.turn.info$tm1.start[j] <- subdata$start[turn]
          chi.turn.info$tm1.stop[j] <- subdata$stop[turn]
          chi.turn.info$tm1.val[j] <- subdata$val[turn]
          tm1.match <- 1
        }
      }
    }
  }
  turn.transitions <- bind_rows(turn.transitions, chi.turn.info)
}
turn.transitions <- turn.transitions %>%
  filter(!(is.na(tier)))
turn.transitions.overview.o_c <- turn.transitions %>%
  group_by(aclew_child_id, segment, tm1.val) %>%
  summarise(n.o_c.tts = n()) %>%
  rename(oth.spkr = tm1.val) %>%
  replace_na(list(oth.spkr = "O"))
turn.transitions.overview.c_o <- turn.transitions %>%
  group_by(aclew_child_id, segment, tp1.val) %>%
  summarise(n.c_o.tts = n()) %>%
  rename(oth.spkr = tp1.val) %>%
  replace_na(list(oth.spkr = "O"))
all.tt.combos <-  all.segments %>%
  rbind(all.segments) %>%
  rbind(all.segments) %>%
  mutate(oth.spkr = c(rep("T", nrow(all.segments)),
                      rep("C", nrow(all.segments)),
                      rep("O", nrow(all.segments))),
         duration = ifelse(grepl('extension', sample_type), 5,
                           ifelse(grepl('random', sample_type), 5, 1))) %>%
  arrange(aclew_child_id, segment, oth.spkr) %>%
  full_join(turn.transitions.overview.o_c,
            by = c("aclew_child_id", "segment", "oth.spkr")) %>%
  full_join(turn.transitions.overview.c_o,
            by = c("aclew_child_id", "segment", "oth.spkr")) %>%
  replace_na(list(n.o_c.tts = 0, n.c_o.tts = 0)) %>%
  arrange(aclew_child_id, segment, oth.spkr)
tth.per.sample.tds <- all.tt.combos %>%
  filter(oth.spkr == "T") %>%
  group_by(aclew_child_id, sample) %>%
  summarise(dur.sample = sum(duration),
            S.o_c.tth.tds = sum(n.o_c.tts),
            S.c_o.tth.tds = sum(n.c_o.tts)) %>%
  mutate(o_c.tth.tds = (S.o_c.tth.tds/dur.sample)*60,
         c_o.tth.tds = (S.c_o.tth.tds/dur.sample)*60)
tth.per.sample.cds <- all.tt.combos %>%
  filter(oth.spkr == "T" | oth.spkr == "C") %>%
  group_by(aclew_child_id, segment, sample, duration) %>%
  summarise(n_o_c.tts.TC = sum(n.o_c.tts),
            n_c_o.tts.TC = sum(n.c_o.tts)) %>%
  ungroup() %>%
  group_by(aclew_child_id, sample) %>%
  summarise(dur.sample = sum(duration),
            S.o_c.tth.cds = sum(n_o_c.tts.TC),
            S.c_o.tth.cds = sum(n_c_o.tts.TC)) %>%
  mutate(o_c.tth.cds = (S.o_c.tth.cds/dur.sample)*60,
         c_o.tth.cds = (S.c_o.tth.cds/dur.sample)*60)
tth.per.sample <- tth.per.sample.tds %>%
  select(-dur.sample) %>%
  full_join(tth.per.sample.cds, by = c("aclew_child_id", "sample")) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_o_c.tth.tds = 0,
         d_c_o.tth.tds = 0,
         d_o_c.tth.cds = 0,
         d_c_o.tth.cds = 0)
deltas.random.v.tt.tth <- tth.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.tth)) {
  deltas.random.v.tt.tth$d_o_c.tth.tds[i] <-
    deltas.random.v.tt.tth$o_c.tth.tds[i] -
    deltas.random.v.tt.tth$o_c.tth.tds[i-1] # set up for tt - random
  deltas.random.v.tt.tth$d_c_o.tth.tds[i] <-
    deltas.random.v.tt.tth$c_o.tth.tds[i] - deltas.random.v.tt.tth$c_o.tth.tds[i-1]
  deltas.random.v.tt.tth$d_o_c.tth.cds[i] <-
    deltas.random.v.tt.tth$o_c.tth.cds[i] -
    deltas.random.v.tt.tth$o_c.tth.cds[i-1]
  deltas.random.v.tt.tth$d_c_o.tth.cds[i] <-
    deltas.random.v.tt.tth$c_o.tth.cds[i] - deltas.random.v.tt.tth$c_o.tth.cds[i-1]
}
deltas.random.v.tt.tth <- deltas.random.v.tt.tth %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_o_c.tth.tds, d_c_o.tth.tds, d_o_c.tth.cds, d_c_o.tth.cds) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.tth <- tth.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.tth)) {
  deltas.random.v.ha.tth$d_o_c.tth.tds[i] <-
    deltas.random.v.ha.tth$o_c.tth.tds[i-1] -
    deltas.random.v.ha.tth$o_c.tth.tds[i] # set up for ha - random
  deltas.random.v.ha.tth$d_c_o.tth.tds[i] <-
    deltas.random.v.ha.tth$c_o.tth.tds[i-1] - deltas.random.v.ha.tth$c_o.tth.tds[i]
  deltas.random.v.ha.tth$d_o_c.tth.cds[i] <-
    deltas.random.v.ha.tth$o_c.tth.cds[i-1] -
    deltas.random.v.ha.tth$o_c.tth.cds[i]
  deltas.random.v.ha.tth$d_c_o.tth.cds[i] <-
    deltas.random.v.ha.tth$c_o.tth.cds[i-1] - deltas.random.v.ha.tth$c_o.tth.cds[i]
}
deltas.random.v.ha.tth <- deltas.random.v.ha.tth %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_o_c.tth.tds, d_c_o.tth.tds, d_o_c.tth.cds, d_c_o.tth.cds) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.tth <- deltas.random.v.tt.tth %>%
  bind_rows(deltas.random.v.ha.tth) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# CHIVOC mph and uph
chi.voc <- all.data %>%
  filter(tier == "CHI") %>%
  group_by(aclew_child_id, segment) %>%
  summarise(n_utts = n(),
            dur.utts = round(sum(dur)/60000,3)) %>%
  full_join(all.segments, by = c("aclew_child_id", "segment")) %>%
  replace_na(list(n_utts = 0, dur.utts = 0)) %>%
  mutate(duration = ifelse(grepl('extension', segment), 5,
                                 ifelse(grepl('random', segment), 5, 1)))
chi.voc.per.sample <- chi.voc %>%
  group_by(aclew_child_id, sample) %>%
  summarise(S_n_utts = sum(n_utts),
            S_dur.utts = sum(dur.utts),
            S_duration = sum(duration)) %>%
  mutate(cvc_uph = (S_n_utts/S_duration)*60,
         cvc_mph = (S_dur.utts/S_duration)*60) %>%
  select(-S_n_utts, -S_dur.utts, -S_duration) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_cvc_uph = 0,
         d_cvc_mph = 0)
deltas.random.v.tt.cvc <- chi.voc.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.cvc)) {
  deltas.random.v.tt.cvc$d_cvc_uph[i] <-
    deltas.random.v.tt.cvc$cvc_uph[i] -
    deltas.random.v.tt.cvc$cvc_uph[i-1] # set up for tt - random
  deltas.random.v.tt.cvc$d_cvc_mph[i] <-
    deltas.random.v.tt.cvc$cvc_mph[i] - deltas.random.v.tt.cvc$cvc_mph[i-1]
}
deltas.random.v.tt.cvc <- deltas.random.v.tt.cvc %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_cvc_uph, d_cvc_mph) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.cvc <- chi.voc.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.cvc)) {
  deltas.random.v.ha.cvc$d_cvc_uph[i] <-
    deltas.random.v.ha.cvc$cvc_uph[i-1] -
    deltas.random.v.ha.cvc$cvc_uph[i] # set up for ha - random
  deltas.random.v.ha.cvc$d_cvc_mph[i] <-
    deltas.random.v.ha.cvc$cvc_mph[i-1] - deltas.random.v.ha.cvc$cvc_mph[i]
}
deltas.random.v.ha.cvc <- deltas.random.v.ha.cvc %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_cvc_uph, d_cvc_mph) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.cvc <- deltas.random.v.tt.cvc %>%
  bind_rows(deltas.random.v.ha.cvc) %>%
  full_join(ptcp.info, by = "aclew_child_id")

# CHIVM
chi.vm.lx.per.segment <- chi.vm.lx.utts %>%
  group_by(aclew_child_id, sample, segment) %>%
  summarise(n_vocs = n(),
            m_voc.rtg = mean(max_voc.rtg),
            md_voc.rtg = median(max_voc.rtg),
            sd_voc.rtg = sd(max_voc.rtg)) %>%
  full_join(ptcp.info, by = c("aclew_child_id"))
chi.vm.lx.per.sample <- chi.vm.lx.per.segment %>%
  group_by(aclew_child_id, sample) %>%
  summarise(voc_rtg = mean(m_voc.rtg)) %>%
  arrange(aclew_child_id, sample) %>%
  mutate(d_voc_rtg = 0)
deltas.random.v.tt.vrt <- chi.vm.lx.per.sample %>%
  filter(sample != "high-activity")
for (i in 2:nrow(deltas.random.v.tt.vrt)) {
  deltas.random.v.tt.vrt$d_voc_rtg[i] <-
    deltas.random.v.tt.vrt$voc_rtg[i] -
    deltas.random.v.tt.vrt$voc_rtg[i-1] # set up for tt - random
}
deltas.random.v.tt.vrt <- deltas.random.v.tt.vrt %>%
  filter(sample != "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_voc_rtg) %>%
  mutate(delta = "tt-random")
deltas.random.v.ha.vrt <- chi.vm.lx.per.sample %>%
  filter(sample != "turn-taking")
for (i in 2:nrow(deltas.random.v.ha.vrt)) {
  deltas.random.v.ha.vrt$d_voc_rtg[i] <-
    deltas.random.v.ha.vrt$voc_rtg[i-1] -
    deltas.random.v.ha.vrt$voc_rtg[i] # set up for ha - random
}
deltas.random.v.ha.vrt <- deltas.random.v.ha.vrt %>%
  filter(sample == "random") %>% # only keep meaningful vals
  ungroup() %>%
  select(aclew_child_id, d_voc_rtg) %>%
  mutate(delta = "va-random")
deltas.random.v.oth.vrt <- deltas.random.v.tt.vrt %>%
  bind_rows(deltas.random.v.ha.vrt) %>%
  full_join(ptcp.info, by = "aclew_child_id")
```

``` {r plot_sample_differences, message=FALSE, warning=FALSE, paged.print=FALSE}
# XDS/TDS/CDS mph and uph
# mph: deltas.random.v.oth
# uph: deltas.random.v.oth.utts
deltas.random.v.oth.input <- deltas.random.v.oth %>%
  full_join(select(deltas.random.v.oth.utts, aclew_child_id,
                   delta, d_xds_uph, d_tds_uph, d_cds_uph),
            by = c("aclew_child_id", "delta"))

# TDS MPH: Delta TDS mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_tds_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_tds_mph)) %>%
           select(se))[[1]]
)
delta.tds.mph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCDS (min/hr)"))) +
  ylim(c(-30,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# XDS MPH: Delta XDS mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_xds_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_xds_mph)) %>%
           select(se))[[1]]
)
delta.xds.mph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"XDS (min/hr)"))) +
  ylim(c(-30,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS UPH: Delta TDS uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_tds_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_tds_uph)) %>%
           select(se))[[1]]
)
delta.tds.uph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_tds_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCDS (utt/hr)"))) +
  ylim(c(-700,1000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# XDS UPH: Delta XDS uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.input %>%
              group_by(delta) %>%
              summarise(m = mean(d_xds_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.input %>%
           group_by(delta) %>%
           summarise(se = sem(d_xds_uph)) %>%
           select(se))[[1]]
)
delta.xds.uph.plot <- ggplot(
  data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph)) +
  geom_violin(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph)) +
  geom_jitter(data = deltas.random.v.oth.input, aes(x = delta, y = d_xds_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"XDS (utt/hr)"))) +
  ylim(c(-700,1000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

#grid.arrange(delta.tds.mph.plot,delta.xds.mph.plot,
#             delta.tds.uph.plot,delta.xds.uph.plot, nrow=2, ncol=2)


# CHI VOC: Delta voc mph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.cvc %>%
              group_by(delta) %>%
              summarise(m = mean(d_cvc_mph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.cvc %>%
           group_by(delta) %>%
           summarise(se = sem(d_cvc_mph)) %>%
           select(se))[[1]]
)
delta.cvc.mph.plot <- ggplot(
  data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph)) +
  geom_violin(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph)) +
  geom_jitter(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_mph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc (min/hr)"))) +
  ylim(c(-10,20)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# CHI VOC: Delta voc uph between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.cvc %>%
              group_by(delta) %>%
              summarise(m = mean(d_cvc_uph)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.cvc %>%
           group_by(delta) %>%
           summarise(se = sem(d_cvc_uph)) %>%
           select(se))[[1]]
)
delta.cvc.uph.plot <- ggplot(
  data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph)) +
  geom_violin(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph)) +
  geom_jitter(data = deltas.random.v.oth.cvc, aes(x = delta, y = d_cvc_uph),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc (utt/hr)"))) +
  ylim(c(-100,2000)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# CHI VOCMAT: Delta voc mat rating between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.vrt %>%
              group_by(delta) %>%
              summarise(m = mean(d_voc_rtg)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.vrt %>%
           group_by(delta) %>%
           summarise(se = sem(d_voc_rtg)) %>%
           select(se))[[1]]
)
delta.voc.rtg.plot <- ggplot(
  data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg)) +
  geom_violin(data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg)) +
  geom_jitter(data = deltas.random.v.oth.vrt, aes(x = delta, y = d_voc_rtg),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"CHI voc mat (1-4)"))) +
  ylim(c(-.2,0.6)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS/CDS ttph: Delta O->C transitions between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.tth %>%
              group_by(delta) %>%
              summarise(m = mean(d_o_c.tth.tds)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.tth %>%
           group_by(delta) %>%
           summarise(se = sem(d_o_c.tth.tds)) %>%
           select(se))[[1]]
)
delta.tds.tth.o_c.plot <- ggplot(
  data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds)) +
  geom_violin(data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds)) +
  geom_jitter(data = deltas.random.v.oth.tth, aes(x = delta, y = d_o_c.tth.tds),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"OTH-TCHI (tt/hr)"))) +
  ylim(c(-100,600)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

# TDS/CDS ttph: Delta C->O transitions between samples
mse.info <- tibble(
  delta = c("tt-random", "va-random"),
  means = c(deltas.random.v.oth.tth %>%
              group_by(delta) %>%
              summarise(m = mean(d_c_o.tth.tds)) %>%
              select(m))[[1]],
  se = c(deltas.random.v.oth.tth %>%
           group_by(delta) %>%
           summarise(se = sem(d_c_o.tth.tds)) %>%
           select(se))[[1]]
)
delta.tds.tth.c_o.plot <- ggplot(
  data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds)) +
  geom_violin(data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds)) +
  geom_jitter(data = deltas.random.v.oth.tth, aes(x = delta, y = d_c_o.tth.tds),
              shape = 1, width = .1, size = 1) +
  geom_errorbar(data = mse.info,
                aes(y = means, ymax = means + (1.96 * se), ymin = means + (-1.96 * se)),
                    width = 0.25) +
  geom_point(data = mse.info, aes(y = means), size = 2) +
  geom_hline(yintercept = 0, lty = "dashed") +
  ylab(expression(paste(Delta,"TCHI-OTH (tt/hr)"))) +
  ylim(c(-100,600)) +
  xlab("Samples compared") +
  scale_x_discrete(labels = c('TT - R','VA - R')) +
  theme_apa() +
  theme(axis.title.x = element_text(size=9),
	axis.title.y = element_text(size=9))

#grid.arrange(delta.cvc.mph.plot,delta.voc.rtg.plot,
#             delta.tds.tth.o_c.plot, delta.tds.tth.c_o.plot, nrow=2, ncol=2)

```

