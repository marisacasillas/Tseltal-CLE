---
title             : "Título"
shorttitle        : "Título corto"

author: 
  - name          : "Marisa Casillas"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "P.O. Box 310, 6500 AH Nijmegen, The Netherlands"
    email         : "Marisa.Casillas@mpi.nl"
  - name          : "Juan Méndez Girón"
    affiliation   : "2"
  - name          : "Melanie Soderstrom"
    affiliation   : "3"
  - name          : "Penelope Brown"
    affiliation   : "1"
  - name          : "Gilles Polian"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "Max Planck Institute for Psycholinguistics"
  - id            : "2"
    institution   : "Centro de Investigaciones y Estudios Superiores en Antropología Social"
  - id            : "3"
    institution   : "University of Manitoba"

#author_note: |
#  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

abstract: |
  A hacer

keywords          : "Desarrollo de lenguaje, habla dirigida al niño, input lingüistico, Tseltal, Maya"
wordcount         : "XXXX (XXXX sin bibliografía)"

csl: apa.csl # use "et al." for second+ appearances of citations

bibliography      : ["Tseltal-CLE-full2015sample.bib"]

figsintext        : yes
figurelist        : no
tablelist         : no
footnotelist      : no
lineno            : yes
mask              : no

class             : "man"
output            : papaja::apa6_pdf #apa6_pdf or apa6_word
---

```{r load_packages, include=FALSE, echo=FALSE, warning=FALSE}
library(papaja)
library(tidyverse)
library(fuzzyjoin)
library(ggpubr)
library(glmmTMB)
library(broom.mixed)
library(ggeffects)
# library(viridis)
# library(grid)
# library(gridExtra)
# library(lme4)
# library(DHARMa)
source("../0-Helper.R")
source("0-Summarize.utt.info.R")

# load chattr stuff (this ONLY works on MC's machine--eep)
source("../../chattr-basic/tabularize-data.R")
source("../../chattr-basic/transition-detectors.R")
source("../../chattr-basic/chattr-helpers.R")
source("../../chattr-basic/tabularize-data.R")
source("../../chattr-basic/transition-detectors.R")
source("../../chattr-basic/continuation-detectors.R")
source("../../chattr-basic/intseq-detectors.R")
source("../../chattr-basic/estimate-baseline.R")
source("../../chattr-basic/fetch-chattr-info.R")
source("../../chattr-basic/make-summaries.R")
```

```{r analysis_presets, include=FALSE}
plot.path <- "plots/"
metadata.path <- "metadata/"
clip.dur.min <- 5
run.from.scratch <- FALSE
```

```{r rec_info, include=FALSE}
rec.info <- read_csv(
  paste0(metadata.path, "rec-metadata.csv", collapse = "")) %>%
  filter(source != "ACLEW") %>%
  select(recording, age, sex,
         mat_ed, number_older_sibs, mother_dob,
         household_size, aclew_id)
```

# Introducción

Alrededor del mundo, los niños aprenden su lengua materna a través de las interacciones verbales que observan y de las cuales en que participan, en el hogar y en la escuela. Estudios anteriores han establecido que el desarrollo del lenguaje sucede más temprano y se acelera más rapido si los cuidadores del niño hablan directa y frecuentemente con él, con un estilo apropriado para su nivel de sofisticación lingüístico y cognitivo [Habla Dirigida al Niño, HDN; REFS]. En particular, los niños que oyen más habla dirigida así a ellos desarrollan más rápidamente su conocimiento lexical; producen y compreden más palabras, y reconocen más rápidamente las palabras [REFS]. Sabemos también que el conocimiento lexical influye en la adquisición y uso del conocimiento sintáctico [REFS]. En resumidas palabras, el HDN es un mecanismo fundamental para aprender el lenguaje.

Sin embargo, este mecanismo no permite establecer la cantidad de HDN que es necesario para la adquisición del lenguaje. Estudios basados en interacciones cortas y modelos teóricos y computacionales, sugieren que la cantidad de evidencia lingüística requerida para el desarrollo normal del lenguaje sea inmenso. Pero evidencia sociolingüística y antropológica sugiere algo contrario, que (a) hay muchas maneras de acumular evidencia lingüística del ambiente familiar, que (b) hablar directamente a niños es muy común a través de las sociedades humánas, y que (c) mucha HDN es una invención moderna y occidental [REFS].

Para echar luz sobre la cantidad de evidencia lingüística requerida para el desarrollo del lenguaje, es necesario enfocar en los patrones de habla que los niños encuentran normalmente en sus hogares---patrones de habla cotidiana, y no solo HDN. El método ideal para estudiar patrones el la habla cotidiana alrededor del niño es usar grabaciones "daylong", en cual el bebé o niño lleve una camiseta o un chaleco con una grabadora adentro y sigue con un día en casa "normal", resultando en una grabación que, frecuentamente dura seis horas o más [REFS casillas cristia]. Con estas grabaciones, las cual son centrado en el perspectivo del niño, es posible documentar patrones en habla a través una una multiplicidad de actividades cotidianas y parejas (e.g., la madre, la tía, un niño vecino, etc.). La colección de grabaciones daylong es sencillo, y así es posible colectar, anotar, y analyzar grabaciones en una manera casi identical entre poblaciones diversas.

Estimar la variación humana en ambientes lingúísticos de niños requiere que estudiamos las experiencias de niños criados en comunidades grandes y pequeñas, urbanas y rurales, modernas y tradicionales. En cambio, la mayoria de investigaciones cuantitativas de habla ambiental del niño viene de poblaciones urbanas, occidentales, y de habla inglesa [REFS]. Por el contrario, estudios mostrando la diversidad de ambientes lingüísticos y de prácticas para la socializacíon de lengua han enfocado, en la mayor parte, en comunidades pequeñas y tradicionales, o en grupos subrepresentadas dentro de contextos urbanos o semi-urbanos mas grandes [REFS].

Investigaciones comparativas mas recientes sugieren que la cantidad de HDN en el ambiente de niños es muy poco, incluso contextos culturales en cual es típico hablar directamente a bebés sobre su foco de atención (en el estilo "child centric"; REFS). Antes del tres años, los niños oigan menos que cinco minutos de HDN de adultos durante un día normal a casa [REFS bunce]. Diferencias en ambiente lingüístico de niños emerge en *quien* habla al niño, antes bien la cantidad de HDN [REFS bunce]. Por ejemplo, Casillas et al., encontraron que la práctica de aloparenting entre familias en la Isla de Rossel (Papua Nueva Guinea) tiene un efecto en los patrones de habla oído por los niños: comparado con otras sociedades indígenas con estructuras asentamientos similares, y con poblaciones urbanas y occidentales, niños jovenes en la Isla de Rossel oigan más habla de otro niños y de hombres [REFS casillas 2019 ur; bunce].

Una tema persistente en estes esudios de habla en el ambiente natural del niño es que colectar, transcribir, y anotar grabaciones muy naturales es muy caro y cuesta mucho tiempo; por eso hay una tendencia enfocar en muestras pequeñas (típicamente N = 20 y mas pequeño, a través de 3--5 años; REFS). En el caso de una comunidad subrepresentada, sea prematuro formar conclusiones fuertes en un basis de datos así pequeño; es facil imaginar que un analisis derivando de una muestra pequeña no representa suficientamente la variación normal en la comunidad y da una impresión inexacto de las tendencias típicas en el ambiente lingüístico de niños allá. 

En este estudio buscamos establecer la variación típica y tendencias in general del uso de HDN en una comunidad lingüística para que sólo una muestra pequeña de datos daylong ha estado analizado: el Tseltal de Tenejapa (Maya; Chiapas, Mexico). En esta comunidad, como en otras comunidades Mayas (e.g., Tsotil, Yukateko, K'iche', Mam), niños están socializados observar las interacciones alrededor de ellos (sin esperar a estar el foco de atención social) [REFS de leon, rogoff, pye, y shneidman]. Están llevados por la más parte del primo año de vida, primariamente por la madre; y mientras cuidadores respondan muy sensiblemente cuando el bebé quiere amamantar, dormir, sentarse, o tener un cambio de pañal/pantalon, no usan HDN frecuentamente [REFS]. Este estilo de interaccion con niños "non-child-centric" se encuentra en muchas comunidades alrededor del mundo [REFS]. También es común que un bebé o niño joven está cuidado por un hermano mayor o otros miembros de la familia, especialmente después de que empiezan comer comida solida; Brown estima que, después de tres años, la mayor parte del HDN viene de otros niños (HDN-N), y no de adultos. En unas comunidades Yukatekas, Shneidman también encontró que la cantidad de HDN-N aumentó mucho (300%) entre uno y tres años, y formó la mayoría del HDN de niños 2 años y más.

Un estudio anterior ha usado grabaciones daylong con niños tseltales para estimar la cantidad de HDN y otra habla oíble [REFS], confirmando que niños sur la edad de tres años les están directamente hablado infrecuentamente---3.6 minutos por hora---sin evidencia de demora en su desarrollo lingüístico. El HDN en el ambiente vino, por la mayor parte (~80%) de mujeres, con un pequeño y non-significo aumentación de HDN-N asociado con edad del niño mas alta. Sin embargo, estos resultados están basados en las grabaciónes de sólo 10 niños, y sólo con niños menor que tres años; tan joven para observar el inicio de HDN-N frecuente [REFS]. La muestra pequeña puede también explicar, en parte, la discrepancia en la prevalencia de HDN-N entre eso estudio y lo de Shneidman en Goldin-Meadow (2012), en cual HDN-N fue muy frecuente después de 2 años. Sin una muestra mas integral, es dificil saber si la diferencia deriva de prácticas diferentes entre comunidades Tseltales y Yukatecos, de métodos de grabación, o algo diferente.

Presentamos aquí una replicación y extensión considerable del estudio de Casillas et al. (2019): investigamos la velocidad de HDN usado por cuidadores adultos y jovenes con 56 niños tseltales entre 2 y 52 meses de edad, incluyendo los 10 niños destacados en el estudio anterior. Usando lo mismo técnico---anotar y transcribir segmentos cortos aleatoriamente del día de grabar---esperábamos que (a) in general, la velocidad de HDN no cambia significamente con la edad del niño, (b) HDN de otros niños aumenta significamente con la edad del niño y, como antes, (c) niños encuentran HDN más frecuentamente en la mañana, con niños más grande oyendo mas HDN cercal del mediodía.<!-- Especulamos también que niños que oigaron más HDN tendrían vocabularios productivos y receptivos más grandes. Testamos esta predicción indirectamente por relacionar la velocidad de HDN de niños individuales con la diversidad de vocbaulario en su habla spontanea de los segmentos transcribados.-->

# Metodología {#methods}

## Participantes {#methods-participants}
Los niños enfocados aquí vienen de una comunidad tradicional con una agricultura de subsistencia situada en los altos de Chiapas (en el sur de México). Antes de que entran en la escuela, el desarrollo lingüístico de niños en esta comunidad es, típicamente, monolingual en el Tseltal, una idioma Maya [REFS]. Hogares son organizados en grupos patrilocales, en cuales viven miembros de la familia de varias generaciones. Durante las horas despiertas del día, infantes están llevados por un rebozo en la espalda de sus madres, mientras ella sigue con sus actividades diarias. Si la madre va a trabajar en el campo, a veces trae el bebé, y a veces deja el bebé con un otro miembro de la familia en casa (e.g., una tía o hermano mayor del niño). Todos los miembros de la familia (~4 años y más) contribuyen al cuidado de niños [REFS].

Décadas de investigación antropológica y lingüística ha establecido que el entorno lingüístico de niños Mayas no está centrado en el interes del niño o en los nombres de objetos; por el contrario, niños están socializados pagar atención a la interacción social entre otros, tomando parte en la interacción como participante lateral [REFS @brown1998conversational; @brown2011cultural; @brown2014interactional]. Durante la infancia, bebés reciben respuestas rápidas y efectivas cuando indican que tienen hambre, quieren dormir, y otros asuntos corporeales. Más tarde, cuando empiezan a comunicar con gestos y palabras reconocibles (~1;0), provocan respuestas verbales mas frecuentamente [REFS]. Intercambios interaccionales con niños son, normalmente, corto y no-verbal, y ocurren in contextos multi-participantes [@brown2014interactional]. La habla interactiva, por la más parte, enfoca en acciones y respuestas apropriados para el contexto social inmediato; no en palabras y sus sentidos [mira también @deleon2011language; @rogoff2003firsthand]. Al fin del quinto año (5;0), la mayoría de niños hablar fluentamente en tseltal y participar en trabajo de hogar (incluso el cuidado de hermanitos). El estilo tseltal de cuidar y socializar niños es semejante al estilo usado por otros cuidadores mayas através de México, Guatemala, y Belice [e.g., @deleon2011language; @gaskins2000childrens; @pye1986quiche; @rogoff2003firsthand; @shneidman2012language].

Los datos analizado aquí vienen del Casillas HomeBank Corpus [@Casillas-HB], que incluye grabaciones daylong y otros datos sobre el desarrollo lingüístico de más que 100 niños, la mayoría menor de 4;0, en dos comunidades tradicionales: la de los tseltales discutida aquí, y una comunidad isleña en Papua Nueva Guinea discutido en otros artículos [@brown2011cultural; @brown2014interactional]. Grabaciones daylong nos permiten investigar patrones lingüísticos encontrado por los niños a través de actividades y contextos interaccionales diversos durante el día [@bergelson2018day; @greenwood2011assessing; @tamislemonda2018routine], y se puede aplicar las casi idénticamente en poblaciones diversas [REFS].

Colectamos los datos tseltales in 2015 de 55 niños de 43 madres (32.7% promogénitos). Que sepamos, todos los niños estaban desarrollando sin trastorno lingüal, cognitivo, o motorico, y todos oigaban, veían, y crecían bien. Los padres participantes (madres: media = 26.3 años; mediana = 23; rango = 16--43, y padres: media = 30; mediana = 27; rango = 17--52) tenían 2 a 3 niños típicamente (mediana = 2; rango = 1--9), y 28% vivían con dos niños menor que 4;0. Calculamos, basados en datos de hijos viviendos, que madres tienen ~20 anõs cuando dan luz a su primer bebé (mediana = 19; rango = 21--27), con un interval inter-hijo de 3 años (mediana = 2.8; rango = 1--8.5). Por eso, mientras 32.7% de los niños estudiatos. La mayoría (77%) de madres cumplió su educación primaria o más (nivel de educación más alto: 37% con primario; 30% secundario; 12% preparatorio; 2% cursos universitarios; 23% sin educación primaria completada). Todos los padres han completado su educación primaria, y la mayoría también cumplío la educación secundaria (44%) o preparatoria (21%), con dos padres cumpleando cursos universitarios (5%).

## Recolección de datos {#methods-collection}
Trabajamos con un residente de la comunidad para reclutar los participantes, conducir el proceso de consentimiento informado, y colectar y anotar las grabaciones. Colectamos información demografica (e.g., sobre edad, educacíon, y fondo lingüístico de los cuidadores y hermanos del niño enfocado, etc.) y pidimos informacíon sobre la fecha de nacimiento y desarrollo del niño. La mayoría de madres también tenían una carta medical de la clínica local con la fecha de nacimiento del niño enfocado. Normalmente reciben esta carta entre dos semanas del nacimiento de un bebé durante una visita en la clínica. De vez en cuando, la carta fue pedida meses (o años) depués del nacimiento del niño o no fue pedida todavía. En estos casos, triangulamos la fecha de nacimiento con: la fecha y la edad del niño dadas por los padres, en combinación con otros fuentes de información relevantes (e.g., fecha de nacimiento de un primo nacido unas semanas/días antes or después del niño enfocado). El proceso de consentimiento informado fue conducido en dos partes: cuando arreglamos una fecha de grabación, discutimos informalmente lo que pasaría durante el día de grabar y lo que planeamos hacer con los datos depués. El día de grabar, discutimos también los derechos de los participantes y unos detalles más técnicos sobre usos futuros de los datos por otros investigadores interesados en la lengua y cultural tseltal.

Hicimos grabaciones con una combinación de dos dipositivos: una grabadora pequeña y ligera (Olympus WS-832) y una cámara miniatura que toma fotos con un interval fijo (cada 30 segundos; Narrative Clip 1) aumentado con un lente fisheye minaturo (Photojojo Super Fisheye). Niños llevaron un chaleco diseñado especificamente para estas grabaciónes [Gráfico 1](#fig1) para 9 á 11 horas en casa, típicamente entre las 8.00 y las 18.00. Niños menor que ~8 meses llevaron un body de bebé con la grabadora mientras el cuidador corriente llevó un chaleco mas grande con la cámara. La mañana de la grabación, visitamos el niño en su casa, iniciamos la grabación, y pusimos el chaleco en el niño. En la tarde regresamos para colectar los dipositivos, verificar que los padres estuvieron contentos con su experiencia, y arreglar una cita para unos experimentos lingüísticos en los días después (no reportado aquí). El proceso de consentimiento y la realización de datos estuvieron conducido en acuerdo con las guías éticas aprovechas por el Radboud University Social Sciencies Ethics Committee.

## Selección y anotación de los datos {#methods-processing}
Sincronizamos el audio con las fotos para generar un archivo video ("snapshot-linked audio") para cada grabación (se encuentra los scripts para procesar los audios y las fotos en https://github.com/marisacasillas/Weave). Aunque hay 500 horas de datos, sin transcripción, no es posible analyzar la frecuencia de HDN. La anotación y transcripción de uno minuto de audio en el estilo descrito abajo toma 30--50 minutos, y por eso trabajamos sólo en nueve segmentos cortos (5 minutos) selectados aleatoriamente^[Entre el momento de salida y el momento de regreso de los investigadores.] por cada grabación. Estos 45 minutos por niño nos da una estimación de la tasa promedia de HDN total durante las horas despiertas, y nos permiten investigar como la tasa cambia como funcción de la edad del niño y hora del día. Usamos todas las grabaciones en el corpus: 56 grabaciones entre 55 niños^[La primera grabación de un niño fue muy corta por un problema técnica.] entre 2 y 52 meses de edad (30 niñas y 25 niños), que resulta en 42 horas de audio para anotación.

Toda la HDN<!-- y todas las vocalizaciones del niño focalizado--> se anotó por un hablante nativo del tseltal; las 10 horas de audios de Casillas et al. [-@casillas2019early] por un miembro de la comunidad y la primera autora, y las 32 horas más por el segundo autor. Hicimos anotación en ELAN [@ELAN] con el esquema de anotación ACLEW [https://osf.io/b2jep/wiki/home/, @casillas2017ACLEWDAS]. A través de todas las 42 horas, añadimos una transcripción (en el tseltal) y una traducción aproximada (en el español) para cada enuncio dirigido al niño focalizado<!-- y cada vocalización por el niño focalizado--> y marcamos el tipo de hablante que habló al niño (e.g., madre, otra mujer, hermano mayor, etc.). Usamos información contextual del audio y fotos para decidir cuando un enuncio fue, seguramente, dirigido al niño. Exportamos las transcripciónes de ELAN á un formato tab-delimited text para analisis.

## Analysis de los datos {#methods-analysisinfo}

Investigamos, así como Casillas et al. [-@casillas2019early] los efectos de la edad del niño, porción del día, número de personas en el hogar, y número de personas presente durante el segmento anotado en el uso de HDN. Se condució el analisis en R [@R-base] con generalized linear mixed-effects regresiones del paquete glmmTMB [@brooks2017modeling] y se hició los gráficos con el paquete ggplot [@R-ggplot2]. Se encuentre los datos y los scriptos para el analisis en https://github.com/marisacasillas/Tseltal-CLE/Tseltal-CLE-full2015sample/. Naturalmente, velicodad de HDN sólo puede ser metido en números positivos (0--infinidad)---por eso la distribución estatadistica natural del HDN no es normal, y tiene una cola derecha inflatada. Usamos un negative binomial linking function---que también estima un dispersion parameter---en la regresión para confrontar este problema [@brooks2017modeling; @smithson2013generalized]. Además, en muchos segmentos audios no hay nada HDN y la distribucíon de HDN a través de segmentos, por eso, tiene dos modos: uno centrado en cero y uno centrado en la mediana de segmentos con HDN [Gráfico 2](#fig2). Añadimos un componente zero-inflation a la regresión para confrontar este problema. Al fin, nuestro analisis con regresión zero-inflated negative binomial mixed-effects nos da dos modelos estadisticos: una regresión binomial (logístoco) que evalua la probabilidad de un segmento sin HDN (i.e., 0 vs. mas que 0 HDN min/hra) y una regresión linear (usando la distribución negative binomial) que evalua la velocidad de HDN en segmentos con mas que 0 HDN min/hra (e.g., '1' vs '3' minutos de HDN per hora) y da una estimación de dispersión de los datos. Se encuentre una regresión gaussian linear mixed effects (más convencional pero menor adecuado) en los Materiales Suplemental.<!--the results are broadly similar to what we report here.-->

## Anotación de datos

```{r prepare_data, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
if (run.from.scratch == TRUE) {
  # Read in utterance data and metadata
  utt.info <- read_csv("all.CHI.OTR.utterances.csv")
  clip.info <- read_csv(
    paste0(metadata.path, "all.annotated.clips.csv", collapse = "")) %>%
    mutate(clip.onset.uncorrected = str_pad(
      as.character(clip.onset.uncorrected),
      width = 6, side = "left", pad = "0"),
           clip.onset.corrected = str_pad(
      as.character(clip.onset.corrected),
      width = 6, side = "left", pad = "0"))
  
  # Create full matrix of annotated clips for CHI and OTR tiers
  all.clips.CHIOTR.tiers <- bind_rows(
    mutate(clip.info, tier.name = "CHI"),
    mutate(clip.info, tier.name = "OTR")
  )
  
  # Compute ptcp info standards
  rec.info.stds <- rec.info %>%
    mutate(
      tchiyr.m = mean(age),
      motyr.m = mean(mother_dob),
      nsb.m = mean(number_older_sibs),
      hsz.m = mean(household_size),
      tchiyr.sd = sd(age),
      motyr.sd = sd(mother_dob),
      nsb.sd = sd(number_older_sibs),
      hsz.sd = sd(household_size),
      tchiyr.std = ((age - tchiyr.m)/tchiyr.sd),
      chisx.std = recode_factor(
        sex, "M" = "M", "F" = "F")
      )
} else {
  clip.info <- read_csv(
    paste0(metadata.path, "all.annotated.clips.csv", collapse = "")) %>%
    mutate(clip.onset.uncorrected = str_pad(
      as.character(clip.onset.uncorrected),
      width = 6, side = "left", pad = "0"),
      clip.onset.corrected = str_pad(
        as.character(clip.onset.corrected),
        width = 6, side = "left", pad = "0"))

  # Compute ptcp info standards
  rec.info.stds <- rec.info %>%
    mutate(
      tchiyr.m = mean(age),
      motyr.m = mean(mother_dob),
      nsb.m = mean(number_older_sibs),
      hsz.m = mean(household_size),
      tchiyr.sd = sd(age),
      motyr.sd = sd(mother_dob),
      nsb.sd = sd(number_older_sibs),
      hsz.sd = sd(household_size),
      tchiyr.std = ((age - tchiyr.m)/tchiyr.sd),
      chisx.std = recode_factor(
        sex, "M" = "M", "F" = "F")
    )
  
}
```

```{r add_convbout_info, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
if (run.from.scratch == TRUE) {
  utts.within.is <- tibble()
  
  for (rec in unique(utt.info$recording)) {
    # print(rec)
    rec.utt.info <- utt.info %>%
      filter(recording == rec)
    cds.utts.wi.is.rec <- tibble()
    chi.utts.wi.is.rec <- tibble()
    if (nrow(rec.utt.info) > 0) {
      for (clip in unique(rec.utt.info$clip.onset)) {
        # print(clip)
        cds.utts.wi.is.clip <- tibble()
        chi.utts.wi.is.clip <- tibble()
        clip.utt.info <- rec.utt.info %>%
          filter(clip.onset == clip) %>%
          select(tier.name, time.start, time.end) %>%
          rename(speaker = tier.name,
                 start.ms = time.start,
                 stop.ms = time.end) %>%
          mutate(start.ms = start.ms * 1000,
                 stop.ms = stop.ms * 1000,
                 annot.clip = clip)
        if (nrow(clip.utt.info) > 0 &&
            "CHI" %in% clip.utt.info$speaker &&
            "OTR" %in% clip.utt.info$speaker) {
          tt <- fetch_transitions(
            clip.utt.info, allowed.gap = 2000, allowed.overlap = 1000,
            min.utt.dur = 0, target.ptcp = "CHI", interactants = FALSE,
            addressee.tags = FALSE, mode = "strict")
          if (nrow(tt) > 0 &&
              (length(which(!is.na(tt$prompt.spkr))) > 0) ||
              (length(which(!is.na(tt$response.spkr))) > 0)) {
            is <- fetch_intseqs(tt, allowed.gap = 2000)
            cds.utts.wi.is.clip <- bind_rows(cds.utts.wi.is.clip,
                                        filter(is, !is.na(intseq.num))) %>%
              select(prompt.start.ms, response.start.ms) %>%
              pivot_longer(cols = c(prompt.start.ms, response.start.ms),
                           names_to = "tt.pos", values_to = "start.ms") %>%
              filter(!is.na(start.ms)) %>%
              select(start.ms) %>%
              distinct() %>%
              mutate(clip.onset = clip)
            chi.utts.wi.is.clip <- bind_rows(chi.utts.wi.is.clip,
                                        filter(is, !is.na(intseq.num))) %>%
              select(start.ms) %>%
              mutate(clip.onset = clip)
          }
        }
        if (nrow(cds.utts.wi.is.clip) > 0) {
          cds.utts.wi.is.rec <- bind_rows(cds.utts.wi.is.rec,
                                          cds.utts.wi.is.clip)
        }
        if (nrow(chi.utts.wi.is.clip) > 0) {
          chi.utts.wi.is.rec <- bind_rows(chi.utts.wi.is.rec,
                                          chi.utts.wi.is.clip)
        }
      }
      if (nrow(cds.utts.wi.is.rec) > 0) {
        cds.utts.wi.is.rec <- cds.utts.wi.is.rec %>%
          mutate(time.start = start.ms/1000,
                 clip.onset = as.numeric(clip.onset)) %>%
          # for fun with floating point comparison (affects 1% of the data)
          # (╯°□°）╯︵ ┻━┻
          difference_inner_join(
            filter(rec.utt.info, tier.name == "OTR") %>%
              mutate(clip.onset = as.numeric(clip.onset)),
            max_dist = 0.01,
            distance_col = "fuzzyjoin.dist.sec",
            by = c("clip.onset", "time.start"))
      }
      if (nrow(chi.utts.wi.is.rec) > 0) {
        chi.utts.wi.is.rec <- chi.utts.wi.is.rec %>%
          mutate(time.start = start.ms/1000,
                 clip.onset = as.numeric(clip.onset)) %>%
          # for fun with floating point comparison (affects 1% of the data)
          # ಥ_ಥ
          difference_inner_join(
            filter(rec.utt.info, tier.name == "CHI") %>%
              mutate(clip.onset = as.numeric(clip.onset)),
            max_dist = 0.01,
            distance_col = "fuzzyjoin.dist.sec",
            by = c("clip.onset", "time.start"))
      }
    }
    if (nrow(cds.utts.wi.is.rec) > 0) {
     utts.within.is <- bind_rows(
       utts.within.is,
       mutate(cds.utts.wi.is.rec, recording = rec) %>%
         select(-start.ms)) %>%
       bind_rows(mutate(chi.utts.wi.is.rec, recording = rec) %>%
         select(-start.ms)) %>%
       arrange(recording, clip.onset.x, time.start.x)
    }
  }
  # check that floating point issue is dealt with properly
  # which(is.na(utts.within.is$tier.name))
  # length(which(utts.within.is$time.start.fuzzyjoin.dist.sec > 0))/nrow(utts.within.is)
  
  # Tidy the columns up
  # Again, copy with floating point comparison, this time with unique (enough)
  # utterance IDs
  utts.within.is <- utts.within.is %>%
    select(-clip.onset.y, -time.start.y, -clip.onset.fuzzyjoin.dist.sec,
           -time.start.fuzzyjoin.dist.sec, -fuzzyjoin.dist.sec) %>%
    rename(clip.onset = clip.onset.x, time.start = time.start.x) %>%
    mutate(within.is = TRUE,
           utt.id = paste0(
             tier.name, round(time.start,1), round(dur.sec,1),
             recording, clip.onset)) %>%
    select(within.is, utt.id)
  
  utt.info <- utt.info %>%
    mutate(clip.onset = as.numeric(clip.onset),
           utt.id = paste0(
             tier.name, round(time.start,1), round(dur.sec,1),
             recording, clip.onset)) %>%
      full_join(utts.within.is, by = c("utt.id")) %>%
    select(-utt.id)
  
  write_csv(utt.info, "uttinfo.wi.intseqs.all.csv")
} else {
  # Create full matrix of annotated clips for CHI and OTR tiers
  all.clips.CHIOTR.tiers <- bind_rows(
    mutate(clip.info, tier.name = "CHI"),
    mutate(clip.info, tier.name = "OTR")
  )

  utt.info <- read_csv("uttinfo.wi.intseqs.all.csv")
}
```

```{r summarize_allCHIOTR, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# Create summaries, adding in zeroes for annotated clips with no speech

# ... at the clip level
clip.summary.all <- summarize.over.clips(utt.info,
                                 clip.dur.min, all.clips.CHIOTR.tiers,
                                 rec.info.stds)

# ... and then with averages across clips at the recording level
rec.summary.all <- summarize.over.recs(clip.summary.all, rec.info.stds)

# And then repeat just for speech within interactional sequences
# ... at the clip level
clip.summary.is <- summarize.over.clips(filter(utt.info, within.is == TRUE),
                                 clip.dur.min, all.clips.CHIOTR.tiers,
                                 rec.info.stds)

# ... and then with averages across clips at the recording level
rec.summary.is <- summarize.over.recs(clip.summary.is, rec.info.stds)

```

```{r summarize_grand_means, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
# OTR summaries
grand.means.OTR.all <- rec.summary.all %>%
  ungroup() %>%
  filter(tier.name == "OTR") %>%
  summarize(across(tot.spchmin:sd.un.mph, ~ mean(.x, na.rm = TRUE)))

grand.means.OTR.is <- rec.summary.is %>%
  ungroup() %>%
  filter(tier.name == "OTR") %>%
  summarize(across(tot.spchmin:sd.un.mph, ~ mean(.x, na.rm = TRUE)))

# I give up on trying to do this inline with rename_all/rename_at womp womp
OTR.is.cols <- rec.summary.is %>%
  ungroup() %>%
  filter(tier.name == "OTR") %>%
  select(c(recording, contains(c(".spchmin", ".mph"))))
colnames(OTR.is.cols) <- paste(names(OTR.is.cols), ".is", sep = "")

grand.means.prop.IS.OTR <- rec.summary.all %>%
  filter(tier.name == "OTR") %>%
  full_join(OTR.is.cols, by = c("recording" = "recording.is")) %>%
  ungroup() %>%
  mutate(
    prop.is.tot.spchmin = tot.spchmin.is/tot.spchmin,
    prop.is.tot.fa.spchmin = tot.fa.spchmin.is/tot.fa.spchmin,
    prop.is.tot.ma.spchmin = tot.ma.spchmin.is/tot.ma.spchmin,
    prop.is.tot.fc.spchmin = tot.fc.spchmin.is/tot.fc.spchmin,
    prop.is.tot.mc.spchmin = tot.mc.spchmin.is/tot.mc.spchmin,
    prop.is.tot.oc.spchmin = tot.oc.spchmin.is/tot.oc.spchmin,
    prop.is.tot.un.spchmin = tot.un.spchmin.is/tot.un.spchmin,
  ) %>%
  summarize(across(prop.is.tot.spchmin:prop.is.tot.un.spchmin,
                   ~ mean(.x, na.rm = TRUE)))


# CHI summaries
grand.means.CHI.all <- rec.summary.all %>%
  ungroup() %>%
  select(-contains(c(".fa.", ".ma.", ".fc.", ".mc.", ".oc.", ".un."))) %>%
  filter(tier.name == "CHI") %>%
  summarize(across(tot.spchmin:sd.tot.mph, ~ mean(.x, na.rm = TRUE)))

grand.means.CHI.is <- rec.summary.is %>%
  ungroup() %>%
  select(-contains(c(".fa.", ".ma.", ".fc.", ".mc.", ".oc.", ".un."))) %>%
  filter(tier.name == "CHI") %>%
  summarize(across(tot.spchmin:sd.tot.mph, ~ mean(.x, na.rm = TRUE)))

```

# Resultados
<!-- PART 1
x how much directed speech do children hear on average
    x does it change with age?
    x does it change across the day (* with age)?
    x how much of it occurs within tt/is?
-->

## Target-child directed speech rate

On average, across all `r length(unique(rec.summary.all$aclew_id))` recordings from all `r length(unique(rec.summary.all$aclew_id)) - 1` children, the baseline rate of speech directly addressed to the target child (i.e., TCDS) was `r round(grand.means.OTR.all$mean.tot.mph,2)` minutes per hour (median = `r round(grand.means.OTR.all$median.tot.mph,2)`, SD = `r round(grand.means.OTR.all$sd.tot.mph,2)`, range = `r round(grand.means.OTR.all$min.tot.mph,2)`--`r round(grand.means.OTR.all$max.tot.mph,2)`). This is somewhat lower than the average of 3.6 min/hr reported in the smaller sample from this community reported in Casillas et al. (2020). If we only count TCDS that occurs within turn-taking sequences (i.e., a prompt to a child's response, a response to a child's prompt, or an utterance within part of a longer turn-taking sequence), the baseline rate is lower, at `r round(grand.means.OTR.is$mean.tot.mph,2)` minutes per hour (median = `r round(grand.means.OTR.is$median.tot.mph,2)`, SD = `r round(grand.means.OTR.is$sd.tot.mph,2)`, range = `r round(grand.means.OTR.is$min.tot.mph,2)`--`r round(grand.means.OTR.is$max.tot.mph,2)`). As is apparent, most of the TCDS comes within turn-taking sequences. Across recordings, the mean proportion of TCDS minutes that occurred within turn-taking sequences was `r round(grand.means.prop.IS.OTR$prop.is.tot.spchmin,2)`, with average proportions ranging between .70 and .90 across broad speaker type categories (female adults = `r round(grand.means.prop.IS.OTR$prop.is.tot.fa.spchmin,2)`; male adults = `r round(grand.means.prop.IS.OTR$prop.is.tot.ma.spchmin,2)`; female children =  `r round(grand.means.prop.IS.OTR$prop.is.tot.fc.spchmin,2)`; male children = `r round(grand.means.prop.IS.OTR$prop.is.tot.mc.spchmin,2)`; other/unknown =  `r round(grand.means.prop.IS.OTR$prop.is.tot.un.spchmin,2)`).

```{r tcds_regression, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
## TCDS ####
ODS.only <- subset(clip.summary.all, tier.name == "OTR")
tcds.random.distribution <- ggplot(ODS.only,
                            aes(round(tot.min.p.hr, 0))) +
  geom_histogram(binwidth = 2) +
  ylab("# of clips") +
  xlab ("TCDS min/hr") +
  basic.theme
ggsave("TCDS_random_distribution.png",
       plot = tcds.random.distribution,
       width = 8, height = 6, dpi = 300)
#sd(round(subset(clip.summary.all, tier.name == "OTR")$tot.min.p.hr,0))^2
#mean(round(subset(clip.summary.all, tier.name == "OTR")$tot.min.p.hr,0))
# mean is much smaller than variance

tds.rand.zinb <- glmmTMB(round(tot.min.p.hr, 0) ~
                           tchiyr.std +
                           stthr.tri.o +
                           hsz.std +
                           mated.std +
                           tchiyr.std:stthr.tri.o +
                           (1|aclew_id),
                         data = ODS.only,
                         ziformula = ~tchiyr.std,
                         family="nbinom1")
summary(tds.rand.zinb)

# is household size just a proxy for # older sibs?
# doesn't seem like it
tds.rand.zinb.alt <- glmmTMB(round(tot.min.p.hr, 0) ~
                           tchiyr.std +
                           stthr.tri.o +
                           number_older_sibs +
                           mated.std +
                           tchiyr.std:stthr.tri.o +
                           (1|aclew_id),
                         data = ODS.only,
                         ziformula = ~tchiyr.std,
                         family="nbinom1")
# summary(tds.rand.zinb.alt)
tds.mdl.tbl <- broom.mixed::tidy(tds.rand.zinb)
```

Before conducting regression analyses we observed the distribution of the data. Many clips contained zero TCDS and, among the remainder of the clips, there was a skewed, non-negative distribution (i.e., it is not possible to have less than 0 min/hr of TCDS). This pattern was expected on the basis of past work analyzing speech during randomly selected daylong clips (REFS). We handle this distribution as has been done in the past, with a zero-inflated negative-binomial mixed-effects regression. [tailor and translate description from before]. The conditional model (of non-zero integer minutes per hour of TCDS) included a random effect of recording and predictors that have previously been found to influence input rate, including: target child age (numeric; standardized), time of day (factorial; morning vs. midday/afternoon), household size (numeric; standardized), maternal education level (factorial; none vs. primary/secondary/preparatory/postsecondary), and an interaction between age and time of day. The zero-inflation component of the regression included a predictor of child age (numeric; standardized) on the prediction that younger children are overall more likely to hear zero TCDS in a given clip. The conditional regression revealed only two significant effects on TCDS rate: children hear more TCDS as they get older ($b$ = `r printnum(tds.mdl.tbl$estimate[which(tds.mdl.tbl$term == "tchiyr.std")[1]], digits = 3)`, $SE$ = `r printnum(tds.mdl.tbl$std.error[which(tds.mdl.tbl$term == "tchiyr.std")[1]], digits = 3)`, $t$ = `r printnum(tds.mdl.tbl$statistic[which(tds.mdl.tbl$term == "tchiyr.std")[1]], digits = 3)`, $p$ = `r printnum(tds.mdl.tbl$p.value[which(tds.mdl.tbl$term == "tchiyr.std")[1]],digits = 3)`), and children from larger households hear more TCDS ($b$ = `r printnum(tds.mdl.tbl$estimate[which(tds.mdl.tbl$term == "hsz.std")[1]], digits = 3)`, $SE$ = `r printnum(tds.mdl.tbl$std.error[which(tds.mdl.tbl$term == "hsz.std")[1]], digits = 3)`, $t$ = `r printnum(tds.mdl.tbl$statistic[which(tds.mdl.tbl$term == "hsz.std")[1]], digits = 3)`, $p$ = `r printnum(tds.mdl.tbl$p.value[which(tds.mdl.tbl$term == "hsz.std")[1]],digits = 3)`). We did not see a significant interaction of child age and time of day, as found in past work (Casillas et al., 2020). The zero-inflation component confirmed that clips from older children are significantly less likely to contain zero TCDS ($b$ = `r printnum(tds.mdl.tbl$estimate[which(tds.mdl.tbl$term == "tchiyr.std")[2]], digits = 3)`, $SE$ = `r printnum(tds.mdl.tbl$std.error[which(tds.mdl.tbl$term == "tchiyr.std")[2]], digits = 3)`, $t$ = `r printnum(tds.mdl.tbl$statistic[which(tds.mdl.tbl$term == "tchiyr.std")[2]], digits = 3)`, $p$ = `r printnum(tds.mdl.tbl$p.value[which(tds.mdl.tbl$term == "tchiyr.std")[2]],digits = 3)`).

```{r tcds_plot, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
age.sd <- sd(rec.info$age)
age.mean <- mean(rec.info$age)

tcds.mdl.pred.age <- tibble(
  ggpredict(tds.rand.zinb, "tchiyr.std")) %>%
  mutate(age.mo = (x * age.sd) + age.mean)

tcds.plot.age <- ggplot(tcds.mdl.pred.age, aes(x = age.mo, y = predicted)) +
  geom_ribbon(aes(ymax = conf.high, ymin = conf.low), alpha = 0.2) +
  geom_line() +
  labs(x = "Edad del niño (meses)", y = "Valores predichos (min/hr)") +
  geom_boxplot(data = ODS.only, aes(x = age, y = tot.min.p.hr,
                   color = factor(aclew_id), fill = factor(aclew_id)),
               outlier.fill = NA, alpha = 0.4) +
  geom_jitter(data = ODS.only, aes(x = age, y = tot.min.p.hr,
                   color = factor(aclew_id)), alpha = 0.5) +
  scale_x_continuous(limits = c(0,55),
                     breaks = seq(0,55,5)) +
  scale_y_continuous(limits = c(0,20),
                     breaks = seq(0,20,5)) +
  coord_cartesian(xlim = c(0,55), ylim = c(0,20)) +
  guides(color = "none", fill = "none") +
  theme_apa()
ggsave("TCDS_over_age_with_estimates.png",
       plot = tcds.plot.age,
       width = 6, height = 3.5, dpi = 300)
```

## Child vocalization rate

<!-- PART 2
- how much speech do children produce?
    - does it change with age?
    - does it change across the day (* with age)?
    - how much of it occurs within tt/is?
-->


<!-- PART 3
- does children's volubility correlate with their directed input?
    - does it change with age?
-->

```{r plotdata}
# ggplot(data = clip.summary,
#        aes(x = min.p.hr)) +
#   facet_grid(~ tier.name) +
#   geom_histogram(binwidth = 1)
# 
# all.spch.mph.plot <- ggplot(data = clip.summary,
#        aes(x = age, y = min.p.hr,
#            color = factor(aclew_id))) +
#   facet_grid(~ tier.name) +
#   geom_smooth(method = "lm", color = "gray") +
#   geom_boxplot(outlier.fill = NA) +
#   geom_jitter(alpha = 0.5) +
#   scale_x_continuous(limits = c(0,55),
#                      breaks = seq(0,55,5)) +
#   scale_y_continuous(limits = c(0,40),
#                      breaks = seq(0,40,5)) +
#   coord_cartesian(xlim = c(0,55), ylim = c(0,40)) +
#   labs(x = "Age (months)", y = "min/hr") +
#   guides(color = "none") +
#   theme_apa()
# all.spch.mph.plot %>%
#   ggexport(filename = "plots/all.spch.mph.plot.png",
#            width = 2400, height = 1200, res = 300)
# 
# clip.CHIOTR.corr.plot <- ggplot(data = clip.CHI.OTR.rates,
#                                 aes(x = OTR, y = CHI)) +
#   geom_smooth(method = "lm", color = "gray") +
#   geom_jitter() +
#   labs(x = "TCDS min/hr", y = "CHI spch min/hr") +
#   theme_apa()
# clip.CHIOTR.corr.plot %>%
#   ggexport(filename = "plots/clip.CHIOTR.corr.plot.png",
#            width = 1200, height = 600, res = 300)
# 
# rec.CHIOTR.corr.plot <- ggplot(data = rec.CHI.OTR.rates,
#                                 aes(x = OTR, y = CHI)) +
#   geom_smooth(method = "lm", color = "gray") +
#   geom_jitter() +
#   labs(x = "TCDS min/hr", y = "CHI spch min/hr") +
#   theme_apa()
# rec.CHIOTR.corr.plot %>%
#   ggexport(filename = "plots/rec.CHIOTR.corr.plot.png",
#            width = 1200, height = 600, res = 300)
# 
# rec.CHIage.OTRtertile.plot <- ggplot(data = rec.CHI.OTR.rates,
#                                 aes(x = age, y = CHI)) +
#   facet_grid(~ Tertile) +
#   geom_smooth(method = "lm", color = "gray") +
#   geom_jitter() +
#   labs(x = "Age (mo)", y = "CHI spch min/hr") +
#   theme_apa()
# rec.CHIage.OTRtertile.plot %>%
#   ggexport(filename = "plots/rec.CHIage.OTRtertile.plot.png",
#            width = 2400, height = 800, res = 300)

```


# Discusión

<!--
Census notes
de: http://webcache.googleusercontent.com/search?q=cache:BHXsAGj22NgJ:www.microrregiones.gob.mx/catloc/contenido.aspx?refnac%3D070930014&hl=en&gl=nl&strip=1&vwsrc=0

Año	2005	2010
Datos demográficos	Hombres	Mujeres	Total	Hombres	Mujeres	Total
Total de población en la localidad	557	542	1,099	560	556	1,116
Viviendas particulares habitadas	182	217
Grado de marginación de la localidad (Ver indicadores)	Alto	Alto
Grado de rezago social localidad (Ver indicadores)	3 medio	Medio
Indicadores de carencia en vivienda (Ver indicadores)	
-->

# Agradecimientos {#acknowledgements}
Agredecemos y reconocemos Rebeca Guzmán López, Humbertina Gómez Pérez, e Antun Gusman Osil, los quienes hicieron posible la colección, anotación, y transcripción de estes datos. Acknowledgements también las familias participantes y la comunidad tseltal para su apoyo. Esta investigación fue financiado por una beca NWO Veni (275-89-033) de MC, una beca XXX de MS, fundos para trabajo de campo del Max Planck Institute for Psycholinguistics, y con el apoyo del Centro de Investigaciones y Estudios Superiores en Antropología Social (CIESAS) Sureste. Este manuscrito fue escrito con el library papaja en RStudio [@R-papaja].

\newpage

# Bibliografía {#refs}

```{r create_r-references}
r_refs(file = "Tseltal-CLE-full2015sample.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
