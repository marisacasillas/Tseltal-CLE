facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40)) +
scale_y_continuous(limits = c(0,30)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
rec.lvl.summary <- seg.lvl.summary %>%
group_by(child_id, tier) %>%
summarize(
mean.mph = mean(min.p.hr),
median.mph = median(min.p.hr),
min.mph = min(min.p.hr),
max.mph = max(min.p.hr),
sd.mph = sd(min.p.hr)
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id"))
mean.tph <- mean(rec.lvl.summary$mean.mph)
mean.tph
mean.tph <- mean(rec.lvl.summary$mean.mph)
median.tph <- median(rec.lvl.summary$median.mph)
mean.median.tph <- mean(rec.lvl.summary$median.mph)
min.tph <- min(rec.lvl.summary$mean.mph)
max.tph <- max(rec.lvl.summary$mean.mph)
mean.median.tph
median.tph
min.tph
max.tph
rec.lvl.summary.otr <- subset(rec.lvl.summary, tier == "OTR")
mean.tph <- mean(rec.lvl.summary.otr$mean.mph)
median.tph <- median(rec.lvl.summary.otr$median.mph)
mean.median.tph <- mean(rec.lvl.summary.otr$median.mph)
min.tph <- min(rec.lvl.summary.otr$mean.mph)
max.tph <- max(rec.lvl.summary.otr$mean.mph)
mean.tph
median.tph
mean.median.tph
min.tph
max.tph
glmer(min.p.hr ~ age_mo_round + (1|aclew_id), data = subset(seg.lvl.summary, tier == "OTR"))
otr.m <- glmer(min.p.hr ~
age_mo_round + (1|aclew_id),
data = subset(seg.lvl.summary, tier == "OTR"))
otr.m <- lmer(min.p.hr ~
age_mo_round + (1|aclew_id),
data = subset(seg.lvl.summary, tier == "OTR"))
head(subset(seg.lvl.summary, tier == "OTR"))
otr.m <- lmer(min.p.hr ~
age_mo_round + (1|child_id),
data = subset(seg.lvl.summary, tier == "OTR"))
?isSingular
otr.m <- lmer(min.p.hr ~
1 + (1|child_id),
data = subset(seg.lvl.summary, tier == "OTR"))
summary(otr.m)
otr.m <- lmer(min.p.hr ~
mat_ed + (1|child_id),
data = subset(seg.lvl.summary, tier == "OTR"))
summary(otr.m)
View(ptcp.info)
otr.m <- lmer(min.p.hr ~
age_mo_round * mat_ed + (1|child_id),
data = subset(seg.lvl.summary, tier == "OTR"))
summary(otr.m)
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40)) +
scale_y_continuous(limits = c(0,30)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
ggplot(data = seg.lvl.summary,
aes(y = min.p.hr)) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(y = min.p.hr)) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(x = min.p.hr)) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(x = min.p.hr)) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(x = min.p.hr)) +
facet_grid(~ tier) +
geom_histogram()
View(seg.lvl.summary)
View(rec.lvl.summary)
View(ptcp.info)
# Create full matrices of annotated clips
all.clips <- tibble(
aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9)
)
all.clips <- expand.grid(aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9))
all.clips
View(seg.lvl.summary)
seg.lvl.summary <- all.data %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips)
seg.lvl.summary <- all.data %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num"))
nrow(all.clips)
all.clips <- expand.grid(
aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9),
tier = c("CHI", "OTR"))
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num"))
nrow(all.clips)
nrow(seg.lvl.summary)
table(seg.lvl.summary$aclew_id)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI")
nrow(seg.lvl.summary)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num"))
nrow(seg.lvl.summary)
table(seg.lvl.summary$aclew_id)
View(subset(seg.lvl.summary, aclew_id == 0684))
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num"))
nrow(seg.lvl.summary)
nrow(all.clips)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0))
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(child_id, tier, segment_num)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(aclew_id, tier, segment_num)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(aclew_id, tier, segment_num)
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
)
View(seg.info)
aclew2child_id <- all.data %>%
select(aclew_id, child_id) %>%
distinct()
aclew2child_id
View(aclew2child_id)
all.clips <- expand.grid(
aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9),
tier = c("CHI", "OTR")) %>%
full_join(aclew2child_id)
all.clips <- expand.grid(
aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9),
tier = c("CHI", "OTR")) %>%
full_join(aclew2child_id, by = "aclew_id")
View(all.clips)
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(ptcp.info, by = c("aclew_id" = "lab_internal_subject_id"))
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
)
unique(seg.lvl.summary$child_id)
length(unique(seg.lvl.summary$child_id))
length(unique(all.clips$child_id))
unique(all.clips$child_id)
all.clips <- expand.grid(
aclew_id = unique(ptcp.info$aclew_id),
segment_num = c(1:9),
tier = c("CHI", "OTR")) %>%
full_join(aclew2child_id, by = "aclew_id") %>%
filter(!is.na(child_id))
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "aclew_id", "tier")) %>%
left_join(ptcp.info, by = c("aclew_id" = "lab_internal_subject_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(aclew_id, tier, segment_num)
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "child_id", "tier")) %>%
left_join(ptcp.info, by = c("aclew_id" = "lab_internal_subject_id")) %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(aclew_id, tier, segment_num)
# ... then with averages across clips at the recording level
rec.lvl.summary <- seg.lvl.summary %>%
group_by(child_id, tier) %>%
summarize(
mean.mph = mean(min.p.hr),
median.mph = median(min.p.hr),
min.mph = min(min.p.hr),
max.mph = max(min.p.hr),
sd.mph = sd(min.p.hr)
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id"))
rec.lvl.summary.otr <- subset(rec.lvl.summary, tier == "OTR")
mean.tph <- mean(rec.lvl.summary.otr$mean.mph)
median.tph <- median(rec.lvl.summary.otr$median.mph)
mean.median.tph <- mean(rec.lvl.summary.otr$median.mph)
min.tph <- min(rec.lvl.summary.otr$mean.mph)
max.tph <- max(rec.lvl.summary.otr$mean.mph)
mean.tph
median.tph
mean.median.tph
min.tph
max.tph
ggplot(data = seg.lvl.summary,
aes(x = min.p.hr)) +
facet_grid(~ tier) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40)) +
scale_y_continuous(limits = c(0,30)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40)) +
scale_y_continuous(limits = c(0,30)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier)
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray")
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
# geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA)
seg.lvl.summary$age_mo_round
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "child_id", "tier"))
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "child_id", "tier")) %>%
left_join(ptcp.info)
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "child_id", "tier")) %>%
left_join(ptcp.info, by = "aclew_id") %>%
left_join(seg.info)
# Create summaries, adding in zeroes for annotated clips with no speech
# ... at the clip level and
seg.lvl.summary <- all.data %>%
filter(tier == "OTR" | tier == "CHI") %>%
group_by(child_id, tier, segment_num, seg_start_tod) %>%
summarize(
tot.spch.min = sum(dur)/60000,
min.p.hr = tot.spch.min*12
) %>%
full_join(all.clips, by = c("segment_num", "child_id", "tier")) %>%
left_join(ptcp.info, by = "aclew_id") %>%
left_join(seg.info, by = c("child_id", "seg_start_tod", "segment_num")) %>%
replace_na(list(tot.spch.min = 0, min.p.hr = 0)) %>%
arrange(aclew_id, tier, segment_num)
# ... then with averages across clips at the recording level
rec.lvl.summary <- seg.lvl.summary %>%
group_by(child_id, tier) %>%
summarize(
mean.mph = mean(min.p.hr),
median.mph = median(min.p.hr),
min.mph = min(min.p.hr),
max.mph = max(min.p.hr),
sd.mph = sd(min.p.hr)
) %>%
left_join(ptcp.info, by = c("child_id" = "lab_internal_subject_id"))
rec.lvl.summary.otr <- subset(rec.lvl.summary, tier == "OTR")
mean.tph <- mean(rec.lvl.summary.otr$mean.mph)
median.tph <- median(rec.lvl.summary.otr$median.mph)
mean.median.tph <- mean(rec.lvl.summary.otr$median.mph)
min.tph <- min(rec.lvl.summary.otr$mean.mph)
max.tph <- max(rec.lvl.summary.otr$mean.mph)
ggplot(data = seg.lvl.summary,
aes(x = min.p.hr)) +
facet_grid(~ tier) +
geom_histogram()
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40)) +
scale_y_continuous(limits = c(0,30)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40),
breaks = seq(0,40,5)) +
scale_y_continuous(limits = c(0,30),
breaks = seq(0,30,5)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60),
# breaks = seq(0,60,5)) +
coord_cartesian(xlim = c(0,40), ylim = c(0,30)) +
labs(x = "Age (months)", y = "TCDS min/hr") +
guides(color = "none") +
theme_apa()
all.spch.mph.plot <- ggplot(data = seg.lvl.summary,
aes(x = age_mo_round, y = min.p.hr, color = aclew_id)) +
facet_grid(~ tier) +
geom_smooth(method = "lm", color = "gray") +
geom_boxplot(outlier.fill = NA) +
geom_jitter() +
scale_x_continuous(limits = c(0,40),
breaks = seq(0,40,5)) +
scale_y_continuous(limits = c(0,30),
breaks = seq(0,30,5)) + # cuts off a few clear outliers
# scale_y_continuous(limits = c(0,60),
# breaks = seq(0,60,5)) +
coord_cartesian(xlim = c(0,40), ylim = c(0,30)) +
labs(x = "Age (months)", y = "min/hr") +
guides(color = "none") +
theme_apa()
all.spch.mph.plot
otr.m <- lmer(min.p.hr ~
age_mo_round * mat_ed + (1|child_id),
data = subset(seg.lvl.summary, tier == "OTR"))
tcds.random.distribution <- ggplot(seg.lvl.summary,
aes(round(min.p.hr,0))) +
geom_histogram(binwidth = 2) +
ylab("# of clips") +
xlab ("TCDS min/hr") +
basic.theme
tcds.random.distribution
## TCDS ####
tcds.random.distribution <- ggplot(subset(seg.lvl.summary, tier == "OTR"),
aes(round(min.p.hr,0))) +
geom_histogram(binwidth = 2) +
ylab("# of clips") +
xlab ("TCDS min/hr") +
basic.theme
tcds.random.distribution''
tcds.random.distribution
sd(round(subset(seg.lvl.summary, tier == "OTR")$min.p.hr,0))^2
mean(round(subset(seg.lvl.summary, tier == "OTR")$min.p.hr,0))
#sd(round(subset(seg.lvl.summary, tier == "OTR")$min.p.hr,0))^2
#mean(round(subset(seg.lvl.summary, tier == "OTR")$min.p.hr,0))
# mean is much smaller than variance
tds.rand.zinb <- glmmTMB(round(min.p.hr,0) ~
age_mo_round *
mat_ed +
(1|child_id),
data=subset(seg.lvl.summary, tier == "OTR"),
ziformula=~age_mo_round,
family="nbinom1")
unique(seg.lvl.summary$child_id)
ptcp.info <- read_csv(ptcp.info.file, col_types = cols())
